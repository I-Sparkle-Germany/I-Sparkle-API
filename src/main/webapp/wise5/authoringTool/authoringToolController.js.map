{"version":3,"sources":["authoringToolController.es6"],"names":["AuthoringToolController","$location","$mdDialog","$scope","$translate","ConfigService","ProjectService","SessionService","$on","then","autoLogoutMessage","confirm","parent","angular","element","document","body","title","content","ariaLabel","ok","cancel","show","renewSession","forceLogOut","ev","translations","alert","serverUpdate","textContent","serverUpdateRequestLogoutMessage","targetEvent","result","url","mouseMoved","notifyAuthorProjectEnd","wiseBaseURL","getWISEBaseURL","teacherHomePageURL","window","location","$inject"],"mappings":"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","file":"authoringToolController.js","sourcesContent":["'use strict';\n\nclass AuthoringToolController {\n\n    constructor($location,\n                $mdDialog,\n                $scope,\n                $translate,\n                ConfigService,\n                ProjectService,\n                SessionService\n                ) {\n\n        this.$location = $location;\n        this.$mdDialog = $mdDialog;\n        this.$scope = $scope;\n        this.$translate = $translate;\n        this.ConfigService = ConfigService;\n        this.ProjectService = ProjectService;\n        this.SessionService = SessionService;\n\n        $scope.$on('showSessionWarning', () => {\n\n            this.$translate('autoLogoutMessage').then((autoLogoutMessage) => {\n                // Appending dialog to document.body\n                let confirm = this.$mdDialog.confirm()\n                    .parent(angular.element(document.body))\n                    .title('Session Timeout')\n                    .content(autoLogoutMessage)\n                    .ariaLabel('Session Timeout')\n                    .ok('YES')\n                    .cancel('No');\n                this.$mdDialog.show(confirm).then(() => {\n                    this.SessionService.renewSession();\n                }, () => {\n                    this.SessionService.forceLogOut();\n                });\n\n            });\n        });\n\n        // alert user when inactive for a long time\n        this.$scope.$on('showRequestLogout', (ev) => {\n            this.$translate([\"serverUpdate\", \"serverUpdateRequestLogoutMessage\", \"ok\"]).then((translations) => {\n                let alert = this.$mdDialog.confirm()\n                    .parent(angular.element(document.body))\n                    .title(translations.serverUpdate)\n                    .textContent(translations.serverUpdateRequestLogoutMessage)\n                    .ariaLabel(translations.serverUpdate)\n                    .targetEvent(ev)\n                    .ok(translations.ok);\n\n                this.$mdDialog.show(alert).then(() => {\n                    // do nothing\n                }, () => {\n                    // do nothing\n                });\n\n            });\n        });\n    }\n    \n    /**\n     * Check if the author is on the My Projects page in the Authoring Tool\n     * @returns whether the author is on the My Projects page in the Authoring\n     * Tool\n     */\n    isAuthorOnMyProjectsPage() {\n        var result = false;\n        \n        if (this.$location.url() == '/') {\n            /*\n             * the author is on the My Projects page. the url looks like\n             * http://wise.berkeley.edu/author#/\n             */\n            result = true;\n        }\n        \n        return result;\n    }\n    \n    /**\n     * Navigate the user to the My Projects page in the Authoring Tool\n     */\n    goToMyProjects() {\n        // send the user to the My Projects page in the Authoring Tool\n        this.$location.url('/author');\n    }\n    \n    /**\n     * The user has moved the mouse so\n     */\n    mouseMoved() {\n        /*\n         * notify the Session Service that the user has moved the mouse\n         * so we can refresh the session\n         */\n        this.SessionService.mouseMoved();\n    }\n\n    exit() {\n        // notify others that we've finished authoring\n        this.ProjectService.notifyAuthorProjectEnd().then(() => {\n            // send the user to the teacher home page\n            let wiseBaseURL = this.ConfigService.getWISEBaseURL();\n            let teacherHomePageURL = wiseBaseURL + '/teacher';\n            window.location = teacherHomePageURL;\n        })\n    }\n}\n\nAuthoringToolController.$inject = ['$location', '$mdDialog', '$scope', '$translate', 'ConfigService', 'ProjectService', 'SessionService'];\n\nexport default AuthoringToolController;\n"]}