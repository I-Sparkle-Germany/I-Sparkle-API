{"version":3,"sources":["src/main/webapp/wise5/classroomMonitor/classroomMonitorComponents/milestones/milestoneDetails/milestoneDetails.es6"],"names":["MilestoneDetailsController","$filter","$scope","$state","ConfigService","ProjectService","TeacherDataService","$translate","periodId","getCurrentPeriod","$onInit","requirements","getRequirements","$on","event","args","currentPeriod","items","milestone","angular","forEach","value","key","checked","push","nodeId","nodeIdToNumber","getNodeTitleByNodeId","workgroupId","getDisplayUserNamesByWorkgroupId","getAvatarColorForWorkgroupId","workgroup","onShowWorkgroup","onVisitNodeGrading","$inject","MilestoneDetails","bindings","template","controller"],"mappings":"AAAA;;;;;;;;;;IAEMA,0B;AACF,wCAAYC,OAAZ,EACYC,MADZ,EAEYC,MAFZ,EAGYC,aAHZ,EAIYC,cAJZ,EAKYC,kBALZ,EAKgC;AAAA;;AAAA;;AAC5B,aAAKL,OAAL,GAAeA,OAAf;AACA,aAAKC,MAAL,GAAcA,MAAd;AACA,aAAKC,MAAL,GAAcA,MAAd;AACA,aAAKC,aAAL,GAAqBA,aAArB;AACA,aAAKC,cAAL,GAAsBA,cAAtB;AACA,aAAKC,kBAAL,GAA0BA,kBAA1B;;AAEA,aAAKC,UAAL,GAAkB,KAAKN,OAAL,CAAa,WAAb,CAAlB;AACA,aAAKO,QAAL,GAAgB,KAAKF,kBAAL,CAAwBG,gBAAxB,GAA2CD,QAA3D;;AAEA,aAAKE,OAAL,GAAe,YAAM;AACjB,kBAAKC,YAAL,GAAoB,MAAKC,eAAL,EAApB;AACH,SAFD;;AAIA,aAAKV,MAAL,CAAYW,GAAZ,CAAgB,sBAAhB,EAAwC,UAACC,KAAD,EAAQC,IAAR,EAAiB;AACrD,kBAAKP,QAAL,GAAgBO,KAAKC,aAAL,CAAmBR,QAAnC;AACH,SAFD;AAGH;;;;0CAEiB;AACd,gBAAIG,eAAe,EAAnB;AACA,gBAAIM,QAAQ,KAAKC,SAAL,CAAeD,KAA3B;;AAEAE,oBAAQC,OAAR,CAAgBH,KAAhB,EAAuB,UAACI,KAAD,EAAQC,GAAR,EAAgB;AACnC,oBAAID,MAAME,OAAV,EAAmB;AACfZ,iCAAaa,IAAb,CAAkBF,GAAlB;AACH;AACJ,aAJD;;AAMA,mBAAOX,YAAP;AACH;;;8CAEqBc,M,EAAQ;AAC1B,mBAAO,KAAKpB,cAAL,CAAoBqB,cAApB,CAAmCD,MAAnC,CAAP;AACH;;;6CAEoBA,M,EAAQ;AACzB,mBAAO,KAAKpB,cAAL,CAAoBsB,oBAApB,CAAyCF,MAAzC,CAAP;AACH;;AAED;;;;;;;;yDAKiCG,W,EAAa;AAC1C,mBAAO,KAAKxB,aAAL,CAAmByB,gCAAnB,CAAoDD,WAApD,CAAP;AACH;;AAED;;;;;;;;qDAK6BA,W,EAAa;AACtC,mBAAO,KAAKxB,aAAL,CAAmB0B,4BAAnB,CAAgDF,WAAhD,CAAP;AACH;;;sCAEaG,S,EAAW;AACrB,iBAAKC,eAAL,CAAqB,EAAEX,OAAOU,SAAT,EAArB;AACH;;;2CAEkB;AACf,iBAAKE,kBAAL;AACH;;;;;;AAGLjC,2BAA2BkC,OAA3B,GAAqC,CACjC,SADiC,EAEjC,QAFiC,EAGjC,QAHiC,EAIjC,eAJiC,EAKjC,gBALiC,EAMjC,oBANiC,CAArC;;AASA,IAAMC,mBAAmB;AACrBC,cAAU;AACNlB,mBAAW,GADL;AAENc,yBAAiB,GAFX;AAGNC,4BAAoB;AAHd,KADW;AAMrBI,4hJANqB;AAsErBC,gBAAYtC;AAtES,CAAzB;;kBAyEemC,gB","file":"milestoneDetails.js","sourcesContent":["\"use strict\";\r\n\r\nclass MilestoneDetailsController {\r\n    constructor($filter,\r\n                $scope,\r\n                $state,\r\n                ConfigService,\r\n                ProjectService,\r\n                TeacherDataService) {\r\n        this.$filter = $filter;\r\n        this.$scope = $scope;\r\n        this.$state = $state;\r\n        this.ConfigService = ConfigService;\r\n        this.ProjectService = ProjectService;\r\n        this.TeacherDataService = TeacherDataService;\r\n\r\n        this.$translate = this.$filter('translate');\r\n        this.periodId = this.TeacherDataService.getCurrentPeriod().periodId;\r\n\r\n        this.$onInit = () => {\r\n            this.requirements = this.getRequirements();\r\n        }\r\n\r\n        this.$scope.$on('currentPeriodChanged', (event, args) => {\r\n            this.periodId = args.currentPeriod.periodId;\r\n        });\r\n    };\r\n\r\n    getRequirements() {\r\n        let requirements = [];\r\n        let items = this.milestone.items;\r\n\r\n        angular.forEach(items, (value, key) => {\r\n            if (value.checked) {\r\n                requirements.push(key);\r\n            }\r\n        });\r\n\r\n        return requirements;\r\n    }\r\n\r\n    getNodeNumberByNodeId(nodeId) {\r\n        return this.ProjectService.nodeIdToNumber[nodeId];\r\n    }\r\n\r\n    getNodeTitleByNodeId(nodeId) {\r\n        return this.ProjectService.getNodeTitleByNodeId(nodeId);\r\n    }\r\n\r\n    /**\r\n     * Get the user names for a workgroup id\r\n     * @param workgroupId the workgroup id\r\n     * @return the user names in the workgroup\r\n     */\r\n    getDisplayUserNamesByWorkgroupId(workgroupId) {\r\n        return this.ConfigService.getDisplayUserNamesByWorkgroupId(workgroupId);\r\n    }\r\n\r\n    /**\r\n     * Get the avatar coloer for a workgroup id\r\n     * @param workgroupId the workgroup id\r\n     * @return the avatar color for the workgroup\r\n     */\r\n    getAvatarColorForWorkgroupId(workgroupId) {\r\n        return this.ConfigService.getAvatarColorForWorkgroupId(workgroupId);\r\n    }\r\n\r\n    showWorkgroup(workgroup) {\r\n        this.onShowWorkgroup({ value: workgroup });\r\n    }\r\n\r\n    visitNodeGrading() {\r\n        this.onVisitNodeGrading();\r\n    }\r\n}\r\n\r\nMilestoneDetailsController.$inject = [\r\n    '$filter',\r\n    '$scope',\r\n    '$state',\r\n    'ConfigService',\r\n    'ProjectService',\r\n    'TeacherDataService'\r\n];\r\n\r\nconst MilestoneDetails = {\r\n    bindings: {\r\n        milestone: '<',\r\n        onShowWorkgroup: '&',\r\n        onVisitNodeGrading: '&'\r\n    },\r\n    template:\r\n        `<div class=\"milestone-details md-whiteframe-1dp\">\r\n            <span layout=\"row\" layout-align=\"start center\">\r\n                <period-select custom-class=\"'md-no-underline md-button toolbar__select'\"></period-select>\r\n                <span flex></span>\r\n                <span layout=\"row\" layout-align=\"start center\">\r\n                    <md-progress-linear class=\"milestone-details__progress\" md-mode=\"determinate\" value=\"{{ $ctrl.milestone.percentageCompleted }}\"></md-progress-linear>\r\n                    <span class=\"md-body-2 text-secondary ng-binding\">\r\n                        {{ $ctrl.milestone.percentageCompleted }}%\r\n                    </span>\r\n                </span>\r\n            </span>\r\n            <p ng-if=\"$ctrl.milestone.description\"><span class=\"heavy\">{{ 'description' | translate }}: </span> {{ $ctrl.milestone.description }}</p>\r\n            <p ng-if=\"$ctrl.milestone.params.targetDate\"><span class=\"heavy\">{{ 'dueDate' | translate }}: </span> {{ $ctrl.milestone.params.targetDate | date: 'EEE MMM d, yyyy' }}</p>\r\n            <p ng-if=\"$ctrl.requirements.length\">\r\n                <span class=\"heavy\">{{ 'REQUIREMENTS' | translate }}: </span>\r\n                <a ng-repeat=\"requirement in $ctrl.requirements\" ui-sref=\"root.project({nodeId: \\'{{ requirement }}\\'})\" ng-click=\"$ctrl.visitNodeGrading(event)\">\r\n                    {{ $ctrl.getNodeNumberByNodeId(requirement) }}: {{ $ctrl.getNodeTitleByNodeId(requirement) }}<span ng-if=\"!$last\">, </span>\r\n                </a>\r\n            </p>\r\n        </div>\r\n        <div ng-if=\"$ctrl.milestone.type === 'milestoneReport'\"\r\n             class=\"milestone-details md-whiteframe-1dp\">\r\n            <div class=\"milestone-details__header accent-2 md-body-2 gray-lightest-bg\">{{ 'classReport' | translate }}</div>\r\n            <div ng-if=\"!$ctrl.milestone.isReportAvailable || $ctrl.periodId === -1\"\r\n                class=\"center md-body-1\">\r\n                {{ 'milestoneReportExplanation' | translate }} {{ 'milestoneReportAvailability' | translate }}<br />\r\n                <span class=\"md-body-2\" ng-if=\"$ctrl.milestone.satisfyConditional === 'any'\">\r\n                    {{ 'milestoneReportAvailabilityRequirementsAny' | translate: { num: $ctrl.milestone.satisfyMinNumWorkgroups, percent: $ctrl.milestone.satisfyMinPercentage } }}\r\n                </span>\r\n                <span class=\"md-body-2\" ng-if=\"$ctrl.milestone.satisfyConditional === 'all'\">\r\n                    {{ 'milestoneReportAvailabilityRequirementsAll' | translate: { num: $ctrl.milestone.satisfyMinNumWorkgroups, percent: $ctrl.milestone.satisfyMinPercentage } }}\r\n                </span>\r\n            </div>\r\n            <div ng-if=\"$ctrl.milestone.isReportAvailable && $ctrl.periodId > -1\">\r\n                <compile data=\"$ctrl.milestone.generatedReport\"></compile>\r\n            </div>\r\n        </div>\r\n        <div class=\"milestone-details md-whiteframe-1dp\">\r\n            <div class=\"milestone-details__header accent-2 md-body-2 gray-lightest-bg\">{{ 'studentCompletion' | translate }}</div>\r\n            <md-list class=\"user-list md-whiteframe-1dp\">\r\n                <md-list-item class=\"thead md-with-secondary gray-lightest-bg md-body-1\">\r\n                    <p>{{ 'team' | translate }}</p>\r\n                    <div class=\"md-secondary-container\">{{ 'completed' | translate }}</div>\r\n                </md-list-item>\r\n                <md-list-item class=\"list-item md-with-secondary\"\r\n                            ng-repeat=\"workgroup in $ctrl.milestone.workgroups | orderBy:'-achievementTime'\"\r\n                            ng-click=\"$ctrl.showWorkgroup(workgroup)\"\r\n                            aria-label=\"{{ 'viewTeam' | translate }}\">\r\n                    <div class=\"md-avatar\" hide-xs>\r\n                        <md-icon class=\"md-36\" style=\"color: {{ $ctrl.getAvatarColorForWorkgroupId(workgroup.workgroupId) }};\"> account_circle </md-icon>\r\n                    </div>\r\n                    <p class=\"heavy\">{{ $ctrl.getDisplayUserNamesByWorkgroupId(workgroup.workgroupId) }}</p>\r\n                    <div class=\"md-secondary-container heavy\">\r\n                        <span ng-if=\"workgroup.achievementTime !== null\" class=\"success\">\r\n                            {{ workgroup.achievementTime | amTimeAgo }}\r\n                        </span>\r\n                        <span ng-if=\"workgroup.achievementTime === null\" class=\"warn\">\r\n                            {{ 'notCompleted' | translate }}\r\n                        </span>\r\n                    </div>\r\n                </md-list-item>\r\n            </md-list>\r\n        </div>`,\r\n    controller: MilestoneDetailsController\r\n};\r\n\r\nexport default MilestoneDetails;\r\n"]}