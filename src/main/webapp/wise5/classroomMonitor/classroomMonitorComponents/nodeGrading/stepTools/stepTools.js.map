{"version":3,"sources":["stepTools.es6"],"names":["StepToolsController","$scope","NodeService","ProjectService","TeacherDataService","$mdSidenav","idToOrder","updateModel","$on","event","args","endCurrentNodeAndSetCurrentNodeByNodeId","toNodeId","nodeId","getCurrentNodeId","isGroupNode","icon","getIcon","prevId","getPrevNodeId","nextId","getNextNodeId","then","getNodeIconByNodeId","showPosition","getNodePositionById","getNodeTitleByNodeId","goToPrevNode","goToNextNode","closeNode","$inject","StepTools","bindings","template","controller"],"mappings":"AAAA;;;;;;;;;;IAEMA,mB;AACF,iCAAYC,MAAZ,EACYC,WADZ,EAEYC,cAFZ,EAGYC,kBAHZ,EAIYC,UAJZ,EAIwB;AAAA;;AAAA;;AAEpB,aAAKJ,MAAL,GAAcA,MAAd;AACA,aAAKC,WAAL,GAAmBA,WAAnB;AACA,aAAKC,cAAL,GAAsBA,cAAtB;AACA,aAAKC,kBAAL,GAA0BA,kBAA1B;;AAEA;AACA,aAAKE,SAAL,GAAiB,KAAKH,cAAL,CAAoBG,SAArC;;AAEA,aAAKC,WAAL;;AAEA,aAAKN,MAAL,CAAYO,GAAZ,CAAgB,oBAAhB,EAAsC,UAACC,KAAD,EAAQC,IAAR,EAAiB;AACnD,kBAAKH,WAAL;AACH,SAFD;AAGH;;;;0CAEiB;AACd;AACA,iBAAKH,kBAAL,CAAwBO,uCAAxB,CAAgE,KAAKC,QAArE;AACH;;;sCAEa;AAAA;;AACV,gBAAIC,SAAS,KAAKT,kBAAL,CAAwBU,gBAAxB,EAAb;AACA,gBAAI,CAAC,KAAKX,cAAL,CAAoBY,WAApB,CAAgCF,MAAhC,CAAL,EAA8C;AAC1C,qBAAKA,MAAL,GAAcA,MAAd;AACA,qBAAKG,IAAL,GAAY,KAAKC,OAAL,CAAa,KAAKJ,MAAlB,CAAZ;;AAEA,qBAAKK,MAAL,GAAc,KAAKhB,WAAL,CAAiBiB,aAAjB,EAAd;AACA,qBAAKC,MAAL,GAAc,IAAd;AACA,qBAAKlB,WAAL,CAAiBmB,aAAjB,GAAiCC,IAAjC,CAAsC,UAACT,MAAD,EAAY;AAC9C,2BAAKO,MAAL,GAAcP,MAAd;AACH,iBAFD;;AAIA;AACA,qBAAKD,QAAL,GAAgB,KAAKC,MAArB;AACH;AACJ;;;gCAEOA,M,EAAQ;AACZ,mBAAO,KAAKV,cAAL,CAAoBoB,mBAApB,CAAwCV,MAAxC,CAAP;AACH;;;0CAEiB;AACd,mBAAO,CAAC,KAAKW,YAAL,IAAqB,KAAKC,mBAAL,CAAyB,KAAKZ,MAA9B,CAArB,GAA6D,KAAKY,mBAAL,CAAyB,KAAKZ,MAA9B,IAAwC,IAArG,GAA4G,EAA7G,IAAmH,KAAKa,oBAAL,CAA0B,KAAKb,MAA/B,CAA1H;AACH;;;6CAEoBA,M,EAAQ;AACzB,mBAAO,KAAKV,cAAL,CAAoBuB,oBAApB,CAAyCb,MAAzC,CAAP;AACH;;;4CAEmBA,M,EAAQ;AACxB,mBAAO,KAAKV,cAAL,CAAoBsB,mBAApB,CAAwCZ,MAAxC,CAAP;AACH;;;oCAEWA,M,EAAQ;AAChB,mBAAO,KAAKV,cAAL,CAAoBY,WAApB,CAAgCF,MAAhC,CAAP;AACH;;;uCAEc;AACX,iBAAKX,WAAL,CAAiByB,YAAjB;AACH;;;uCAEc;AACX,iBAAKzB,WAAL,CAAiB0B,YAAjB;AACH;;;oCAEW;AACR,iBAAK1B,WAAL,CAAiB2B,SAAjB;AACH;;;;;;AAGL7B,oBAAoB8B,OAApB,GAA8B,CAC1B,QAD0B,EAE1B,aAF0B,EAG1B,gBAH0B,EAI1B,oBAJ0B,EAK1B,YAL0B,CAA9B;;AAQA,IAAMC,YAAY;AACdC,cAAU;AACNR,sBAAc;AADR,KADI;AAIdS,+oGAJc;AA2CdC,gBAAYlC;AA3CE,CAAlB;;kBA8Ce+B,S","file":"stepTools.js","sourcesContent":["\"use strict\";\r\n\r\nclass StepToolsController {\r\n    constructor($scope,\r\n                NodeService,\r\n                ProjectService,\r\n                TeacherDataService,\r\n                $mdSidenav) {\r\n\r\n        this.$scope = $scope;\r\n        this.NodeService = NodeService;\r\n        this.ProjectService = ProjectService;\r\n        this.TeacherDataService = TeacherDataService;\r\n\r\n        // service objects and utility functions\r\n        this.idToOrder = this.ProjectService.idToOrder;\r\n\r\n        this.updateModel();\r\n\r\n        this.$scope.$on('currentNodeChanged', (event, args) => {\r\n            this.updateModel();\r\n        });\r\n    }\r\n\r\n    toNodeIdChanged() {\r\n        // selected node id has changed, so open new node\r\n        this.TeacherDataService.endCurrentNodeAndSetCurrentNodeByNodeId(this.toNodeId);\r\n    }\r\n\r\n    updateModel() {\r\n        var nodeId = this.TeacherDataService.getCurrentNodeId();\r\n        if (!this.ProjectService.isGroupNode(nodeId)) {\r\n            this.nodeId = nodeId;\r\n            this.icon = this.getIcon(this.nodeId);\r\n\r\n            this.prevId = this.NodeService.getPrevNodeId();\r\n            this.nextId = null;\r\n            this.NodeService.getNextNodeId().then((nodeId) => {\r\n                this.nextId = nodeId;\r\n            });\r\n\r\n            // model variable for selected node id\r\n            this.toNodeId = this.nodeId;\r\n        }\r\n    }\r\n\r\n    getIcon(nodeId) {\r\n        return this.ProjectService.getNodeIconByNodeId(nodeId);\r\n    }\r\n\r\n    getSelectedText() {\r\n        return (this.showPosition && this.getNodePositionById(this.nodeId) ? this.getNodePositionById(this.nodeId) + ': ' : '') + this.getNodeTitleByNodeId(this.nodeId);\r\n    }\r\n\r\n    getNodeTitleByNodeId(nodeId) {\r\n        return this.ProjectService.getNodeTitleByNodeId(nodeId);\r\n    }\r\n\r\n    getNodePositionById(nodeId) {\r\n        return this.ProjectService.getNodePositionById(nodeId);\r\n    }\r\n\r\n    isGroupNode(nodeId) {\r\n        return this.ProjectService.isGroupNode(nodeId);\r\n    }\r\n\r\n    goToPrevNode() {\r\n        this.NodeService.goToPrevNode();\r\n    }\r\n\r\n    goToNextNode() {\r\n        this.NodeService.goToNextNode();\r\n    }\r\n\r\n    closeNode() {\r\n        this.NodeService.closeNode();\r\n    }\r\n}\r\n\r\nStepToolsController.$inject = [\r\n    '$scope',\r\n    'NodeService',\r\n    'ProjectService',\r\n    'TeacherDataService',\r\n    '$mdSidenav'\r\n];\r\n\r\nconst StepTools = {\r\n    bindings: {\r\n        showPosition: '<'\r\n    },\r\n    template:\r\n        `<div layout=\"row\" layout-align=\"center center\">\r\n            <img ng-if=\"$ctrl.icon.type === 'img'\" ng-animate-ref=\"{{ $ctrl.nodeId }}\" class=\"md-18 avatar node-avatar\" ng-src=\"{{$ctrl.icon.imgSrc}}\" alt=\"{{$ctrl.icon.imgAlt}}\" />\r\n            <div ng-if=\"$ctrl.icon.type === 'font'\" ng-animate-ref=\"{{ $ctrl.nodeId }}\" style=\"background-color: {{$ctrl.icon.color}};\" class=\"md-18 avatar avatar--icon node-avatar\">\r\n                <md-icon md-font-set=\"{{$ctrl.icon.fontSet}}\" class=\"md-18 md-light node-icon\" md-theme=\"default\">{{$ctrl.icon.fontName}}</md-icon>\r\n            </div>\r\n\r\n            <md-select id=\"stepSelectMenu\" md-theme=\"default\" class=\"node-select md-subhead\"\r\n                       aria-label=\"{{ 'selectAStep' | translate }}\"\r\n                       ng-model=\"$ctrl.toNodeId\"\r\n                       ng-change=\"$ctrl.toNodeIdChanged()\"\r\n                       md-selected-text=\"$ctrl.getSelectedText()\">\r\n                <md-option ng-repeat=\"item in $ctrl.idToOrder | toArray | orderBy : 'order'\"\r\n                           ng-init=\"icon = $ctrl.getIcon(item.$key)\"\r\n                           ng-if=\"item.order !== 0\"\r\n                           value=\"{{ item.$key }}\"\r\n                           ng-class=\"{'node-select-option--group': $ctrl.isGroupNode(item.$key), 'node-select-option--node': !$ctrl.isGroupNode(item.$key)}\">\r\n                    <div layout=\"row\" layout-align=\"start center\">\r\n                        <img class=\"node-select__icon md-18 avatar node-avatar\" ng-class=\"$ctrl.isGroupNode(item.$key) ? 'avatar--square' : ''\" ng-if=\"icon.type === 'img'\" ng-src=\"{{icon.imgSrc}}\" alt=\"{{icon.imgAlt}}\" />\r\n                        <div class=\"node-select__icon md-18 avatar avatar--icon node-avatar\" ng-class=\"$ctrl.isGroupNode(item.$key) ? 'avatar--square' : ''\" ng-if=\"icon.type === 'font'\" style=\"background-color: {{icon.color}};\">\r\n                            <md-icon md-font-set=\"{{icon.fontSet}}\" class=\"md-18 md-light node-icon\" md-theme=\"default\">{{icon.fontName}}</md-icon>&nbsp;\r\n                        </div>\r\n                        <span class=\"node-select__text\">{{ $ctrl.showPosition && $ctrl.getNodePositionById(item.$key) ? $ctrl.getNodePositionById(item.$key) + ': ' : '' }}{{ $ctrl.getNodeTitleByNodeId(item.$key) }}</span>\r\n                    </div>\r\n                </md-option>\r\n            </md-select>\r\n            <span flex></span>\r\n            <md-button aria-label=\"{{'previousStep' | translate }}\" class=\"md-icon-button node-nav\"\r\n                       ng-disabled=\"!$ctrl.prevId\" ng-click=\"$ctrl.goToPrevNode()\">\r\n                <md-icon> arrow_back </md-icon>\r\n            </md-button>\r\n            <md-button aria-label=\"{{ 'nextStep' | translate }}\" class=\"md-icon-button node-nav\"\r\n                       ng-disabled=\"!$ctrl.nextId\" ng-click=\"$ctrl.goToNextNode()\">\r\n                <md-icon> arrow_forward </md-icon>\r\n            </md-button>\r\n            <md-button aria-label=\"{{ 'backToProject' | translate }}\" class=\"md-icon-button node-nav\" ng-click=\"$ctrl.closeNode()\">\r\n                <md-icon md-theme=\"default\"> view_list </md-icon>\r\n            </md-button>\r\n        </div>`,\r\n    controller: StepToolsController\r\n};\r\n\r\nexport default StepTools;\r\n"]}