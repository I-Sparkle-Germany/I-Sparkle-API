{"version":3,"sources":["workgroupItem.es6"],"names":["WorkgroupItemController","$filter","$scope","ProjectService","$translate","nodeHasWork","nodeId","statusText","$onChanges","changesObj","hiddenComponents","angular","copy","currentValue","maxScore","workgroupData","hasAlert","hasNewAlert","status","completionStatus","score","update","completion","statusClass","showScore","expand","onUpdateExpand","workgroupId","value","$inject","WorkgroupItem","bindings","controller","template"],"mappings":"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","file":"workgroupItem.js","sourcesContent":["\"use strict\";\r\n\r\nclass WorkgroupItemController {\r\n    constructor($filter,\r\n                $scope,\r\n                ProjectService) {\r\n\r\n        this.$filter = $filter;\r\n        this.$scope = $scope;\r\n        this.ProjectService = ProjectService;\r\n\r\n        this.$translate = this.$filter('translate');\r\n        this.nodeHasWork = this.ProjectService.nodeHasWork(this.nodeId);\r\n        this.statusText = '';\r\n\r\n        this.$onChanges = (changesObj) => {\r\n            if (changesObj.hiddenComponents) {\r\n                this.hiddenComponents = angular.copy(changesObj.hiddenComponents.currentValue);\r\n            }\r\n\r\n            if (changesObj.maxScore) {\r\n                this.maxScore = typeof changesObj.maxScore.currentValue === 'number' ? changesObj.maxScore.currentValue : 0;\r\n            }\r\n\r\n            if (changesObj.workgroupData) {\r\n                let workgroupData = angular.copy(changesObj.workgroupData.currentValue);\r\n                this.hasAlert = workgroupData.hasAlert;\r\n                this.hasNewAlert = workgroupData.hasNewAlert;\r\n                this.status = workgroupData.completionStatus;\r\n                this.score = workgroupData.score >= 0 ? workgroupData.score : '-';\r\n            }\r\n\r\n            this.update();\r\n        };\r\n    };\r\n\r\n    update() {\r\n        let completion = 0;\r\n\r\n        switch (this.status) {\r\n            case 2:\r\n                this.statusClass = 'success';\r\n\r\n                if (this.nodeHasWork) {\r\n                    this.statusText = this.$translate('completed');\r\n                } else {\r\n                    this.statusText = this.$translate('visited');\r\n                }\r\n                break;\r\n            case 1:\r\n                this.statusClass = 'text';\r\n\r\n                this.statusText = this.$translate('partiallyCompleted');\r\n                break;\r\n\r\n            default:\r\n                this.statusClass = 'text-secondary';\r\n\r\n                if (this.nodeHasWork) {\r\n                    this.statusText = this.$translate('noWork');\r\n                } else {\r\n                    this.statusText = this.$translate('notVisited');\r\n                }\r\n        }\r\n\r\n        if (this.hasNewAlert) {\r\n            this.statusClass = 'warn';\r\n        }\r\n    }\r\n\r\n    toggleExpand() {\r\n        if (this.showScore) {\r\n            let expand = !this.expand;\r\n            this.onUpdateExpand({workgroupId: this.workgroupId, value: expand});\r\n        }\r\n    }\r\n}\r\n\r\nWorkgroupItemController.$inject = [\r\n    '$filter',\r\n    '$scope',\r\n    'ProjectService'\r\n];\r\n\r\nconst WorkgroupItem = {\r\n    bindings: {\r\n        expand: '<',\r\n        maxScore: '<',\r\n        nodeId: '<',\r\n        showScore: '<',\r\n        workgroupId: '<',\r\n        workgroupData: '<',\r\n        hiddenComponents: '<',\r\n        onUpdateExpand: '&'\r\n    },\r\n    controller: WorkgroupItemController,\r\n    template:\r\n        `<div class=\"md-whiteframe-1dp\">\r\n            <md-subheader class=\"list-item md-whiteframe-1dp\">\r\n                <button class=\"md-button md-ink-ripple list-item__subheader-button\"\r\n                               aria-label=\"{{ toggleTeamWorkDisplay | translate }}\"\r\n                               ng-class=\"{'list-item--warn': $ctrl.statusClass === 'warn', 'list-item--info': $ctrl.statusClass === 'info', 'list-item--expanded': $ctrl.showWork, 'list-item--noclick': !$ctrl.showScore}\"\r\n                               ng-click=\"$ctrl.toggleExpand()\"\r\n                               layout-wrap>\r\n                    <div layout=\"row\" flex>\r\n                        <div flex layout=\"row\" layout-align=\"start center\">\r\n                            <workgroup-info has-alert=\"$ctrl.hasAlert\" has-new-alert=\"$ctrl.hasNewAlert\" has-new-work=\"$ctrl.hasNewWork\" usernames=\"{{$ctrl.workgroupData.displayNames}}\" workgroup-id=\"$ctrl.workgroupId\"></workgroup-info>\r\n                        </div>\r\n                        <div flex=\"{{$ctrl.showScore ? 30 : 20}}\" layout=\"row\" layout-align=\"center center\">\r\n                            <workgroup-node-status status-text=\"{{$ctrl.statusText}}\" status-class=\"{{$ctrl.statusClass}}\"></workgroup-node-status>\r\n                        </div>\r\n                        <div ng-if=\"$ctrl.showScore\" flex=\"20\" layout=\"row\" layout-align=\"center center\">\r\n                            <workgroup-node-score score=\"{{$ctrl.score}}\" max-score=\"{{$ctrl.maxScore}}\"></workgroup-node-score>\r\n                        </div>\r\n                    </div>\r\n                </button>\r\n            </md-subheader>\r\n            <md-list-item ng-if=\"$ctrl.expand\" class=\"node-grading-item\">\r\n                <workgroup-node-grading workgroup-id=\"$ctrl.workgroupId\"\r\n                                        node-id=\"{{$ctrl.nodeId}}\"\r\n                                        hidden-components=\"$ctrl.hiddenComponents\"\r\n                                        flex></workgroup-node-grading>\r\n            </md-list-item>\r\n        </div>`\r\n};\r\n\r\nexport default WorkgroupItem;\r\n"]}