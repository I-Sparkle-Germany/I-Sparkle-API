{"version":3,"sources":["workgroupNodeGrading.es6"],"names":["WorkgroupNodeGradingController","ConfigService","ProjectService","TeacherDataService","$onInit","nodeContent","getNodeContent","components","getComponents","teacherWorkgroupId","getWorkgroupId","latestWork","latestWorkTime","$onChanges","changesObj","convertToClientTimestamp","currentValue","result","node","getNodeById","nodeId","isDisabled","c","length","component","lockAfterSubmit","workgroupId","componentId","componentState","getLatestComponentStateByWorkgroupIdNodeIdAndComponentId","time","$inject","WorkgroupNodeGrading","bindings","template","controller"],"mappings":"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","file":"workgroupNodeGrading.js","sourcesContent":["\"use strict\";\n\nclass WorkgroupNodeGradingController {\n    constructor(ConfigService,\n                ProjectService,\n                TeacherDataService) {\n        this.ConfigService = ConfigService;\n        this.ProjectService = ProjectService;\n        this.TeacherDataService = TeacherDataService;\n\n        this.$onInit = () => {\n            this.nodeContent = this.getNodeContent();\n            this.components = this.getComponents();\n            this.teacherWorkgroupId = this.ConfigService.getWorkgroupId();\n            this.latestWork = this.latestWorkTime;\n        };\n\n        this.$onChanges = (changesObj) => {\n            if (changesObj.latestWorkTime) {\n                this.latestWork = this.convertToClientTimestamp(changesObj.latestWorkTime.currentValue);\n            }\n        };\n    };\n\n    getNodeContent() {\n        let result = null;\n\n        let node = this.ProjectService.getNodeById(this.nodeId);\n        if (node != null) {\n            // field that will hold the node content\n            result = node;\n        }\n\n        return result;\n    }\n\n    /**\n     * Get the components for this node.\n     * @return an array that contains the content for the components\n     */\n    getComponents() {\n        let components = null;\n\n        if (this.nodeContent) {\n            components = this.nodeContent.components;\n        }\n\n        if (components && this.isDisabled) {\n            for (var c = 0; c < components.length; c++) {\n                var component = components[c];\n\n                component.isDisabled = true;\n            }\n        }\n\n        if (components && this.nodeContent.lockAfterSubmit) {\n            for (c = 0; c < components.length; c++) {\n                component = components[c];\n\n                component.lockAfterSubmit = true;\n            }\n        }\n\n        return components;\n    }\n\n    /**\n     * Get the student data for a specific part\n     * @param the componentId\n     * @param the workgroupId id of Workgroup who created the component state\n     * @return the student data for the given component\n     */\n    getLatestComponentStateByWorkgroupIdAndComponentId(workgroupId,  componentId) {\n        let componentState = null;\n\n        if (workgroupId != null && componentId != null) {\n            // get the latest component state for the component\n            componentState = this.TeacherDataService.getLatestComponentStateByWorkgroupIdNodeIdAndComponentId(workgroupId, this.nodeId, componentId);\n        }\n\n        return componentState;\n    }\n\n    /**\n     * Get the student data for a specific part\n     * @param the componentId\n     * @param the workgroupId id of Workgroup who created the component state\n     * @return the student data for the given component\n     */\n    getLatestComponentStateByWorkgroupIdAndNodeIdAndComponentId(workgroupId, nodeId, componentId) {\n        let componentState = null;\n\n        if (workgroupId != null && nodeId != null && componentId != null) {\n\n            // get the latest component state for the component\n            componentState = this.TeacherDataService.getLatestComponentStateByWorkgroupIdNodeIdAndComponentId(workgroupId, nodeId, componentId);\n        }\n\n        return componentState;\n    }\n\n    convertToClientTimestamp(time) {\n        return this.ConfigService.convertToClientTimestamp(time);\n    }\n}\n\nWorkgroupNodeGradingController.$inject = [\n    'ConfigService',\n    'ProjectService',\n    'TeacherDataService'\n];\n\nconst WorkgroupNodeGrading = {\n    bindings: {\n        workgroupId: '<',\n        nodeId: '@',\n        latestWorkTime: '<'\n    },\n    template:\n        `<div class=\"nav-item__grading md-whiteframe-1dp\">\n            <!--<div class=\"nav-item__grading__info md-body-1 accent-2\">\n                <span ng-if=\"$ctrl.latestWork\">\n                    <span translate=\"latestWork\"></span>&nbsp;<span class=\"nav-item__grading__timestamp\" am-time-ago=\"$ctrl.latestWork\"></span>\n                    <md-tooltip md-direction=\"right\">{{ $ctrl.latestWork | amDateFormat:'ddd, MMM D YYYY, h:mm a' }}</md-tooltip>\n                </span>\n                <span ng-if=\"!$ctrl.latestWork\" translate=\"teamNoWorkSubmitted\"></span>\n            </div>-->\n            <div id=\"{{component.id}}_{{$ctrl.workgroupId}}\" class=\"component--grading\" ng-repeat='component in $ctrl.components'>\n                <component ng-if='component.showPreviousWorkNodeId != null && component.showPreviousWorkComponentId != null && component.showPreviousWorkNodeId != \"\" && component.showPreviousWorkComponentId != \"\"'\n                           node-id='{{component.showPreviousWorkNodeId}}'\n                           component-id='{{component.showPreviousWorkComponentId}}'\n                           component-state='{{$ctrl.getLatestComponentStateByWorkgroupIdAndNodeIdAndComponentId($ctrl.workgroupId, component.showPreviousWorkNodeId, component.showPreviousWorkComponentId)}}'\n                           workgroup-id='{{$ctrl.workgroupId}}'\n                           teacher-workgroup-id='{{$ctrl.teacherWorkgroupId}}'\n                           mode='grading'></component>\n                <component ng-if='component.showPreviousWorkNodeId == null || component.showPreviousWorkComponentId == null || component.showPreviousWorkNodeId == \"\" || component.showPreviousWorkComponentId == \"\"'\n                           node-id='{{$ctrl.nodeId}}'\n                           component-id='{{component.id}}'\n                           component-state='{{$ctrl.getLatestComponentStateByWorkgroupIdAndComponentId($ctrl.workgroupId, component.id)}}'\n                           workgroup-id='{{$ctrl.workgroupId}}'\n                           teacher-workgroup-id='{{$ctrl.teacherWorkgroupId}}'\n                           mode='grading'></component>\n\n            </div>\n        </div>`,\n    controller: WorkgroupNodeGradingController\n};\n\nexport default WorkgroupNodeGrading;\n"]}