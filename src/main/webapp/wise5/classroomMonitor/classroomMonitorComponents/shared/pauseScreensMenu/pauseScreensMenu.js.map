{"version":3,"sources":["pauseScreensMenu.es6"],"names":["PauseScreensMenuController","$scope","TeacherDataService","periods","getRunStatus","allPeriodsPaused","getAllPeriodsPaused","$on","event","args","period","periodId","n","length","i","id","pauseScreensChanged","paused","isPaused","$inject","PauseScreensMenu","template","controller"],"mappings":"AAAA;;;;;;;;;;IAEMA,0B;AACF,wCAAYC,MAAZ,EACYC,kBADZ,EACgC;AAAA;;AAAA;;AAC5B,aAAKD,MAAL,GAAcA,MAAd;AACA,aAAKC,kBAAL,GAA0BA,kBAA1B;;AAEA,aAAKC,OAAL,GAAe,KAAKD,kBAAL,CAAwBE,YAAxB,GAAuCD,OAAtD;AACA,aAAKE,gBAAL,GAAwB,KAAKC,mBAAL,EAAxB;;AAEA;;;AAGA,aAAKL,MAAL,CAAYM,GAAZ,CAAgB,qBAAhB,EAAuC,UAACC,KAAD,EAAQC,IAAR,EAAiB;AACpD,kBAAKN,OAAL,GAAeM,KAAKN,OAApB;AACA,kBAAKE,gBAAL,GAAwB,MAAKC,mBAAL,EAAxB;AACH,SAHD;AAIH;;;;;;AAED;;;;;qCAKaI,M,EAAQ;AACjB,gBAAIA,OAAOC,QAAP,KAAoB,CAAC,CAAzB,EAA4B;AACxB,oBAAIC,IAAI,KAAKT,OAAL,CAAaU,MAArB;AACA,qBAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIF,CAApB,EAAuBE,GAAvB,EAA4B;AACxB,wBAAIJ,UAAS,KAAKP,OAAL,CAAaW,CAAb,CAAb;AACA,wBAAIJ,QAAOK,EAAP,KAAc,CAAC,CAAnB,EAAsB;AAClB,6BAAKb,kBAAL,CAAwBc,mBAAxB,CAA4CN,QAAOC,QAAnD,EAA6D,KAAKN,gBAAlE;AACH;AACJ;AACJ,aARD,MAQO;AACH,qBAAKH,kBAAL,CAAwBc,mBAAxB,CAA4CN,OAAOC,QAAnD,EAA6DD,OAAOO,MAApE;AACH;AACJ;;AAED;;;;;;;8CAIsB;AAClB,gBAAIC,WAAW,IAAf;AACA,gBAAIN,IAAI,KAAKT,OAAL,CAAaU,MAArB;AAAA,gBAA6BC,IAAI,CAAjC;;AAEA,mBAAOA,IAAIF,CAAX,EAAcE,GAAd,EAAmB;AACf,oBAAIJ,SAAS,KAAKP,OAAL,CAAaW,CAAb,CAAb;AACA,oBAAIJ,OAAOC,QAAP,KAAoB,CAAC,CAArB,IAA0B,CAACD,OAAOO,MAAtC,EAA8C;AAC1CC,+BAAW,KAAX;AACA;AACH;AACJ;;AAED,mBAAOA,QAAP;AACH;;;;;;AAGLlB,2BAA2BmB,OAA3B,GAAqC,CACjC,QADiC,EAEjC,oBAFiC,CAArC;;AAKA,IAAMC,mBAAmB;AACrBC,wtDADqB;AA6BrBC,gBAAYtB;AA7BS,CAAzB;;kBAgCeoB,gB","file":"pauseScreensMenu.js","sourcesContent":["\"use strict\";\r\n\r\nclass PauseScreensMenuController {\r\n    constructor($scope,\r\n                TeacherDataService) {\r\n        this.$scope = $scope;\r\n        this.TeacherDataService = TeacherDataService;\r\n\r\n        this.periods = this.TeacherDataService.getRunStatus().periods;\r\n        this.allPeriodsPaused = this.getAllPeriodsPaused();\r\n\r\n        /**\r\n         * Listen for pause screens changed event\r\n         */\r\n        this.$scope.$on('pauseScreensChanged', (event, args) => {\r\n            this.periods = args.periods;\r\n            this.allPeriodsPaused = this.getAllPeriodsPaused();\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Toggle the paused status for the given period\r\n     * TODO: sync with actual pause statuses in TeacherDataService\r\n     * @param period the period object to toggle paused status\r\n     */\r\n    togglePeriod(period) {\r\n        if (period.periodId === -1) {\r\n            let n = this.periods.length;\r\n            for (let i = 0; i < n; i++) {\r\n                let period = this.periods[i];\r\n                if (period.id !== -1) {\r\n                    this.TeacherDataService.pauseScreensChanged(period.periodId, this.allPeriodsPaused);\r\n                }\r\n            }\r\n        } else {\r\n            this.TeacherDataService.pauseScreensChanged(period.periodId, period.paused);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Check whether all the periods in the run are paused\r\n     * @return boolean whether all periods are paused\r\n     */\r\n    getAllPeriodsPaused() {\r\n        let isPaused = true;\r\n        let n = this.periods.length, i = 0;\r\n\r\n        for (; i < n; i++) {\r\n            let period = this.periods[i];\r\n            if (period.periodId !== -1 && !period.paused) {\r\n                isPaused = false;\r\n                break;\r\n            }\r\n        }\r\n\r\n        return isPaused;\r\n    }\r\n}\r\n\r\nPauseScreensMenuController.$inject = [\r\n    '$scope',\r\n    'TeacherDataService'\r\n];\r\n\r\nconst PauseScreensMenu = {\n    template:\r\n        `<div class=\"account-menu__caret account-menu__caret--pause\" tabindex=\"0\"></div>\r\n        <div layout=\"column\" class=\"account-menu--fixed-height\">\r\n            <md-toolbar md-theme=\"light\" class=\"account-menu__info md-subhead md-whiteframe-1dp\" layout=\"row\" layout-align=\"start center\">\r\n                <div class=\"accent-1 account-menu__info__title\" layout=\"row\" layout-align=\"start center\"><md-icon class=\"accent-1\"> lock </md-icon>&nbsp;\r\n                    <span translate=\"lockStudentScreens\"></span>\r\n                </div>\r\n            </md-toolbar>\r\n            <md-content flex>\r\n                <md-switch ng-repeat=\"period in $ctrl.periods\"\r\n                           ng-if=\"period.periodId === -1\"\r\n                           class=\"md-primary account-menu__control\"\r\n                           aria-label=\"{{ 'lockPeriodLabel' | translate: { periodName: ('allPeriods' | translate) } }}\"\r\n                           ng-model=\"$ctrl.allPeriodsPaused\"\r\n                           ng-change=\"$ctrl.togglePeriod(period)\">\r\n                    {{ period.periodName }}\r\n                </md-switch>\r\n                <md-divider></md-divider>\r\n                <md-switch ng-repeat=\"period in $ctrl.periods\"\r\n                           ng-if=\"period.periodId !== -1\"\r\n                           class=\"md-primary account-menu__control\"\r\n                           aria-label=\"{{ 'lockPeriodLabel' | translate: { periodName: period.periodName } }}\"\r\n                           ng-model=\"period.paused\"\r\n                           ng-change=\"$ctrl.togglePeriod(period)\">\r\n                    {{ 'periodLabel' | translate:{ name: period.periodName } }}\r\n                </md-switch>\r\n            </md-content>\r\n        </div>`,\r\n    controller: PauseScreensMenuController\r\n};\r\n\r\nexport default PauseScreensMenu;\r\n"]}