{"version":3,"sources":["topBar.es6"],"names":["TopBarController","ConfigService","TeacherDataService","workgroupId","getWorkgroupId","$onChanges","changesObj","notifications","setNotifications","userNotifications","filter","notification","toWorkgroupId","newNotifications","timeDismissed","dismissedNotifications","isAnyPeriodPaused","$inject","TopBar","bindings","logoPath","projectId","projectTitle","runId","controller","template"],"mappings":"AAAA;;;;;;;;;;IAEMA,gB;AACF,8BAAYC,aAAZ,EACYC,kBADZ,EACgC;AAAA;;AAAA;;AAC5B,aAAKD,aAAL,GAAqBA,aAArB;AACA,aAAKC,kBAAL,GAA0BA,kBAA1B;;AAEA,aAAKC,WAAL,GAAmB,KAAKF,aAAL,CAAmBG,cAAnB,EAAnB;;AAEA,aAAKC,UAAL,GAAkB,UAACC,UAAD,EAAgB;AAC9B,gBAAIA,WAAWC,aAAf,EAA8B;AAC1B,sBAAKC,gBAAL;AACH;AACJ,SAJD;AAKH;;AAED;;;;;;;;2CAImB;AAAA;;AACf;AACA;AACA,gBAAIC,oBAAoB,KAAKF,aAAL,CAAmBG,MAAnB,CACpB,wBAAgB;AACZ,uBAAQC,aAAaC,aAAb,KAA+B,OAAKT,WAA5C;AACH,aAHmB,CAAxB;;AAMA,iBAAKU,gBAAL,GAAwBJ,kBAAkBC,MAAlB,CACpB,wBAAgB;AACZ,uBAAQC,aAAaG,aAAb,IAA8B,IAAtC;AACH,aAHmB,CAAxB;;AAMA,iBAAKC,sBAAL,GAA8BN,kBAAkBC,MAAlB,CAC1B,wBAAgB;AACZ,uBAAQC,aAAaG,aAAb,IAA8B,IAAtC;AACH,aAHyB,CAA9B;AAKH;;AAED;;;;;;;4CAIoB;AAChB,mBAAO,KAAKZ,kBAAL,CAAwBc,iBAAxB,EAAP;AACH;;;;;;AAGLhB,iBAAiBiB,OAAjB,GAA2B,CACvB,eADuB,EAEvB,oBAFuB,CAA3B;;AAKA,IAAMC,SAAS;AACXC,cAAU;AACNC,kBAAU,GADJ;AAENb,uBAAe,GAFT;AAGNc,mBAAW,GAHL;AAINC,sBAAc,GAJR;AAKNC,eAAO;AALD,KADC;AAQXC,gBAAYxB,gBARD;AASXyB;AATW,CAAf;;kBAmDeP,M","file":"topBar.js","sourcesContent":["\"use strict\";\r\n\r\nclass TopBarController {\r\n    constructor(ConfigService,\r\n                TeacherDataService) {\r\n        this.ConfigService = ConfigService;\r\n        this.TeacherDataService = TeacherDataService;\r\n\r\n        this.workgroupId = this.ConfigService.getWorkgroupId();\r\n\r\n        this.$onChanges = (changesObj) => {\r\n            if (changesObj.notifications) {\r\n                this.setNotifications();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Find all teacher notifications and separate into new and dismissed arrays\r\n     * TODO: move to TeacherDataService?\r\n     */\r\n    setNotifications() {\r\n        // get all notifications for the logged in teacher\r\n        // TODO: take into account shared teacher users!\r\n        let userNotifications = this.notifications.filter(\r\n            notification => {\r\n                return (notification.toWorkgroupId === this.workgroupId);\r\n            }\r\n        );\r\n\r\n        this.newNotifications = userNotifications.filter(\r\n            notification => {\r\n                return (notification.timeDismissed == null);\r\n            }\r\n        );\r\n\r\n        this.dismissedNotifications = userNotifications.filter(\r\n            notification => {\r\n                return (notification.timeDismissed != null);\r\n            }\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Check whether any period in the run is paused\r\n     * @return Boolean whether any of the periods are paused\r\n     */\r\n    isAnyPeriodPaused() {\r\n        return this.TeacherDataService.isAnyPeriodPaused();\r\n    }\r\n}\r\n\r\nTopBarController.$inject = [\r\n    'ConfigService',\r\n    'TeacherDataService'\r\n];\r\n\r\nconst TopBar = {\r\n    bindings: {\r\n        logoPath: '@',\r\n        notifications: '<',\r\n        projectId: '<',\r\n        projectTitle: '<',\r\n        runId: '<'\r\n    },\r\n    controller: TopBarController,\r\n    template:\r\n        `<md-toolbar class=\"l-header\">\r\n            <div class=\"md-toolbar-tools\">\r\n                <span class=\"md-button logo-link\">\r\n                    <img ng-src=\"{{ $ctrl.logoPath }}\" alt=\"{{ 'WISE_LOGO' | translate }}\" class=\"logo\" />\r\n                </span>\r\n                <h3>{{ $ctrl.projectTitle }} <span class=\"md-caption\">({{ 'RUN_ID_DISPLAY' | translate:{id: $ctrl.runId} }})</span></h3>\r\n                <span flex></span>\r\n                <md-menu md-position-mode=\"target-right target\" md-offset=\"52 26\">\r\n                    <md-button aria-label=\"{{ 'USER_MENU' | translate }}\"\r\n                               class=\"md-icon-button\"\r\n                               ng-class=\"{ 'has-indicator has-indicator--icon-button': $ctrl.isAnyPeriodPaused() }\"\r\n                               ng-click=\"$mdMenu.open($event)\">\r\n                        <md-icon md-menu-origin ng-if=\"$ctrl.isAnyPeriodPaused()\"> lock_outline </md-icon>\r\n                        <md-icon md-menu-origin ng-if=\"!$ctrl.isAnyPeriodPaused()\"> lock_open </md-icon>\r\n                    </md-button>\r\n                    <md-menu-content width=\"5\" class=\"account-menu\">\r\n                        <pause-screens-menu></pause-screens-menu>\r\n                    </md-menu-content>\r\n                </md-menu>\r\n                <md-menu md-position-mode=\"target-right target\" md-offset=\"40 26\">\r\n                    <md-button aria-label=\"{{ 'ALERTS' | translate }}\" class=\"md-icon-button notification-btn\" ng-click=\"$mdMenu.open($event)\">\r\n                        <span ng-show=\"$ctrl.newNotifications.length\" class=\"notification-count\">{{$ctrl.newNotifications.length}}</span>\r\n                        <md-icon md-menu-origin> notifications </md-icon>\r\n                    </md-button>\r\n                    <md-menu-content width=\"5\" class=\"account-menu\">\r\n                        <notifications-menu new-notifications=\"$ctrl.newNotifications\" dismissed-notifications=\"$ctrl.dismissedNotifications\"></notifications-menu>\r\n                    </md-menu-content>\r\n                </md-menu>\r\n                <md-menu id='accountMenu' md-position-mode=\"target-right target\" md-offset=\"8 26\">\r\n                    <md-button aria-label=\"{{ 'USER_MENU' | translate }}\" class=\"md-icon-button\" ng-click=\"$mdMenu.open($event)\">\r\n                        <md-icon md-menu-origin> account_box </md-icon>\r\n                    </md-button>\r\n                    <md-menu-content width=\"5\" class=\"account-menu\">\r\n                        <account-menu></account-menu>\r\n                    </md-menu-content>\r\n                </md-menu>\r\n            </div>\r\n        </md-toolbar>\r\n`\r\n};\r\n\r\nexport default TopBar;\r\n"]}