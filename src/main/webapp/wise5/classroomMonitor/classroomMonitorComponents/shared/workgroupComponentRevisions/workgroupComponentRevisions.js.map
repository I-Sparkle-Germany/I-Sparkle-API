{"version":3,"sources":["workgroupComponentRevisions.es6"],"names":["WorkgroupComponentRevisionsController","ConfigService","TeacherDataService","$onInit","populateData","increment","totalShown","data","componentStates","i","length","componentState","id","clientSaveTime","convertToClientTimestamp","serverSaveTime","time","inview","showMore","$inject","WorkgroupComponentRevisions","bindings","workgroupId","template","controller"],"mappings":"AAAA;;;;;;;;;;IAEMA,qC;AACF,mDAAYC,aAAZ,EACYC,kBADZ,EACgC;AAAA;;AAAA;;AAC5B,aAAKD,aAAL,GAAqBA,aAArB;AACA,aAAKC,kBAAL,GAA0BA,kBAA1B;;AAEA,aAAKC,OAAL,GAAe,YAAM;AACjB,kBAAKC,YAAL;;AAEA;;;;AAIA,kBAAKC,SAAL,GAAiB,CAAjB;AACA,kBAAKC,UAAL,GAAkB,MAAKD,SAAvB;AACH,SATD;AAUH;;;;;;AAED;;;uCAGe;AACX;AACA,iBAAKE,IAAL,GAAY,EAAZ;;AAEA;AACA,gBAAI,KAAKC,eAAT,EAA0B;AACtB,qBAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAI,KAAKD,eAAL,CAAqBE,MAAzC,EAAiDD,GAAjD,EAAsD;AAClD,wBAAIE,iBAAiB,KAAKH,eAAL,CAAqBC,CAArB,CAArB;AACA,wBAAIG,KAAKD,eAAeC,EAAxB;AACA,yBAAKL,IAAL,CAAUK,EAAV,IAAgB;AACZC,wCAAgB,KAAKC,wBAAL,CAA8BH,eAAeI,cAA7C,CADJ;AAEZJ,wCAAgBA;AAFJ,qBAAhB;AAIH;AACJ;AACJ;;;iDAEwBK,I,EAAM;AAC3B,mBAAO,KAAKf,aAAL,CAAmBa,wBAAnB,CAA4CE,IAA5C,CAAP;AACH;;AAED;;;;;;mCAGW;AACP,iBAAKV,UAAL,IAAmB,KAAKD,SAAxB;AACH;;AAED;;;;;;;mCAIWY,M,EAAQ;AACf,gBAAIA,UAAU,KAAKX,UAAL,GAAkB,KAAKD,SAArC,EAAgD;AAC5C;AACA,qBAAKa,QAAL;AACH;AACJ;;;;;;AAGLlB,sCAAsCmB,OAAtC,GAAgD,CAC5C,eAD4C,EAE5C,oBAF4C,CAAhD;;AAKA,IAAMC,8BAA8B;AAChCC,cAAU;AACNb,yBAAiB,GADX;AAENc,qBAAa;AAFP,KADsB;AAKhCC,ujDALgC;AAmChCC,gBAAYxB;AAnCoB,CAApC;;kBAsCeoB,2B","file":"workgroupComponentRevisions.js","sourcesContent":["\"use strict\";\r\n\r\nclass WorkgroupComponentRevisionsController {\r\n    constructor(ConfigService,\r\n                TeacherDataService) {\r\n        this.ConfigService = ConfigService;\r\n        this.TeacherDataService = TeacherDataService;\r\n\r\n        this.$onInit = () => {\r\n            this.populateData();\r\n\r\n            /**\r\n             * Set a constant specifying the number of additional component\r\n             * states to show each time more states are shown\r\n             */\r\n            this.increment = 5;\r\n            this.totalShown = this.increment;\r\n        };\r\n    };\r\n\r\n    /**\r\n     * Get the component states and annotations for this workgroup and component\r\n     */\r\n    populateData() {\r\n        // create a data object that holds the componentStates and accompanying annotations, keyed by componentState id\r\n        this.data = {};\r\n\r\n        // add componentStates to the data object\r\n        if (this.componentStates) {\r\n            for (let i = 0; i < this.componentStates.length; i++) {\r\n                let componentState = this.componentStates[i];\r\n                let id = componentState.id;\r\n                this.data[id] = {\r\n                    clientSaveTime: this.convertToClientTimestamp(componentState.serverSaveTime),\r\n                    componentState: componentState\r\n                };\r\n            }\r\n        }\r\n    }\r\n\r\n    convertToClientTimestamp(time) {\r\n        return this.ConfigService.convertToClientTimestamp(time);\r\n    }\r\n\r\n    /**\r\n     * Increase the number of component states shown by 5\r\n     */\r\n    showMore() {\r\n        this.totalShown += this.increment;\r\n    }\r\n\r\n    /**\r\n     * The show more element has come into or out of view\r\n     * @param inview whether the element is in view or not\r\n     */\r\n    moreInView(inview) {\r\n        if (inview && this.totalShown > this.increment) {\r\n            // automatically show more component states\r\n            this.showMore();\r\n        }\r\n    }\r\n}\r\n\r\nWorkgroupComponentRevisionsController.$inject = [\r\n    'ConfigService',\r\n    'TeacherDataService'\r\n];\r\n\r\nconst WorkgroupComponentRevisions = {\r\n    bindings: {\r\n        componentStates: '<',\r\n        workgroupId: '@'\r\n    },\r\n    template:\r\n        `<md-list class=\"component-revisions\">\r\n            <div ng-repeat=\"item in $ctrl.data | toArray | orderBy: '-clientSaveTime'\"\r\n                 ng-if=\"$index < $ctrl.totalShown\">\r\n                <md-list-item class=\"list-item md-whiteframe-1dp component-revisions__item\"\r\n                              ng-class=\"{'component-revisions__item--latest': $first}\">\r\n                    <div class=\"md-list-item-text component-revisions__item__text\"\r\n                         flex>\r\n                        <h3 class=\"accent-2 md-body-2 gray-lightest-bg component__header\">\r\n                            #{{$ctrl.componentStates.length - $index}}\r\n                            <span ng-if=\"$first\"> (Latest)</span>\r\n                        </h3>\r\n                        <div>\r\n                            <component component-state=\"{{ item.componentState }}\"\r\n                                       workgroup-id=\"{{ $ctrl.workgroupId }}\"\r\n                                       mode=\"gradingRevision\">\r\n                        </div>\r\n                    </div>\r\n                </md-list-item>\r\n            </div>\r\n            <div ng-if=\"$ctrl.totalShown > $ctrl.increment\"\r\n                 in-view=\"$ctrl.moreInView($inview)\"></div>\r\n            <div class=\"md-padding center\">\r\n                <md-button class=\"md-raised\"\r\n                           ng-if=\"$ctrl.totalShown <= $ctrl.increment\"\r\n                           ng-click=\"$ctrl.showMore()\"\r\n                           translate=\"SHOW_MORE\">\r\n                </md-button>\r\n            </div>\r\n        </md-list>`,\r\n    controller: WorkgroupComponentRevisionsController\r\n};\r\n\r\nexport default WorkgroupComponentRevisions;\r\n"]}