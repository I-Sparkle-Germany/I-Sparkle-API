{"version":3,"sources":["workgroupComponentRevisions.es6"],"names":["WorkgroupComponentRevisionsController","ConfigService","TeacherDataService","$onInit","populateData","componentStates","getComponentStatesByWorkgroupIdAndComponentId","workgroupId","componentId","data","c","length","i","componentState","id","clientSaveTime","convertToClientTimestamp","serverSaveTime","time","$inject","WorkgroupComponentRevisions","bindings","template","controller"],"mappings":"AAAA;;;;;;;;;;IAEMA,qC;AACF,mDAAYC,aAAZ,EACYC,kBADZ,EACgC;AAAA;;AAAA;;AAC5B,aAAKD,aAAL,GAAqBA,aAArB;AACA,aAAKC,kBAAL,GAA0BA,kBAA1B;;AAEA,aAAKC,OAAL,GAAe,YAAM;AACjB,kBAAKC,YAAL;AACH,SAFD;AAGH;;;;;;AAED;;;uCAGe;AACX,iBAAKC,eAAL,GAAuB,KAAKH,kBAAL,CAAwBI,6CAAxB,CAAsE,KAAKC,WAA3E,EAAwF,KAAKC,WAA7F,CAAvB;;AAEA;AACA,iBAAKC,IAAL,GAAY,EAAZ;;AAEA;AACA,gBAAIC,IAAI,KAAKL,eAAL,CAAqBM,MAA7B;AACA,iBAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIF,CAApB,EAAuBE,GAAvB,EAA4B;AACxB,oBAAIC,iBAAiB,KAAKR,eAAL,CAAqBO,CAArB,CAArB;AACA,oBAAIE,KAAKD,eAAeC,EAAxB;AACA,qBAAKL,IAAL,CAAUK,EAAV,IAAgB;AACZC,oCAAgB,KAAKC,wBAAL,CAA8BH,eAAeI,cAA7C,CADJ;AAEZJ,oCAAgBA;AAFJ,iBAAhB;AAIH;AACJ;;;iDAEwBK,I,EAAM;AAC3B,mBAAO,KAAKjB,aAAL,CAAmBe,wBAAnB,CAA4CE,IAA5C,CAAP;AACH;;;;;;AAGLlB,sCAAsCmB,OAAtC,GAAgD,CAC5C,eAD4C,EAE5C,oBAF4C,CAAhD;;AAKA,IAAMC,8BAA8B;AAChCC,cAAU;AACNd,qBAAa,GADP;AAENC,qBAAa;AAFP,KADsB;AAKhCc,g8BALgC;AAqBhCC,gBAAYvB;AArBoB,CAApC;;kBAwBeoB,2B","file":"workgroupComponentRevisions.js","sourcesContent":["\"use strict\";\r\n\r\nclass WorkgroupComponentRevisionsController {\r\n    constructor(ConfigService,\r\n                TeacherDataService) {\r\n        this.ConfigService = ConfigService;\r\n        this.TeacherDataService = TeacherDataService;\r\n\r\n        this.$onInit = () => {\r\n            this.populateData();\r\n        };\r\n    };\r\n\r\n    /**\r\n     * Get the component states and annotations for this workgroup and component\r\n     */\r\n    populateData() {\r\n        this.componentStates = this.TeacherDataService.getComponentStatesByWorkgroupIdAndComponentId(this.workgroupId, this.componentId);\r\n\r\n        // create a data object that holds the componentStates and accompanying annotations, keyed by componentState id\r\n        this.data = {};\r\n\r\n        // add componentStates to the data object\r\n        let c = this.componentStates.length;\r\n        for (let i = 0; i < c; i++) {\r\n            let componentState = this.componentStates[i];\r\n            let id = componentState.id;\r\n            this.data[id] = {\r\n                clientSaveTime: this.convertToClientTimestamp(componentState.serverSaveTime),\r\n                componentState: componentState\r\n            };\r\n        }\r\n    }\r\n\r\n    convertToClientTimestamp(time) {\r\n        return this.ConfigService.convertToClientTimestamp(time);\r\n    }\r\n}\r\n\r\nWorkgroupComponentRevisionsController.$inject = [\r\n    'ConfigService',\r\n    'TeacherDataService'\r\n];\r\n\r\nconst WorkgroupComponentRevisions = {\r\n    bindings: {\r\n        workgroupId: '@',\r\n        componentId: '@'\r\n    },\r\n    template:\r\n        `<md-list class=\"component-revisions\">\r\n            <div ng-repeat=\"item in $ctrl.data | toArray | orderBy: '-clientSaveTime'\">\r\n                <md-list-item class=\"list-item md-whiteframe-1dp component-revisions__item\" ng-class=\"{'component-revisions__item--latest': $first}\">\r\n                    <div class=\"md-list-item-text component-revisions__item__text\" flex>\r\n                        <h3 class=\"accent-2 md-body-2 gray-lightest-bg component__header\">\r\n                            #{{$ctrl.componentStates.length - $index}}\r\n                            <span ng-if=\"$first\"> (Latest)</span>\r\n                        </h3>\r\n                        <div>\r\n                            <component component-state=\"{{ item.componentState }}\" workgroup-id=\"{{ $ctrl.workgroupId }}\" mode=\"gradingRevision\">\r\n                        </div>\r\n                    </div>\r\n                </md-list-item>\r\n            </div>\r\n        </md-list>`,\r\n    controller: WorkgroupComponentRevisionsController\r\n};\r\n\r\nexport default WorkgroupComponentRevisions;\r\n"]}