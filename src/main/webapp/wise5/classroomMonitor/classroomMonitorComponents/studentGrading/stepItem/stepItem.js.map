{"version":3,"sources":["stepItem.es6"],"names":["StepItemController","$filter","$translate","statusText","$onChanges","changesObj","maxScore","currentValue","stepData","angular","copy","title","hasAlert","hasNewAlert","status","completionStatus","score","update","completion","statusClass","showScore","disabled","expand","onUpdateExpand","nodeId","value","$inject","StepItem","bindings","workgroupId","controller","template"],"mappings":"AAAA;;;;;;;;;;IAEMA,kB;AACJ,8BAAYC,OAAZ,EAAqB;AAAA;;AAAA;;AACnB,SAAKA,OAAL,GAAeA,OAAf;AACA,SAAKC,UAAL,GAAkB,KAAKD,OAAL,CAAa,WAAb,CAAlB;AACA,SAAKE,UAAL,GAAkB,EAAlB;;AAEA,SAAKC,UAAL,GAAkB,UAACC,UAAD,EAAgB;AAChC,UAAIA,WAAWC,QAAf,EAAyB;AACvB,cAAKA,QAAL,GAAgB,OAAOD,WAAWC,QAAX,CAAoBC,YAA3B,KAA4C,QAA5C,GACdF,WAAWC,QAAX,CAAoBC,YADN,GACqB,CADrC;AAED;;AAED,UAAIF,WAAWG,QAAf,EAAyB;AACvB,YAAIA,WAAWC,QAAQC,IAAR,CAAaL,WAAWG,QAAX,CAAoBD,YAAjC,CAAf;AACA,cAAKI,KAAL,GAAaH,SAASG,KAAtB;AACA,cAAKC,QAAL,GAAgBJ,SAASI,QAAzB;AACA,cAAKC,WAAL,GAAmBL,SAASK,WAA5B;AACA,cAAKC,MAAL,GAAcN,SAASO,gBAAvB;AACA,cAAKC,KAAL,GAAaR,SAASQ,KAAT,IAAkB,CAAlB,GAAsBR,SAASQ,KAA/B,GAAuC,GAApD;AACD;;AAED,YAAKC,MAAL;AACD,KAhBD;AAiBD;;;;6BAEQ;AACP,UAAIC,aAAa,CAAjB;;AAEA,cAAQ,KAAKJ,MAAb;AACE,aAAK,CAAC,CAAN;AACE,eAAKK,WAAL,GAAmB,GAAnB;AACA,eAAKhB,UAAL,GAAkB,KAAKD,UAAL,CAAgB,aAAhB,CAAlB;AACA;AACF,aAAK,CAAL;AACE,eAAKiB,WAAL,GAAmB,SAAnB;;AAEA,cAAI,KAAKC,SAAT,EAAoB;AAClB,iBAAKjB,UAAL,GAAkB,KAAKD,UAAL,CAAgB,WAAhB,CAAlB;AACD,WAFD,MAEO;AACL,iBAAKC,UAAL,GAAkB,KAAKD,UAAL,CAAgB,SAAhB,CAAlB;AACD;AACD;AACF,aAAK,CAAL;AACE,eAAKiB,WAAL,GAAmB,MAAnB;;AAEA,eAAKhB,UAAL,GAAkB,KAAKD,UAAL,CAAgB,oBAAhB,CAAlB;AACA;AACF;AACE,eAAKiB,WAAL,GAAmB,gBAAnB;;AAEA,cAAI,KAAKC,SAAT,EAAoB;AAClB,iBAAKjB,UAAL,GAAkB,KAAKD,UAAL,CAAgB,QAAhB,CAAlB;AACD,WAFD,MAEO;AACL,iBAAKC,UAAL,GAAkB,KAAKD,UAAL,CAAgB,YAAhB,CAAlB;AACD;AA1BL;;AA6BA,UAAI,KAAKW,WAAT,EAAsB;AACpB,aAAKM,WAAL,GAAmB,MAAnB;AACD;;AAED,WAAKE,QAAL,GAAiB,KAAKP,MAAL,KAAgB,CAAC,CAAlC;AACD;;;mCAEc;AACb,UAAI,KAAKM,SAAT,EAAoB;AAClB,YAAIE,SAAS,CAAC,KAAKA,MAAnB;AACA,aAAKC,cAAL,CAAoB,EAACC,QAAQ,KAAKA,MAAd,EAAsBC,OAAOH,MAA7B,EAApB;AACD;AACF;;;;;;AAGHtB,mBAAmB0B,OAAnB,GAA6B,CAC3B,SAD2B,CAA7B;;AAIA,IAAMC,WAAW;AACfC,YAAU;AACRN,YAAQ,GADA;AAERhB,cAAU,GAFF;AAGRkB,YAAQ,GAHA;AAIRJ,eAAW,GAJH;AAKRS,iBAAa,GALL;AAMRrB,cAAU,GANF;AAORe,oBAAgB;AAPR,GADK;AAUfO,cAAY9B,kBAVG;AAWf+B;AAXe,CAAjB;;kBA0DeJ,Q","file":"stepItem.js","sourcesContent":["\"use strict\";\r\n\r\nclass StepItemController {\r\n  constructor($filter) {\r\n    this.$filter = $filter;\r\n    this.$translate = this.$filter('translate');\r\n    this.statusText = '';\r\n\r\n    this.$onChanges = (changesObj) => {\r\n      if (changesObj.maxScore) {\r\n        this.maxScore = typeof changesObj.maxScore.currentValue === 'number' ?\r\n          changesObj.maxScore.currentValue : 0;\r\n      }\r\n\r\n      if (changesObj.stepData) {\r\n        let stepData = angular.copy(changesObj.stepData.currentValue);\r\n        this.title = stepData.title;\r\n        this.hasAlert = stepData.hasAlert;\r\n        this.hasNewAlert = stepData.hasNewAlert;\r\n        this.status = stepData.completionStatus;\r\n        this.score = stepData.score >= 0 ? stepData.score : '-';\r\n      }\r\n\r\n      this.update();\r\n    };\r\n  };\r\n\r\n  update() {\r\n    let completion = 0;\r\n\r\n    switch (this.status) {\r\n      case -1:\r\n        this.statusClass = ' ';\r\n        this.statusText = this.$translate('notAssigned');\r\n        break;\r\n      case 2:\r\n        this.statusClass = 'success';\r\n\r\n        if (this.showScore) {\r\n          this.statusText = this.$translate('completed');\r\n        } else {\r\n          this.statusText = this.$translate('visited');\r\n        }\r\n        break;\r\n      case 1:\r\n        this.statusClass = 'text';\r\n\r\n        this.statusText = this.$translate('partiallyCompleted');\r\n        break;\r\n      default:\r\n        this.statusClass = 'text-secondary';\r\n\r\n        if (this.showScore) {\r\n          this.statusText = this.$translate('noWork');\r\n        } else {\r\n          this.statusText = this.$translate('notVisited');\r\n        }\r\n    }\r\n\r\n    if (this.hasNewAlert) {\r\n      this.statusClass = 'warn';\r\n    }\r\n\r\n    this.disabled = (this.status === -1);\r\n  }\r\n\r\n  toggleExpand() {\r\n    if (this.showScore) {\r\n      let expand = !this.expand;\r\n      this.onUpdateExpand({nodeId: this.nodeId, value: expand});\r\n    }\r\n  }\r\n}\r\n\r\nStepItemController.$inject = [\r\n  '$filter'\r\n];\r\n\r\nconst StepItem = {\r\n  bindings: {\r\n    expand: '<',\r\n    maxScore: '<',\r\n    nodeId: '<',\r\n    showScore: '<',\r\n    workgroupId: '<',\r\n    stepData: '<',\r\n    onUpdateExpand: '&'\r\n  },\r\n  controller: StepItemController,\r\n  template:\r\n    `<div class=\"md-whiteframe-1dp\"\r\n          ng-class=\"{ 'list-item--warn': $ctrl.statusClass === 'warn',\r\n            'list-item--info': $ctrl.statusClass === 'info' }\">\r\n      <md-subheader class=\"list-item md-whiteframe-1dp\">\r\n        <button class=\"md-button md-ink-ripple list-item__subheader-button\"\r\n                aria-label=\"{{ toggleTeamWorkDisplay | translate }}\"\r\n                ng-class=\"{ 'list-item--noclick': !$ctrl.showScore ||\r\n                  $ctrl.disabled }\"\r\n                ng-click=\"$ctrl.toggleExpand()\"\n                ng-disabled=\"$ctrl.disabled\"\r\n                layout-wrap>\r\n          <div layout=\"row\" flex>\r\n            <div flex layout=\"row\" layout-align=\"start center\">\r\n              <step-info has-alert=\"$ctrl.hasAlert\"\r\n                         has-new-alert=\"$ctrl.hasNewAlert\"\r\n                         has-new-work=\"$ctrl.hasNewWork\"\r\n                         node-id=\"$ctrl.nodeId\"\r\n                         node-title=\"{{ $ctrl.title }}\"\r\n                         show-position=\"true\"></step-info>\r\n            </div>\r\n            <div flex=\"{{ $ctrl.showScore ? 30 : 20 }}\" layout=\"row\"\r\n                 layout-align=\"center center\">\r\n              <workgroup-node-status status-text=\"{{ $ctrl.statusText }}\"\r\n                                     status-class=\"{{ $ctrl.statusClass }}\">\r\n              </workgroup-node-status>\r\n            </div>\r\n            <div ng-if=\"$ctrl.showScore\" flex=\"20\" layout=\"row\"\r\n                 layout-align=\"center center\">\r\n              <workgroup-node-score score=\"{{ $ctrl.score }}\"\r\n                                    max-score=\"{{ $ctrl.maxScore }}\">\r\n              </workgroup-node-score>\r\n            </div>\r\n          </div>\r\n        </button>\r\n      </md-subheader>\r\n      <md-list-item ng-if=\"$ctrl.expand && !$ctrl.disabled\"\r\n                    class=\"grading__item-container\">\r\n        <workgroup-node-grading workgroup-id=\"$ctrl.workgroupId\"\r\n                                class=\"workgroup-node-grading\"\r\n                                node-id=\"{{ $ctrl.nodeId }}\"\r\n                                hidden-components=\"[]\"\r\n                                flex></workgroup-node-grading>\r\n      </md-list-item>\r\n    </div>`\r\n};\r\n\r\nexport default StepItem;\r\n"]}