{"version":3,"sources":["studentGradingTools.es6"],"names":["StudentGradingToolsController","$filter","$scope","$state","orderBy","ConfigService","TeacherDataService","$translate","is_rtl","$","attr","icons","prev","next","$onInit","selectTeamPlaceholder","$onChanges","avatarColor","getAvatarColorForWorkgroupId","workgroupId","periodId","getCurrentPeriod","workgroups","angular","copy","getClassmateUserInfos","filterForPeriod","$on","event","args","currentPeriod","n","length","i","workgroup","visible","setNextAndPrev","currentWorkgroupId","prevId","getPrevId","nextId","getNextId","id","prevWorkgroup","nextWorkgroup","go","$inject","StudentGradingTools","bindings","template","controller"],"mappings":"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","file":"studentGradingTools.js","sourcesContent":["\"use strict\";\n\nclass StudentGradingToolsController {\n  constructor($filter,\n              $scope,\n              $state,\n              orderBy,\n              ConfigService,\n              TeacherDataService) {\n    this.$filter = $filter;\n    this.$scope = $scope;\n    this.$state = $state;\n    this.orderBy = orderBy;\n    this.ConfigService = ConfigService;\n    this.TeacherDataService = TeacherDataService;\n    this.$translate = this.$filter('translate');\n    \n    this.is_rtl = ($('html').attr('dir') == 'rtl');\n    this.icons = { prev: 'chevron_left', next: 'chevron_right' };\n    if (this.is_rtl) {\n      this.icons = { prev: 'chevron_right', next: 'chevron_left' };\n    }\n\n    this.$onInit = () => {\n      this.selectTeamPlaceholder = this.$translate('selectATeam');\n    }\n\n    this.$onChanges = () => {\n      this.avatarColor = this.ConfigService.getAvatarColorForWorkgroupId(this.workgroupId);\n      this.periodId = this.TeacherDataService.getCurrentPeriod().periodId;\n      let workgroups = angular.copy(this.ConfigService.getClassmateUserInfos());\n      this.workgroups = this.orderBy(workgroups, 'workgroupId');\n      this.filterForPeriod();\n    };\n\n    /**\n     * Listen for current period changed event\n     */\n    this.$scope.$on('currentPeriodChanged', (event, args) => {\n        this.periodId = args.currentPeriod.periodId;\n        this.filterForPeriod();\n    });\n  }\n\n  filterForPeriod() {\n    let n = this.workgroups.length;\n    for (let i = 0; i < n; i++) {\n      let workgroup = this.workgroups[i];\n      let periodId = workgroup.periodId;\n      if (this.periodId === -1 || periodId === this.periodId) {\n        workgroup.visible = true;\n      } else {\n        workgroup.visible = false;\n      }\n    }\n\n    this.setNextAndPrev();\n  }\n\n  setNextAndPrev() {\n    let currentWorkgroupId = this.workgroupId;\n    this.prevId = this.getPrevId(currentWorkgroupId);\n    this.nextId = this.getNextId(currentWorkgroupId);\n  }\n\n  getPrevId(id) {\n    let prevId = null;\n    let n = this.workgroups.length;\n    for (let i = 0; i < n; i++) {\n      let workgroupId = this.workgroups[i].workgroupId;\n      if (workgroupId === id) {\n        if (i > 0) {\n          let prevWorkgroup = this.workgroups[i-1];\n          if (prevWorkgroup.visible) {\n            prevId = prevWorkgroup.workgroupId;\n          } else {\n            prevId = this.getPrevId(prevWorkgroup.workgroupId);\n          }\n        }\n        break;\n      }\n    }\n    return prevId;\n  }\n\n  getNextId(id) {\n    let nextId = null;\n    let n = this.workgroups.length;\n    for (let i = 0; i < n; i++) {\n      let workgroupId = this.workgroups[i].workgroupId;\n      if (workgroupId === id) {\n        if (i < n-1) {\n          let nextWorkgroup = this.workgroups[i+1];\n          if (nextWorkgroup.visible) {\n            nextId = nextWorkgroup.workgroupId;\n          } else {\n            nextId = this.getNextId(nextWorkgroup.workgroupId);\n          }\n        }\n        break;\n      }\n    }\n    return nextId;\n  }\n\n  goToPrevTeam() {\n    this.$state.go('root.team', {workgroupId: this.prevId});\n  }\n\n  goToNextTeam() {\n    this.$state.go('root.team', {workgroupId: this.nextId});\n  }\n}\n\nStudentGradingToolsController.$inject = [\n  '$filter',\n  '$scope',\n  '$state',\n  'orderByFilter',\n  'ConfigService',\n  'TeacherDataService'\n];\n\nconst StudentGradingTools = {\n  bindings: {\n    workgroupId: '<'\n  },\n  template:\n    `<div layout=\"row\" layout-align=\"center center\">\n      <md-button aria-label=\"{{ 'previousTeam' | translate }}\"\n                 class=\"md-icon-button toolbar__nav\"\n                 ng-disabled=\"!$ctrl.prevId\" ng-click=\"$ctrl.goToPrevTeam()\">\n        <md-icon> {{ $ctrl.icons.prev }} </md-icon>\n        <md-tooltip md-direction=\"bottom\">{{ 'previousTeam' | translate }}</md-tooltip>\n      </md-button>\n      <md-icon class=\"md-30\" hide-xs\n               style=\"color: {{ $ctrl.avatarColor }};\"> account_circle </md-icon>&nbsp;\n      <workgroup-select custom-class=\"'md-button md-no-underline\n                          toolbar__select toolbar__select--fixedwidth'\"\n                        custom-placeholder=\"$ctrl.selectTeamPlaceholder\"></workgroup-select>\n      <md-button aria-label=\"{{ 'nextTeam' | translate }}\"\n                 class=\"md-icon-button toolbar__nav\"\n                 ng-disabled=\"!$ctrl.nextId\" ng-click=\"$ctrl.goToNextTeam()\">\n        <md-icon> {{ $ctrl.icons.next }} </md-icon>\n        <md-tooltip md-direction=\"bottom\">{{ 'nextTeam' | translate }}</md-tooltip>\n      </md-button>\n    </div>`,\n  controller: StudentGradingToolsController\n};\n\nexport default StudentGradingTools;\n"]}