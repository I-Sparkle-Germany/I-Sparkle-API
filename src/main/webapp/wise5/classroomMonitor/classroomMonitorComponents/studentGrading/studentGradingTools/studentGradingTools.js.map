{"version":3,"sources":["studentGradingTools.es6"],"names":["StudentGradingToolsController","$filter","$scope","$state","orderBy","ConfigService","TeacherDataService","$translate","$onInit","selectTeamPlaceholder","$onChanges","avatarColor","getAvatarColorForWorkgroupId","workgroupId","periodId","getCurrentPeriod","workgroups","angular","copy","getClassmateUserInfos","filterForPeriod","$on","event","args","currentPeriod","n","length","i","workgroup","visible","setNextAndPrev","currentWorkgroupId","prevId","getPrevId","nextId","getNextId","id","prevWorkgroup","nextWorkgroup","go","$inject","StudentGradingTools","bindings","template","controller"],"mappings":"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","file":"studentGradingTools.js","sourcesContent":["\"use strict\";\r\n\r\nclass StudentGradingToolsController {\r\n  constructor($filter,\r\n              $scope,\r\n              $state,\r\n              orderBy,\r\n              ConfigService,\r\n              TeacherDataService) {\r\n    this.$filter = $filter;\r\n    this.$scope = $scope;\r\n    this.$state = $state;\r\n    this.orderBy = orderBy;\r\n    this.ConfigService = ConfigService;\r\n    this.TeacherDataService = TeacherDataService;\r\n    this.$translate = this.$filter('translate');\r\n\r\n    this.$onInit = () => {\r\n      this.selectTeamPlaceholder = this.$translate('selectATeam');\r\n    }\r\n\r\n    this.$onChanges = () => {\r\n      this.avatarColor = this.ConfigService.getAvatarColorForWorkgroupId(this.workgroupId);\r\n      this.periodId = this.TeacherDataService.getCurrentPeriod().periodId;\r\n      let workgroups = angular.copy(this.ConfigService.getClassmateUserInfos());\r\n      this.workgroups = this.orderBy(workgroups, 'workgroupId');\r\n      this.filterForPeriod();\r\n    };\r\n\r\n    /**\r\n     * Listen for current period changed event\r\n     */\r\n    this.$scope.$on('currentPeriodChanged', (event, args) => {\r\n        this.periodId = args.currentPeriod.periodId;\r\n        this.filterForPeriod();\r\n    });\r\n  }\r\n\r\n  filterForPeriod() {\r\n    let n = this.workgroups.length;\r\n    for (let i = 0; i < n; i++) {\r\n      let workgroup = this.workgroups[i];\r\n      let periodId = workgroup.periodId;\r\n      if (this.periodId === -1 || periodId === this.periodId) {\r\n        workgroup.visible = true;\r\n      } else {\r\n        workgroup.visible = false;\r\n      }\r\n    }\r\n\r\n    this.setNextAndPrev();\r\n  }\r\n\r\n  setNextAndPrev() {\r\n    let currentWorkgroupId = this.workgroupId;\r\n    this.prevId = this.getPrevId(currentWorkgroupId);\r\n    this.nextId = this.getNextId(currentWorkgroupId);\r\n  }\r\n\r\n  getPrevId(id) {\r\n    let prevId = null;\r\n    let n = this.workgroups.length;\r\n    for (let i = 0; i < n; i++) {\r\n      let workgroupId = this.workgroups[i].workgroupId;\r\n      if (workgroupId === id) {\r\n        if (i > 0) {\r\n          let prevWorkgroup = this.workgroups[i-1];\r\n          if (prevWorkgroup.visible) {\r\n            prevId = prevWorkgroup.workgroupId;\r\n          } else {\r\n            prevId = this.getPrevId(prevWorkgroup.workgroupId);\r\n          }\r\n        }\r\n        break;\r\n      }\r\n    }\r\n    return prevId;\r\n  }\r\n\r\n  getNextId(id) {\r\n    let nextId = null;\r\n    let n = this.workgroups.length;\r\n    for (let i = 0; i < n; i++) {\r\n      let workgroupId = this.workgroups[i].workgroupId;\r\n      if (workgroupId === id) {\r\n        if (i < n-1) {\r\n          let nextWorkgroup = this.workgroups[i+1];\r\n          if (nextWorkgroup.visible) {\r\n            nextId = nextWorkgroup.workgroupId;\r\n          } else {\r\n            nextId = this.getNextId(nextWorkgroup.workgroupId);\r\n          }\r\n        }\r\n        break;\r\n      }\r\n    }\r\n    return nextId;\r\n  }\r\n\r\n  goToPrevTeam() {\r\n    this.$state.go('root.team', {workgroupId: this.prevId});\r\n  }\r\n\r\n  goToNextTeam() {\r\n    this.$state.go('root.team', {workgroupId: this.nextId});\r\n  }\r\n}\r\n\r\nStudentGradingToolsController.$inject = [\r\n  '$filter',\r\n  '$scope',\r\n  '$state',\r\n  'orderByFilter',\r\n  'ConfigService',\r\n  'TeacherDataService'\r\n];\r\n\r\nconst StudentGradingTools = {\r\n  bindings: {\r\n    workgroupId: '<'\r\n  },\r\n  template:\r\n    `<div layout=\"row\" layout-align=\"center center\">\r\n      <md-icon class=\"md-30\" style=\"color: {{ $ctrl.avatarColor }};\"> account_circle </md-icon>\r\n      <workgroup-select custom-class=\"'node-select md-subhead'\"\r\n                        custom-placeholder=\"$ctrl.selectTeamPlaceholder\"></workgroup-select>\r\n      <span flex></span>\r\n      <md-button aria-label=\"{{ 'previousTeam' | translate }}\"\r\n                 class=\"md-icon-button node-nav\"\r\n                 ng-disabled=\"!$ctrl.prevId\" ng-click=\"$ctrl.goToPrevTeam()\">\r\n        <md-icon> arrow_back </md-icon>\r\n        <md-tooltip md-direction=\"bottom\">{{ 'previousTeam' | translate }}</md-tooltip>\r\n      </md-button>\r\n      <md-button aria-label=\"{{ 'nextTeam' | translate }}\"\r\n                 class=\"md-icon-button node-nav\"\r\n                 ng-disabled=\"!$ctrl.nextId\" ng-click=\"$ctrl.goToNextTeam()\">\r\n        <md-icon> arrow_forward </md-icon>\r\n        <md-tooltip md-direction=\"bottom\">{{ 'nextTeam' | translate }}</md-tooltip>\r\n      </md-button>\r\n      <!--<period-select flat=\"true\" custom-class=\"'node-select md-body-2'\"></period-select>-->\r\n    </div>`,\r\n  controller: StudentGradingToolsController\r\n};\r\n\r\nexport default StudentGradingTools;\r\n"]}