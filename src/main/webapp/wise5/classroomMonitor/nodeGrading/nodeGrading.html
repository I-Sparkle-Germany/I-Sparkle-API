<div class="l-constrained node-grading">
    <div class="flex md-subhead content-head" layout="row" layout-align="start center" layout-wrap>
        <h2 class="accent-2" layout="row" layout-align="start center">
            <div class="content-head__item">{{nodeGradingController.getNodeCompletion(nodeGradingController.nodeId)}}%</span><span class="md-subhead" translate="completion"></div>
            <div class="content-head__item" ng-if="nodeGradingController.showScore" layout="row" layout-align="start center"><md-icon class="score md-48">grade</md-icon> <div>{{nodeGradingController.getNodeAverageScore()}}<span class="md-subhead">mean score</div>
        </h2>
        <md-button ng-show="nodeGradingController.showRubricButton"
                   ng-click="nodeGradingController.showRubric()"
                   ng-class="md-primary">{{ 'showStepRubric' | translate }}</md-button>
        <span flex></span>
        <div>
            <span class="text-secondary" layout-margin>
               <ng-pluralize count="nodeGradingController.getNumberOfStudentsInPeriod()"
                   when="{'0': '{{&quot;numberOfTeams_0&quot; | translate}}',
                       'one': '{{&quot;numberOfTeams_1&quot; | translate}}',
                       'other': '{{&quot;numberOfTeams_other&quot; | translate:{count:nodeGradingController.getNumberOfStudentsInPeriod()} }}'}">
               </ng-pluralize>
            </span>
            <period-select></period-select>
        </div>
    </div>

    <md-list class="user-list">
        <md-list-item class="md-whiteframe-z1 list-item list-item--actions">
            <workgroup-select></workgroup-select>
            <span flex></span>
            <div class="text-secondary">
                <md-button aria-label="{{ 'explandAllTeams' | translate }}"
                           class="button--small md-primary"
                           ng-click="nodeGradingController.expandAll()">
                    <md-icon>expand_more</md-icon> {{ 'All' | translate }}
                </md-button>
                <md-button aria-label="{{ 'collapseAllTeams' | translate }}"
                           class="button--small md-primary"
                           ng-click="nodeGradingController.collapseAll()">
                    <md-icon>expand_less</md-icon> {{ 'All' | translate }}
                </md-button>
            </div>
        </md-list-item>
        <md-list-item class="thead md-whiteframe-z1">
            <div class="md-list-item-text thead__row" layout="row" flex>
                <md-button class="thead__link" flex layout="row" layout-align="start center"
                   ng-click="nodeGradingController.setSort('team')" title="{{'sortByTeam' | translate}}">
                    <span translate="team"></span>
                    <md-icon ng-if="nodeGradingController.sort === 'team' || nodeGradingController.sort === '-team'" class="text-light thead__sort" ng-class="{'thead__sort--reverse': nodeGradingController.sort === '-team'}"> arrow_drop_up </md-icon>
                </md-button>
                <md-button class="thead__link" flex="30" layout="row" layout-align="center center"
                   ng-click="nodeGradingController.setSort('status')" title="{{'sortByCompletion' | translate}}">
                    <span translate="status"></span>
                    <md-icon ng-if="nodeGradingController.sort === 'status' || nodeGradingController.sort === '-status'" class="text-light thead__sort" ng-class="{'thead__sort--reverse': nodeGradingController.sort === '-status'}"> arrow_drop_up </md-icon>
                </md-button>
                <!--<div flex="20" layout="row" layout-align="center center">Time Spent</div>-->
                <md-button class="thead__link" ng-if="nodeGradingController.showScore" flex="20" layout="row" layout-align="center center"
                   ng-click="nodeGradingController.setSort('score')" title="{{'sortByScore' | translate}}">
                    <span translate="score"></span>
                    <md-icon ng-if="nodeGradingController.sort === 'score' || nodeGradingController.sort === '-score'" class="text-light thead__sort" ng-class="{'thead__sort--reverse': nodeGradingController.sort === '-score'}"> arrow_drop_up </md-icon>
                </md-button>
            </div>
        </md-list-item>
        <workgroup-item ng-repeat="workgroup in nodeGradingController.workgroupsById | toArray | orderBy:nodeGradingController.getOrderBy()"
                        ng-if="nodeGradingController.isWorkgroupShown(workgroup.$key)"
                        expand="nodeGradingController.workVisibilityById[workgroup.$key]"
                        max-score="nodeGradingController.maxScore"
                        show-score="nodeGradingController.showScore"
                        node-id="nodeGradingController.nodeId"
                        workgroup-id="workgroup.$key"
                        workgroup-data="workgroup"
                        hidden-components="nodeGradingController.hiddenComponents"
                        on-update-hidden="nodeGradingController.onUpdateHiddenComponents(value, event)"
                        on-update-expand="nodeGradingController.onUpdateExpand(workgroupId, value)"></workgroup-item>
    </md-list>
</div>
