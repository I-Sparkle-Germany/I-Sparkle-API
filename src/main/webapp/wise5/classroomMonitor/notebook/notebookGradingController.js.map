{"version":3,"sources":["notebookGradingController.es6"],"names":["NotebookGradingController","$rootScope","$scope","$state","ConfigService","NotebookService","ProjectService","StudentStatusService","TeacherDataService","TeacherWebSocketService","themePath","getThemePath","teacherWorkgroupId","getWorkgroupId","workgroups","getClassmateUserInfos","noteFilter","reportFilter","showAllNotes","showAllReports","showNoteForWorkgroup","showReportForWorkgroup","i","length","workgroup","workgroupId","canViewStudentNames","canGradeStudentWork","role","getTeacherRole","context","nodeId","componentId","componentType","category","event","data","saveEvent","alert","getCurrentPeriod","$inject"],"mappings":"AAAA;;;;;;;;;;IAEMA,yB;AAEF,uCAAYC,UAAZ,EACYC,MADZ,EAEYC,MAFZ,EAGYC,aAHZ,EAIYC,eAJZ,EAKYC,cALZ,EAMYC,oBANZ,EAOYC,kBAPZ,EAQYC,uBARZ,EAQqC;AAAA;;AACjC,aAAKR,UAAL,GAAkBA,UAAlB;AACA,aAAKC,MAAL,GAAcA,MAAd;AACA,aAAKC,MAAL,GAAcA,MAAd;AACA,aAAKC,aAAL,GAAqBA,aAArB;AACA,aAAKC,eAAL,GAAuBA,eAAvB;AACA,aAAKC,cAAL,GAAsBA,cAAtB;AACA,aAAKC,oBAAL,GAA4BA,oBAA5B;AACA,aAAKC,kBAAL,GAA0BA,kBAA1B;AACA,aAAKC,uBAAL,GAA+BA,uBAA/B;;AAEA,aAAKC,SAAL,GAAiB,KAAKJ,cAAL,CAAoBK,YAApB,EAAjB;;AAEA,aAAKC,kBAAL,GAA0B,KAAKR,aAAL,CAAmBS,cAAnB,EAA1B;;AAEA;AACA,aAAKC,UAAL,GAAkB,KAAKV,aAAL,CAAmBW,qBAAnB,EAAlB;;AAEA,aAAKC,UAAL,GAAkB,MAAlB;AACA,aAAKC,YAAL,GAAoB,QAApB;;AAEA,aAAKC,YAAL,GAAoB,KAApB;AACA,aAAKC,cAAL,GAAsB,KAAtB;AACA,aAAKC,oBAAL,GAA4B,EAA5B;AACA,aAAKC,sBAAL,GAA8B,EAA9B;AACA,aAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAI,KAAKR,UAAL,CAAgBS,MAApC,EAA4CD,GAA5C,EAAiD;AAC7C,gBAAIE,YAAY,KAAKV,UAAL,CAAgBQ,CAAhB,CAAhB;AACA,iBAAKF,oBAAL,CAA0BI,UAAUC,WAApC,IAAmD,KAAnD;AACA,iBAAKJ,sBAAL,CAA4BG,UAAUC,WAAtC,IAAqD,KAArD;AACH;;AAED,aAAKC,mBAAL,GAA2B,IAA3B;AACA,aAAKC,mBAAL,GAA2B,IAA3B;;AAEA;AACA,YAAIC,OAAO,KAAKxB,aAAL,CAAmByB,cAAnB,CAAkC,KAAKjB,kBAAvC,CAAX;;AAEA,YAAIgB,SAAS,OAAb,EAAsB;AAClB;AACA,iBAAKF,mBAAL,GAA2B,IAA3B;AACA,iBAAKC,mBAAL,GAA2B,IAA3B;AACH,SAJD,MAIO,IAAIC,SAAS,OAAb,EAAsB;AACzB;AACA,iBAAKF,mBAAL,GAA2B,IAA3B;AACA,iBAAKC,mBAAL,GAA2B,IAA3B;AACH,SAJM,MAIA,IAAIC,SAAS,MAAb,EAAqB;AACxB;AACA,iBAAKF,mBAAL,GAA2B,KAA3B;AACA,iBAAKC,mBAAL,GAA2B,KAA3B;AACH;;AAED;AACA,YAAIG,UAAU,kBAAd;AAAA,YAAkCC,SAAS,IAA3C;AAAA,YAAiDC,cAAc,IAA/D;AAAA,YAAqEC,gBAAgB,IAArF;AAAA,YACIC,WAAW,YADf;AAAA,YAC6BC,QAAQ,uBADrC;AAAA,YAC8DC,OAAO,EADrE;AAEA,aAAK5B,kBAAL,CAAwB6B,SAAxB,CAAkCP,OAAlC,EAA2CC,MAA3C,EAAmDC,WAAnD,EAAgEC,aAAhE,EAA+EC,QAA/E,EAAyFC,KAAzF,EAAgGC,IAAhG;AACH;;;;sDAE6BX,W,EAAa;AACvC,iBAAKL,oBAAL,CAA0BK,WAA1B,IAAyC,CAAC,KAAKL,oBAAL,CAA0BK,WAA1B,CAA1C;AACH;;;wDAE+BA,W,EAAa;AACzC,iBAAKJ,sBAAL,CAA4BI,WAA5B,IAA2C,CAAC,KAAKJ,sBAAL,CAA4BI,WAA5B,CAA5C;AACH;;;gDAEuB;AACpB,iBAAKP,YAAL,GAAoB,CAAC,KAAKA,YAA1B;;AAEA,iBAAK,IAAIO,WAAT,IAAwB,KAAKL,oBAA7B,EAAmD;AAC/C,qBAAKA,oBAAL,CAA0BK,WAA1B,IAAyC,KAAKP,YAA9C;AACH;AACJ;;;kDAEyB;AACtB,iBAAKC,cAAL,GAAsB,CAAC,KAAKA,cAA5B;;AAEA,iBAAK,IAAIM,WAAT,IAAwB,KAAKJ,sBAA7B,EAAqD;AACjD,qBAAKA,sBAAL,CAA4BI,WAA5B,IAA2C,KAAKN,cAAhD;AACH;AACJ;;AAED;;;;;;;kCAIUM,W,EAAa;AACnBa,kBAAMb,WAAN;AACH;;AAED;;;;;;;mCAIWA,W,EAAa;AACpBa,kBAAMb,WAAN;AACH;;AAED;;;;;;2CAGmB;AACf,mBAAO,KAAKjB,kBAAL,CAAwB+B,gBAAxB,EAAP;AACH;;;;;;AAILvC,0BAA0BwC,OAA1B,GAAoC,CAChC,YADgC,EAEhC,QAFgC,EAGhC,QAHgC,EAIhC,eAJgC,EAKhC,iBALgC,EAMhC,gBANgC,EAOhC,sBAPgC,EAQhC,oBARgC,EAShC,yBATgC,CAApC;;kBAYexC,yB","file":"notebookGradingController.js","sourcesContent":["'use strict';\r\n\r\nclass NotebookGradingController {\r\n\r\n    constructor($rootScope,\r\n                $scope,\r\n                $state,\r\n                ConfigService,\r\n                NotebookService,\r\n                ProjectService,\r\n                StudentStatusService,\r\n                TeacherDataService,\r\n                TeacherWebSocketService) {\r\n        this.$rootScope = $rootScope;\r\n        this.$scope = $scope;\r\n        this.$state = $state;\r\n        this.ConfigService = ConfigService;\r\n        this.NotebookService = NotebookService;\r\n        this.ProjectService = ProjectService;\r\n        this.StudentStatusService = StudentStatusService;\r\n        this.TeacherDataService = TeacherDataService;\r\n        this.TeacherWebSocketService = TeacherWebSocketService;\r\n\r\n        this.themePath = this.ProjectService.getThemePath();\r\n\r\n        this.teacherWorkgroupId = this.ConfigService.getWorkgroupId();\r\n\r\n        // get the workgroups sorted alphabetically\r\n        this.workgroups = this.ConfigService.getClassmateUserInfos();\r\n\r\n        this.noteFilter = \"note\";\r\n        this.reportFilter = \"report\";\r\n\r\n        this.showAllNotes = false;\r\n        this.showAllReports = false;\r\n        this.showNoteForWorkgroup = {};\r\n        this.showReportForWorkgroup = {};\r\n        for (let i = 0; i < this.workgroups.length; i++) {\r\n            let workgroup = this.workgroups[i];\r\n            this.showNoteForWorkgroup[workgroup.workgroupId] = false;\r\n            this.showReportForWorkgroup[workgroup.workgroupId] = false;\r\n        }\r\n\r\n        this.canViewStudentNames = true;\r\n        this.canGradeStudentWork = true;\r\n\r\n        // get the role of the teacher for the run e.g. 'owner', 'write', 'read'\r\n        let role = this.ConfigService.getTeacherRole(this.teacherWorkgroupId);\r\n\r\n        if (role === 'owner') {\r\n            // the teacher is the owner of the run and has full access\r\n            this.canViewStudentNames = true;\r\n            this.canGradeStudentWork = true;\r\n        } else if (role === 'write') {\r\n            // the teacher is a shared teacher that can grade the student work\r\n            this.canViewStudentNames = true;\r\n            this.canGradeStudentWork = true;\r\n        } else if (role === 'read') {\r\n            // the teacher is a shared teacher that can only view the student work\r\n            this.canViewStudentNames = false;\r\n            this.canGradeStudentWork = false;\r\n        }\r\n\r\n        // save event when notebook grading view is displayed\r\n        let context = \"ClassroomMonitor\", nodeId = null, componentId = null, componentType = null,\r\n            category = \"Navigation\", event = \"notebookViewDisplayed\", data = {};\r\n        this.TeacherDataService.saveEvent(context, nodeId, componentId, componentType, category, event, data);\r\n    }\r\n\r\n    toggleDisplayNoteForWorkgroup(workgroupId) {\r\n        this.showNoteForWorkgroup[workgroupId] = !this.showNoteForWorkgroup[workgroupId];\r\n    }\r\n\r\n    toggleDisplayReportForWorkgroup(workgroupId) {\r\n        this.showReportForWorkgroup[workgroupId] = !this.showReportForWorkgroup[workgroupId];\r\n    }\r\n\r\n    toggleDisplayAllNotes() {\r\n        this.showAllNotes = !this.showAllNotes;\r\n\r\n        for (let workgroupId in this.showNoteForWorkgroup) {\r\n            this.showNoteForWorkgroup[workgroupId] = this.showAllNotes;\r\n        }\r\n    }\r\n\r\n    toggleDisplayAllReports() {\r\n        this.showAllReports = !this.showAllReports;\r\n\r\n        for (let workgroupId in this.showReportForWorkgroup) {\r\n            this.showReportForWorkgroup[workgroupId] = this.showAllReports;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Handle request to view notes for the specified workgroup\r\n     * @param workgroupId\r\n     */\r\n    viewNotes(workgroupId) {\r\n        alert(workgroupId);\r\n    }\r\n\r\n    /**\r\n     * Handle request to view report for the specified workgroup\r\n     * @param workgroupId\r\n     */\r\n    viewReport(workgroupId) {\r\n        alert(workgroupId);\r\n    }\r\n\r\n    /**\r\n     * Get the current period\r\n     */\r\n    getCurrentPeriod() {\r\n        return this.TeacherDataService.getCurrentPeriod();\r\n    };\r\n\r\n}\r\n\r\nNotebookGradingController.$inject = [\r\n    '$rootScope',\r\n    '$scope',\r\n    '$state',\r\n    'ConfigService',\r\n    'NotebookService',\r\n    'ProjectService',\r\n    'StudentStatusService',\r\n    'TeacherDataService',\r\n    'TeacherWebSocketService'\r\n];\r\n\r\nexport default NotebookGradingController;\r\n"]}