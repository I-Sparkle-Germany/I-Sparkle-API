{"version":3,"sources":["animationAuthoringController.es6"],"names":["AnimationAuthoringController","$filter","$mdDialog","$q","$rootScope","$scope","$timeout","AnimationService","AnnotationService","ConfigService","CRaterService","NodeService","NotebookService","NotificationService","ProjectService","StudentAssetService","StudentDataService","UtilService","allowedConnectedComponentTypes","type","$watch","authoringComponentContent","bind","newValue","oldValue","componentContent","injectAssetPaths","refreshContentInAuthoringPreview","$on","event","args","isEventTargetThisComponent","fileName","assetItem","target","summernoteId","createSummernoteRubricId","restoreSummernoteCursorPosition","assetsDirectoryPath","getProjectAssetsDirectoryPath","fullAssetPath","isImage","insertImageIntoSummernote","isVideo","insertVideoIntoSummernote","targetObject","image","imageMovingLeft","imageMovingRight","authoringViewComponentChanged","hide","submitCounter","latestAnnotations","isDirty","isSubmitDirty","isSaveButtonVisible","showSaveButton","isSubmitButtonVisible","showSubmitButton","removeAllObjects","initializeCoordinates","setup","objects","newObject","id","generateKey","push","animationObject","animationObjectHasDataSource","askIfWantToDeleteDataSource","dataSource","addNewDataPoint","confirm","$translate","data","initializeAnimationObjectDataIfNecessary","newDataPoint","index","splice","object","canMoveUp","dataPoint","canMoveDown","length","animationObjectHasData","deleteDataAndAddDataSource","deleteDataFromAnimationObject","addDataSourceToAnimationObject","nodeId","componentId","component","getComponentByNodeIdAndComponentId","setDefaultParamsForGraphDataSource","trialIndex","seriesIndex","tColumnIndex","xColumnIndex","targetString","params","createOpenAssetChooserParamsObject","$broadcast","isPopup","removeTextFromAnimationObject","removeImageFromAnimationObject","text","width","height","imageMovingUp","imageMovingDown","$inject"],"mappings":"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","file":"animationAuthoringController.js","sourcesContent":["'use strict';\n\nimport AnimationController from './animationController';\n\nclass AnimationAuthoringController extends AnimationController {\n  constructor($filter,\n              $mdDialog,\n              $q,\n              $rootScope,\n              $scope,\n              $timeout,\n              AnimationService,\n              AnnotationService,\n              ConfigService,\n              CRaterService,\n              NodeService,\n              NotebookService,\n              NotificationService,\n              ProjectService,\n              StudentAssetService,\n              StudentDataService,\n              UtilService) {\n    super($filter,\n      $mdDialog,\n      $q,\n      $rootScope,\n      $scope,\n      $timeout,\n      AnimationService,\n      AnnotationService,\n      ConfigService,\n      CRaterService,\n      NodeService,\n      NotebookService,\n      NotificationService,\n      ProjectService,\n      StudentAssetService,\n      StudentDataService,\n      UtilService);\n\n    this.allowedConnectedComponentTypes = [\n      { type: 'Animation' },\n      { type: 'Graph' }\n    ];\n\n    $scope.$watch(function() {\n      return this.authoringComponentContent;\n    }.bind(this), function(newValue, oldValue) {\n      this.componentContent = this.ProjectService.injectAssetPaths(newValue);\n      this.refreshContentInAuthoringPreview();\n    }.bind(this), true);\n\n    this.$scope.$on('assetSelected', (event, args) => {\n      if (this.isEventTargetThisComponent(args)) {\n        const fileName = args.assetItem.fileName;\n\n        if (args.target == 'rubric') {\n          const summernoteId = this.createSummernoteRubricId();\n          this.restoreSummernoteCursorPosition(summernoteId);\n          const assetsDirectoryPath = this.ConfigService.getProjectAssetsDirectoryPath();\n          const fullAssetPath = assetsDirectoryPath + '/' + fileName;\n          if (this.UtilService.isImage(fileName)) {\n            this.insertImageIntoSummernote(fullAssetPath, fileName);\n          } else if (this.UtilService.isVideo(fileName)) {\n            this.insertVideoIntoSummernote(fullAssetPath);\n          }\n        } else if (args.target == 'image') {\n          args.targetObject.image = fileName;\n        } else if (args.target == 'imageMovingLeft') {\n          args.targetObject.imageMovingLeft = fileName;\n        } else if (args.target == 'imageMovingRight') {\n          args.targetObject.imageMovingRight = fileName;\n        }\n      }\n\n      this.authoringViewComponentChanged();\n      this.$mdDialog.hide();\n    });\n  }\n\n  refreshContentInAuthoringPreview() {\n    this.submitCounter = 0;\n    this.latestAnnotations = null;\n    this.isDirty = false;\n    this.isSubmitDirty = false;\n    this.isSaveButtonVisible = this.componentContent.showSaveButton;\n    this.isSubmitButtonVisible = this.componentContent.showSubmitButton;\n    this.removeAllObjects();\n    this.initializeCoordinates();\n    this.setup();\n  }\n\n  authoringAddObject() {\n    if (this.authoringComponentContent.objects == null) {\n      this.authoringComponentContent.objects = [];\n    }\n\n    const newObject = {\n      id: this.UtilService.generateKey(10),\n      type: 'image'\n    };\n\n    this.authoringComponentContent.objects.push(newObject);\n    this.authoringViewComponentChanged();\n  }\n\n  authoringAddDataPointToObject(animationObject) {\n    if (this.animationObjectHasDataSource(animationObject)) {\n      if (this.askIfWantToDeleteDataSource()) {\n        delete animationObject.dataSource;\n        this.addNewDataPoint(animationObject);\n      }\n    } else {\n      this.addNewDataPoint(animationObject);\n    }\n\n    this.authoringViewComponentChanged();\n  }\n\n  animationObjectHasDataSource(animationObject) {\n    return animationObject.dataSource != null;\n  }\n\n  askIfWantToDeleteDataSource() {\n    return confirm(this.$translate('animation.areYouSureYouWantToAddADataPoint'));\n  }\n\n  initializeAnimationObjectDataIfNecessary(animationObject) {\n    if (animationObject.data == null) {\n      animationObject.data = [];\n    }\n  }\n\n  addNewDataPoint(animationObject) {\n    this.initializeAnimationObjectDataIfNecessary(animationObject);\n    const newDataPoint = {};\n    animationObject.data.push(newDataPoint);\n  }\n\n  authoringDeleteAnimationObjectDataPointClicked(animationObject, index) {\n    if (confirm(this.$translate('animation.areYouSureYouWantToDeleteThisDataPoint'))) {\n      animationObject.data.splice(index, 1);\n      this.authoringViewComponentChanged();\n    }\n  }\n\n  authoringMoveAnimationObjectDataPointUp(object, index) {\n    if (this.canMoveUp(index)) {\n      const dataPoint = object.data[index];\n      object.data.splice(index, 1);\n      object.data.splice(index - 1, 0, dataPoint);\n      this.authoringViewComponentChanged();\n    }\n  }\n\n  authoringMoveAnimationObjectDataPointDown(object, index) {\n    if (this.canMoveDown(index, object.data.length)) {\n      const dataPoint = object.data[index];\n      object.data.splice(index, 1);\n      object.data.splice(index + 1, 0, dataPoint);\n      this.authoringViewComponentChanged();\n    }\n  }\n\n  authoringMoveAnimationObjectUp(index) {\n    if (this.canMoveUp(index)) {\n      const object = this.authoringComponentContent.objects[index];\n      objects.splice(index, 1);\n      objects.splice(index - 1, 0, object);\n      this.authoringViewComponentChanged();\n    }\n  }\n\n  authoringMoveAnimationObjectDown(index) {\n    const objects = this.authoringComponentContent.objects;\n    if (this.canMoveDown(index, objects.length)) {\n      const object = objects[index];\n      objects.splice(index, 1);\n      objects.splice(index + 1, 0, object);\n      this.authoringViewComponentChanged();\n    }\n  }\n\n  canMoveUp(index) {\n    return index > 0;\n  }\n\n  canMoveDown(index, length) {\n    return index < length - 1;\n  }\n\n  authoringDeleteAnimationObjectClicked(index) {\n    if (confirm(this.$translate('animation.areYouSureYouWantToDeleteThisObject'))) {\n      this.authoringComponentContent.objects.splice(index, 1);\n      this.authoringViewComponentChanged();\n    }\n  }\n\n  authoringAddDataSource(animationObject) {\n    if (this.animationObjectHasData(animationObject)) {\n      if (confirm(this.$translate('animation.areYouSureYouWantToAddADataSource'))) {\n        this.deleteDataAndAddDataSource(animationObject);\n      }\n    } else {\n      this.deleteDataAndAddDataSource(animationObject);\n    }\n    this.authoringViewComponentChanged();\n  }\n\n  deleteDataAndAddDataSource(animationObject) {\n    this.deleteDataFromAnimationObject(animationObject);\n    this.addDataSourceToAnimationObject(animationObject);\n  }\n\n  deleteDataFromAnimationObject(animationObject) {\n    delete animationObject.data;\n  }\n\n  addDataSourceToAnimationObject(animationObject) {\n    animationObject.dataSource = {};\n  }\n\n  animationObjectHasData(animationObject) {\n    return animationObject.data != null && animationObject.data.length > 0;\n  }\n\n  authoringDeleteDataSourceClicked(animationObject) {\n    if (confirm(this.$translate('animation.areYouSureYouWantToDeleteTheDataSource'))) {\n      delete animationObject.dataSource;\n      this.authoringViewComponentChanged();\n    }\n  }\n\n  dataSourceNodeChanged(animationObject) {\n    const nodeId = animationObject.dataSource.nodeId;\n    animationObject.dataSource = {\n      nodeId: nodeId\n    }\n    this.authoringViewComponentChanged();\n  }\n\n  dataSourceComponentChanged(animationObject) {\n    const nodeId = animationObject.dataSource.nodeId;\n    const componentId = animationObject.dataSource.componentId;\n    const component = this.getComponentByNodeIdAndComponentId(nodeId, componentId);\n    animationObject.dataSource = {\n      nodeId: nodeId,\n      componentId: componentId\n    };\n\n    if (component.type == 'Graph') {\n      this.setDefaultParamsForGraphDataSource(animationObject);\n    }\n\n    this.authoringViewComponentChanged();\n  }\n\n  setDefaultParamsForGraphDataSource(animationObject) {\n    animationObject.dataSource.trialIndex = 0;\n    animationObject.dataSource.seriesIndex = 0;\n    animationObject.dataSource.tColumnIndex = 0;\n    animationObject.dataSource.xColumnIndex = 1;\n  }\n\n  chooseImage(animationObject) {\n    const targetString = 'image';\n    const params = this.createOpenAssetChooserParamsObject(targetString, animationObject);\n    this.$rootScope.$broadcast('openAssetChooser', params);\n  }\n\n  chooseImageMovingLeft(animationObject) {\n    const targetString = 'imageMovingLeft';\n    const params = this.createOpenAssetChooserParamsObject(targetString, animationObject);\n    this.$rootScope.$broadcast('openAssetChooser', params);\n  }\n\n  chooseImageMovingRight(animationObject) {\n    const targetString = 'imageMovingRight';\n    const params = this.createOpenAssetChooserParamsObject(targetString, animationObject);\n    this.$rootScope.$broadcast('openAssetChooser', params);\n  }\n\n  /**\n   * @param {string} targetString Can be 'image', 'imageMovingLeft', or 'imageMovingRight'.\n   * @param {object} animationObject\n   * @returns {object}\n   */\n  createOpenAssetChooserParamsObject(targetString, animationObject) {\n    return {\n      isPopup: true,\n      nodeId: this.nodeId,\n      componentId: this.componentId,\n      target: targetString,\n      targetObject: animationObject\n    };\n  }\n\n  authoringAnimationObjectTypeChanged(animationObject) {\n    if (animationObject.type == 'image') {\n      this.removeTextFromAnimationObject(animationObject);\n    } else if (animationObject.type == 'text') {\n      this.removeImageFromAnimationObject(animationObject);\n    }\n\n    this.authoringViewComponentChanged();\n  }\n\n  removeTextFromAnimationObject(animationObject) {\n    delete animationObject.text;\n  }\n\n  removeImageFromAnimationObject(animationObject) {\n    delete animationObject.image;\n    delete animationObject.width;\n    delete animationObject.height;\n    delete animationObject.imageMovingLeft;\n    delete animationObject.imageMovingRight;\n    delete animationObject.imageMovingUp;\n    delete animationObject.imageMovingDown;\n  }\n}\n\nAnimationAuthoringController.$inject = [\n  '$filter',\n  '$mdDialog',\n  '$q',\n  '$rootScope',\n  '$scope',\n  '$timeout',\n  'AnimationService',\n  'AnnotationService',\n  'ConfigService',\n  'CRaterService',\n  'NodeService',\n  'NotebookService',\n  'NotificationService',\n  'ProjectService',\n  'StudentAssetService',\n  'StudentDataService',\n  'UtilService'\n];\n\nexport default AnimationAuthoringController;\n"]}