{"version":3,"sources":["animationAuthoringController.es6"],"names":["AnimationAuthoringController","$filter","$mdDialog","$q","$rootScope","$scope","$timeout","AnimationService","AnnotationService","ConfigService","NodeService","NotebookService","NotificationService","ProjectService","StudentAssetService","StudentDataService","UtilService","allowedConnectedComponentTypes","type","$watch","authoringComponentContent","bind","newValue","oldValue","componentContent","injectAssetPaths","refreshContentInAuthoringPreview","$on","event","args","isEventTargetThisComponent","fileName","assetItem","target","summernoteId","createSummernoteRubricId","restoreSummernoteCursorPosition","assetsDirectoryPath","getProjectAssetsDirectoryPath","fullAssetPath","isImage","insertImageIntoSummernote","isVideo","insertVideoIntoSummernote","targetObject","image","imageMovingLeft","imageMovingRight","authoringViewComponentChanged","hide","submitCounter","latestAnnotations","isDirty","isSubmitDirty","isSaveButtonVisible","showSaveButton","isSubmitButtonVisible","showSubmitButton","removeAllObjectsFromSVG","initializeCoordinates","setup","ids","Object","keys","idToSVGObject","id","svgObject","remove","objects","newObject","generateKey","push","authoredObject","authoredObjectHasDataSource","askIfWantToDeleteDataSource","dataSource","addNewDataPoint","confirm","$translate","data","initializeAuthoredObjectDataIfNecessary","newDataPoint","index","splice","object","canMoveUp","dataPoint","canMoveDown","length","authoredObjectHasData","deleteDataAndAddDataSource","deleteDataFromAuthoredObject","addDataSourceToAuthoredObject","nodeId","componentId","component","getComponentByNodeIdAndComponentId","setDefaultParamsForGraphDataSource","trialIndex","seriesIndex","tColumnIndex","xColumnIndex","targetString","params","createOpenAssetChooserParamsObject","$broadcast","isPopup","removeTextFromAuthoredObject","removeImageFromAuthoredObject","text","width","height","imageMovingUp","imageMovingDown","$inject"],"mappings":"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","file":"animationAuthoringController.js","sourcesContent":["'use strict';\n\nimport AnimationController from './animationController';\n\nclass AnimationAuthoringController extends AnimationController {\n  constructor($filter,\n              $mdDialog,\n              $q,\n              $rootScope,\n              $scope,\n              $timeout,\n              AnimationService,\n              AnnotationService,\n              ConfigService,\n              NodeService,\n              NotebookService,\n              NotificationService,\n              ProjectService,\n              StudentAssetService,\n              StudentDataService,\n              UtilService) {\n    super($filter,\n      $mdDialog,\n      $q,\n      $rootScope,\n      $scope,\n      $timeout,\n      AnimationService,\n      AnnotationService,\n      ConfigService,\n      NodeService,\n      NotebookService,\n      NotificationService,\n      ProjectService,\n      StudentAssetService,\n      StudentDataService,\n      UtilService);\n\n    this.allowedConnectedComponentTypes = [\n      { type: 'Animation' },\n      { type: 'Graph' }\n    ];\n\n    $scope.$watch(function() {\n      return this.authoringComponentContent;\n    }.bind(this), function(newValue, oldValue) {\n      this.componentContent = this.ProjectService.injectAssetPaths(newValue);\n      this.refreshContentInAuthoringPreview();\n    }.bind(this), true);\n\n    this.$scope.$on('assetSelected', (event, args) => {\n      if (this.isEventTargetThisComponent(args)) {\n        const fileName = args.assetItem.fileName;\n\n        if (args.target == 'rubric') {\n          const summernoteId = this.createSummernoteRubricId();\n          this.restoreSummernoteCursorPosition(summernoteId);\n          const assetsDirectoryPath = this.ConfigService.getProjectAssetsDirectoryPath();\n          const fullAssetPath = assetsDirectoryPath + '/' + fileName;\n          if (this.UtilService.isImage(fileName)) {\n            this.insertImageIntoSummernote(fullAssetPath, fileName);\n          } else if (this.UtilService.isVideo(fileName)) {\n            this.insertVideoIntoSummernote(fullAssetPath);\n          }\n        } else if (args.target == 'image') {\n          args.targetObject.image = fileName;\n        } else if (args.target == 'imageMovingLeft') {\n          args.targetObject.imageMovingLeft = fileName;\n        } else if (args.target == 'imageMovingRight') {\n          args.targetObject.imageMovingRight = fileName;\n        }\n      }\n\n      this.authoringViewComponentChanged();\n      this.$mdDialog.hide();\n    });\n  }\n\n  refreshContentInAuthoringPreview() {\n    this.submitCounter = 0;\n    this.latestAnnotations = null;\n    this.isDirty = false;\n    this.isSubmitDirty = false;\n    this.isSaveButtonVisible = this.componentContent.showSaveButton;\n    this.isSubmitButtonVisible = this.componentContent.showSubmitButton;\n    this.removeAllObjectsFromSVG();\n    this.initializeCoordinates();\n    this.setup();\n  }\n\n  removeAllObjectsFromSVG() {\n    const ids = Object.keys(this.idToSVGObject);\n    for (let id of ids) {\n      const svgObject = this.idToSVGObject[id];\n      svgObject.remove();\n    }\n  }\n\n  authoringAddObject() {\n    if (this.authoringComponentContent.objects == null) {\n      this.authoringComponentContent.objects = [];\n    }\n\n    const newObject = {\n      id: this.UtilService.generateKey(10),\n      type: 'image'\n    };\n\n    this.authoringComponentContent.objects.push(newObject);\n    this.authoringViewComponentChanged();\n  }\n\n  authoringAddDataPointToObject(authoredObject) {\n    if (this.authoredObjectHasDataSource(authoredObject)) {\n      if (this.askIfWantToDeleteDataSource()) {\n        delete authoredObject.dataSource;\n        this.addNewDataPoint(authoredObject);\n      }\n    } else {\n      this.addNewDataPoint(authoredObject);\n    }\n\n    this.authoringViewComponentChanged();\n  }\n\n  askIfWantToDeleteDataSource() {\n    return confirm(this.$translate('animation.areYouSureYouWantToAddADataPoint'));\n  }\n\n  initializeAuthoredObjectDataIfNecessary(authoredObject) {\n    if (authoredObject.data == null) {\n      authoredObject.data = [];\n    }\n  }\n\n  addNewDataPoint(authoredObject) {\n    this.initializeAuthoredObjectDataIfNecessary(authoredObject);\n    const newDataPoint = {};\n    authoredObject.data.push(newDataPoint);\n  }\n\n  authoringDeleteAuthoredObjectDataPointClicked(authoredObject, index) {\n    if (confirm(this.$translate('animation.areYouSureYouWantToDeleteThisDataPoint'))) {\n      authoredObject.data.splice(index, 1);\n      this.authoringViewComponentChanged();\n    }\n  }\n\n  authoringMoveAuthoredObjectDataPointUp(object, index) {\n    if (this.canMoveUp(index)) {\n      const dataPoint = object.data[index];\n      object.data.splice(index, 1);\n      object.data.splice(index - 1, 0, dataPoint);\n      this.authoringViewComponentChanged();\n    }\n  }\n\n  authoringMoveAuthoredObjectDataPointDown(object, index) {\n    if (this.canMoveDown(index, object.data.length)) {\n      const dataPoint = object.data[index];\n      object.data.splice(index, 1);\n      object.data.splice(index + 1, 0, dataPoint);\n      this.authoringViewComponentChanged();\n    }\n  }\n\n  authoringMoveAuthoredObjectUp(index) {\n    if (this.canMoveUp(index)) {\n      const object = this.authoringComponentContent.objects[index];\n      objects.splice(index, 1);\n      objects.splice(index - 1, 0, object);\n      this.authoringViewComponentChanged();\n    }\n  }\n\n  authoringMoveAuthoredObjectDown(index) {\n    const objects = this.authoringComponentContent.objects;\n    if (this.canMoveDown(index, objects.length)) {\n      const object = objects[index];\n      objects.splice(index, 1);\n      objects.splice(index + 1, 0, object);\n      this.authoringViewComponentChanged();\n    }\n  }\n\n  canMoveUp(index) {\n    return index > 0;\n  }\n\n  canMoveDown(index, length) {\n    return index < length - 1;\n  }\n\n  authoringDeleteAuthoredObjectClicked(index) {\n    if (confirm(this.$translate('animation.areYouSureYouWantToDeleteThisObject'))) {\n      this.authoringComponentContent.objects.splice(index, 1);\n      this.authoringViewComponentChanged();\n    }\n  }\n\n  authoringAddDataSource(authoredObject) {\n    if (this.authoredObjectHasData(authoredObject)) {\n      if (confirm(this.$translate('animation.areYouSureYouWantToAddADataSource'))) {\n        this.deleteDataAndAddDataSource(authoredObject);\n      }\n    } else {\n      this.deleteDataAndAddDataSource(authoredObject);\n    }\n    this.authoringViewComponentChanged();\n  }\n\n  deleteDataAndAddDataSource(authoredObject) {\n    this.deleteDataFromAuthoredObject(authoredObject);\n    this.addDataSourceToAuthoredObject(authoredObject);\n  }\n\n  deleteDataFromAuthoredObject(authoredObject) {\n    delete authoredObject.data;\n  }\n\n  addDataSourceToAuthoredObject(authoredObject) {\n    authoredObject.dataSource = {};\n  }\n\n  authoringDeleteDataSourceClicked(authoredObject) {\n    if (confirm(this.$translate('animation.areYouSureYouWantToDeleteTheDataSource'))) {\n      delete authoredObject.dataSource;\n      this.authoringViewComponentChanged();\n    }\n  }\n\n  dataSourceNodeChanged(authoredObject) {\n    const nodeId = authoredObject.dataSource.nodeId;\n    authoredObject.dataSource = {\n      nodeId: nodeId\n    }\n    this.authoringViewComponentChanged();\n  }\n\n  dataSourceComponentChanged(authoredObject) {\n    const nodeId = authoredObject.dataSource.nodeId;\n    const componentId = authoredObject.dataSource.componentId;\n    const component = this.getComponentByNodeIdAndComponentId(nodeId, componentId);\n    authoredObject.dataSource = {\n      nodeId: nodeId,\n      componentId: componentId\n    };\n\n    if (component.type == 'Graph') {\n      this.setDefaultParamsForGraphDataSource(authoredObject);\n    }\n\n    this.authoringViewComponentChanged();\n  }\n\n  setDefaultParamsForGraphDataSource(authoredObject) {\n    authoredObject.dataSource.trialIndex = 0;\n    authoredObject.dataSource.seriesIndex = 0;\n    authoredObject.dataSource.tColumnIndex = 0;\n    authoredObject.dataSource.xColumnIndex = 1;\n  }\n\n  chooseImage(authoredObject) {\n    const targetString = 'image';\n    const params = this.createOpenAssetChooserParamsObject(targetString, authoredObject);\n    this.$rootScope.$broadcast('openAssetChooser', params);\n  }\n\n  chooseImageMovingLeft(authoredObject) {\n    const targetString = 'imageMovingLeft';\n    const params = this.createOpenAssetChooserParamsObject(targetString, authoredObject);\n    this.$rootScope.$broadcast('openAssetChooser', params);\n  }\n\n  chooseImageMovingRight(authoredObject) {\n    const targetString = 'imageMovingRight';\n    const params = this.createOpenAssetChooserParamsObject(targetString, authoredObject);\n    this.$rootScope.$broadcast('openAssetChooser', params);\n  }\n\n  /**\n   * @param {string} targetString Can be 'image', 'imageMovingLeft', or 'imageMovingRight'.\n   * @param {object} authoredObject\n   * @returns {object}\n   */\n  createOpenAssetChooserParamsObject(targetString, authoredObject) {\n    return {\n      isPopup: true,\n      nodeId: this.nodeId,\n      componentId: this.componentId,\n      target: targetString,\n      targetObject: authoredObject\n    };\n  }\n\n  authoringAuthoredObjectTypeChanged(authoredObject) {\n    if (authoredObject.type == 'image') {\n      this.removeTextFromAuthoredObject(authoredObject);\n    } else if (authoredObject.type == 'text') {\n      this.removeImageFromAuthoredObject(authoredObject);\n    }\n\n    this.authoringViewComponentChanged();\n  }\n\n  removeTextFromAuthoredObject(authoredObject) {\n    delete authoredObject.text;\n  }\n\n  removeImageFromAuthoredObject(authoredObject) {\n    delete authoredObject.image;\n    delete authoredObject.width;\n    delete authoredObject.height;\n    delete authoredObject.imageMovingLeft;\n    delete authoredObject.imageMovingRight;\n    delete authoredObject.imageMovingUp;\n    delete authoredObject.imageMovingDown;\n  }\n}\n\nAnimationAuthoringController.$inject = [\n  '$filter',\n  '$mdDialog',\n  '$q',\n  '$rootScope',\n  '$scope',\n  '$timeout',\n  'AnimationService',\n  'AnnotationService',\n  'ConfigService',\n  'NodeService',\n  'NotebookService',\n  'NotificationService',\n  'ProjectService',\n  'StudentAssetService',\n  'StudentDataService',\n  'UtilService'\n];\n\nexport default AnimationAuthoringController;\n"]}