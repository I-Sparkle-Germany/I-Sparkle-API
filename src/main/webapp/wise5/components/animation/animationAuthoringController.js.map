{"version":3,"sources":["animationAuthoringController.es6"],"names":["AnimationAuthoringController","$filter","$mdDialog","$q","$rootScope","$scope","$timeout","AnimationService","AnnotationService","ConfigService","NodeService","NotebookService","NotificationService","ProjectService","StudentAssetService","StudentDataService","UtilService","allowedConnectedComponentTypes","type","$watch","authoringComponentContent","bind","newValue","oldValue","componentContent","injectAssetPaths","refreshContentInAuthoringPreview","$on","event","args","isEventTargetThisComponent","fileName","assetItem","target","summernoteId","createSummernoteRubricId","restoreSummernoteCursorPosition","assetsDirectoryPath","getProjectAssetsDirectoryPath","fullAssetPath","isImage","insertImageIntoSummernote","isVideo","insertVideoIntoSummernote","targetObject","image","imageMovingLeft","imageMovingRight","authoringViewComponentChanged","hide","submitCounter","latestAnnotations","isDirty","isSubmitDirty","isSaveButtonVisible","showSaveButton","isSubmitButtonVisible","showSubmitButton","removeAllObjectsFromSVG","initializeCoordinates","setup","ids","Object","keys","idToSVGObject","id","svgObject","remove","objects","newObject","generateKey","push","authoredObject","authoredObjectHasDataSource","askIfWantToDeleteDataSource","dataSource","addNewDataPoint","confirm","$translate","data","initializeAuthoredObjectDataIfNecessary","newDataPoint","animationObject","index","authoringDeleteAnimationObjectDataPoint","splice","object","canMoveUp","dataPoint","canMoveDown","length","authoringDeleteAnimationObject","authoredObjectHasData","deleteDataAndAddDataSource","deleteDataFromAuthoredObject","addDataSourceToAuthoredObject","authoringDeleteDataSource","nodeId","componentId","component","getComponentByNodeIdAndComponentId","setDefaultParamsForGraphDataSource","trialIndex","seriesIndex","tColumnIndex","xColumnIndex","targetString","params","createOpenAssetChooserParamsObject","$broadcast","isPopup","removeTextFromAuthoredObject","removeImageFromAuthoredObject","text","width","height","imageMovingUp","imageMovingDown","$inject"],"mappings":"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","file":"animationAuthoringController.js","sourcesContent":["'use strict';\n\nimport AnimationController from './animationController';\n\nclass AnimationAuthoringController extends AnimationController {\n  constructor($filter,\n              $mdDialog,\n              $q,\n              $rootScope,\n              $scope,\n              $timeout,\n              AnimationService,\n              AnnotationService,\n              ConfigService,\n              NodeService,\n              NotebookService,\n              NotificationService,\n              ProjectService,\n              StudentAssetService,\n              StudentDataService,\n              UtilService) {\n    super($filter,\n      $mdDialog,\n      $q,\n      $rootScope,\n      $scope,\n      $timeout,\n      AnimationService,\n      AnnotationService,\n      ConfigService,\n      NodeService,\n      NotebookService,\n      NotificationService,\n      ProjectService,\n      StudentAssetService,\n      StudentDataService,\n      UtilService);\n\n    this.allowedConnectedComponentTypes = [\n      { type: 'Animation' },\n      { type: 'Graph' }\n    ];\n\n    $scope.$watch(function() {\n      return this.authoringComponentContent;\n    }.bind(this), function(newValue, oldValue) {\n      this.componentContent = this.ProjectService.injectAssetPaths(newValue);\n      this.refreshContentInAuthoringPreview();\n    }.bind(this), true);\n\n    this.$scope.$on('assetSelected', (event, args) => {\n      if (this.isEventTargetThisComponent(args)) {\n        const fileName = args.assetItem.fileName;\n        if (args.target == 'rubric') {\n          const summernoteId = this.createSummernoteRubricId();\n          this.restoreSummernoteCursorPosition(summernoteId);\n          const assetsDirectoryPath = this.ConfigService.getProjectAssetsDirectoryPath();\n          const fullAssetPath = assetsDirectoryPath + '/' + fileName;\n          if (this.UtilService.isImage(fileName)) {\n            this.insertImageIntoSummernote(fullAssetPath, fileName);\n          } else if (this.UtilService.isVideo(fileName)) {\n            this.insertVideoIntoSummernote(fullAssetPath);\n          }\n        } else if (args.target == 'image') {\n          args.targetObject.image = fileName;\n        } else if (args.target == 'imageMovingLeft') {\n          args.targetObject.imageMovingLeft = fileName;\n        } else if (args.target == 'imageMovingRight') {\n          args.targetObject.imageMovingRight = fileName;\n        }\n      }\n      this.authoringViewComponentChanged();\n      this.$mdDialog.hide();\n    });\n  }\n\n  refreshContentInAuthoringPreview() {\n    this.submitCounter = 0;\n    this.latestAnnotations = null;\n    this.isDirty = false;\n    this.isSubmitDirty = false;\n    this.isSaveButtonVisible = this.componentContent.showSaveButton;\n    this.isSubmitButtonVisible = this.componentContent.showSubmitButton;\n    this.removeAllObjectsFromSVG();\n    this.initializeCoordinates();\n    this.setup();\n  }\n\n  removeAllObjectsFromSVG() {\n    const ids = Object.keys(this.idToSVGObject);\n    for (let id of ids) {\n      const svgObject = this.idToSVGObject[id];\n      svgObject.remove();\n    }\n  }\n\n  authoringAddObject() {\n    if (this.authoringComponentContent.objects == null) {\n      this.authoringComponentContent.objects = [];\n    }\n    const newObject = {\n      id: this.UtilService.generateKey(10),\n      type: 'image'\n    };\n    this.authoringComponentContent.objects.push(newObject);\n    this.authoringViewComponentChanged();\n  }\n\n  authoringAddDataPointToObject(authoredObject) {\n    if (this.authoredObjectHasDataSource(authoredObject)) {\n      if (this.askIfWantToDeleteDataSource()) {\n        delete authoredObject.dataSource;\n        this.addNewDataPoint(authoredObject);\n      }\n    } else {\n      this.addNewDataPoint(authoredObject);\n    }\n    this.authoringViewComponentChanged();\n  }\n\n  askIfWantToDeleteDataSource() {\n    return confirm(this.$translate('animation.areYouSureYouWantToAddADataPoint'));\n  }\n\n  initializeAuthoredObjectDataIfNecessary(authoredObject) {\n    if (authoredObject.data == null) {\n      authoredObject.data = [];\n    }\n  }\n\n  addNewDataPoint(authoredObject) {\n    this.initializeAuthoredObjectDataIfNecessary(authoredObject);\n    const newDataPoint = {};\n    authoredObject.data.push(newDataPoint);\n  }\n\n  authoringConfirmDeleteAnimationObjectDataPoint(animationObject, index) {\n    if (confirm(this.$translate('animation.areYouSureYouWantToDeleteThisDataPoint'))) {\n      this.authoringDeleteAnimationObjectDataPoint(animationObject, index);\n    }\n  }\n\n  authoringDeleteAnimationObjectDataPoint(animationObject, index) {\n    animationObject.data.splice(index, 1);\n    this.authoringViewComponentChanged();\n  }\n\n  authoringMoveAnimationObjectDataPointUp(object, index) {\n    if (this.canMoveUp(index)) {\n      const dataPoint = object.data[index];\n      object.data.splice(index, 1);\n      object.data.splice(index - 1, 0, dataPoint);\n      this.authoringViewComponentChanged();\n    }\n  }\n\n  authoringMoveAuthoredObjectDataPointDown(object, index) {\n    if (this.canMoveDown(index, object.data.length)) {\n      const dataPoint = object.data[index];\n      object.data.splice(index, 1);\n      object.data.splice(index + 1, 0, dataPoint);\n      this.authoringViewComponentChanged();\n    }\n  }\n\n  authoringMoveAuthoredObjectUp(index) {\n    if (this.canMoveUp(index)) {\n      const object = this.authoringComponentContent.objects[index];\n      objects.splice(index, 1);\n      objects.splice(index - 1, 0, object);\n      this.authoringViewComponentChanged();\n    }\n  }\n\n  authoringMoveAuthoredObjectDown(index) {\n    const objects = this.authoringComponentContent.objects;\n    if (this.canMoveDown(index, objects.length)) {\n      const object = objects[index];\n      objects.splice(index, 1);\n      objects.splice(index + 1, 0, object);\n      this.authoringViewComponentChanged();\n    }\n  }\n\n  canMoveUp(index) {\n    return index > 0;\n  }\n\n  canMoveDown(index, length) {\n    return index < length - 1;\n  }\n\n  authoringConfirmDeleteAnimationObject(index) {\n    if (confirm(this.$translate('animation.areYouSureYouWantToDeleteThisObject'))) {\n      this.authoringDeleteAnimationObject(index);\n    }\n  }\n\n  authoringDeleteAnimationObject(index) {\n    this.authoringComponentContent.objects.splice(index, 1);\n    this.authoringViewComponentChanged();\n  }\n\n  authoringAddDataSource(authoredObject) {\n    if (this.authoredObjectHasData(authoredObject)) {\n      if (confirm(this.$translate('animation.areYouSureYouWantToAddADataSource'))) {\n        this.deleteDataAndAddDataSource(authoredObject);\n      }\n    } else {\n      this.deleteDataAndAddDataSource(authoredObject);\n    }\n    this.authoringViewComponentChanged();\n  }\n\n  deleteDataAndAddDataSource(authoredObject) {\n    this.deleteDataFromAuthoredObject(authoredObject);\n    this.addDataSourceToAuthoredObject(authoredObject);\n  }\n\n  deleteDataFromAuthoredObject(authoredObject) {\n    delete authoredObject.data;\n  }\n\n  addDataSourceToAuthoredObject(authoredObject) {\n    authoredObject.dataSource = {};\n  }\n\n  authoringConfirmDeleteDataSource(animationObject) {\n    if (confirm(this.$translate('animation.areYouSureYouWantToDeleteTheDataSource'))) {\n      this.authoringDeleteDataSource(animationObject);\n    }\n  }\n\n  authoringDeleteDataSource(animationObject) {\n    delete animationObject.dataSource;\n    this.authoringViewComponentChanged();\n  }\n\n  dataSourceNodeChanged(authoredObject) {\n    const nodeId = authoredObject.dataSource.nodeId;\n    // clear the dataSource object except for the node id\n    authoredObject.dataSource = {\n      nodeId: nodeId\n    }\n    this.authoringViewComponentChanged();\n  }\n\n  dataSourceComponentChanged(authoredObject) {\n    const nodeId = authoredObject.dataSource.nodeId;\n    const componentId = authoredObject.dataSource.componentId;\n    const component = this.getComponentByNodeIdAndComponentId(nodeId, componentId);\n    authoredObject.dataSource = {\n      nodeId: nodeId,\n      componentId: componentId\n    };\n\n    if (component.type == 'Graph') {\n      this.setDefaultParamsForGraphDataSource(authoredObject);\n    }\n    this.authoringViewComponentChanged();\n  }\n\n  setDefaultParamsForGraphDataSource(authoredObject) {\n    authoredObject.dataSource.trialIndex = 0;\n    authoredObject.dataSource.seriesIndex = 0;\n    authoredObject.dataSource.tColumnIndex = 0;\n    authoredObject.dataSource.xColumnIndex = 1;\n  }\n\n  chooseImage(authoredObject) {\n    const targetString = 'image';\n    const params = this.createOpenAssetChooserParamsObject(targetString, authoredObject);\n    this.$rootScope.$broadcast('openAssetChooser', params);\n  }\n\n  chooseImageMovingLeft(authoredObject) {\n    const targetString = 'imageMovingLeft';\n    const params = this.createOpenAssetChooserParamsObject(targetString, authoredObject);\n    this.$rootScope.$broadcast('openAssetChooser', params);\n  }\n\n  chooseImageMovingRight(authoredObject) {\n    const targetString = 'imageMovingRight';\n    const params = this.createOpenAssetChooserParamsObject(targetString, authoredObject);\n    this.$rootScope.$broadcast('openAssetChooser', params);\n  }\n\n  /**\n   * @param {string} targetString Can be 'image', 'imageMovingLeft', or 'imageMovingRight'.\n   * @param {object} authoredObject\n   * @returns {object}\n   */\n  createOpenAssetChooserParamsObject(targetString, authoredObject) {\n    return {\n      isPopup: true,\n      nodeId: this.nodeId,\n      componentId: this.componentId,\n      target: targetString,\n      targetObject: authoredObject\n    };\n  }\n\n  authoringAuthoredObjectTypeChanged(authoredObject) {\n    if (authoredObject.type == 'image') {\n      this.removeTextFromAuthoredObject(authoredObject);\n    } else if (authoredObject.type == 'text') {\n      this.removeImageFromAuthoredObject(authoredObject);\n    }\n    this.authoringViewComponentChanged();\n  }\n\n  removeTextFromAuthoredObject(authoredObject) {\n    delete authoredObject.text;\n  }\n\n  removeImageFromAuthoredObject(authoredObject) {\n    delete authoredObject.image;\n    delete authoredObject.width;\n    delete authoredObject.height;\n    delete authoredObject.imageMovingLeft;\n    delete authoredObject.imageMovingRight;\n    delete authoredObject.imageMovingUp;\n    delete authoredObject.imageMovingDown;\n  }\n}\n\nAnimationAuthoringController.$inject = [\n  '$filter',\n  '$mdDialog',\n  '$q',\n  '$rootScope',\n  '$scope',\n  '$timeout',\n  'AnimationService',\n  'AnnotationService',\n  'ConfigService',\n  'NodeService',\n  'NotebookService',\n  'NotificationService',\n  'ProjectService',\n  'StudentAssetService',\n  'StudentDataService',\n  'UtilService'\n];\n\nexport default AnimationAuthoringController;\n"]}