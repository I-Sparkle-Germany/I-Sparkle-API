{"version":3,"sources":["classResponse.es6"],"names":["ClassResponseController","$scope","$element","$filter","StudentStatusService","ConfigService","$translate","$watch","response","replies","length","oldValue","newValue","toggleExpanded","replyText","workgroupId","getAvatarColorForWorkgroupId","$event","keyCode","submitButtonClicked","submitbuttonclicked","r","componentState","answer","confirm","deletebuttonclicked","undodeletebuttonclicked","open","expanded","$clist","$","element","find","setTimeout","animate","scrollTop","height","time","convertToClientTimestamp","$inject","ClassResponseComponentOptions","bindings","mode","studentdatachanged","templateUrl","controller"],"mappings":"AAAA;;;;;;;;;;IAEMA,uB;AACF,qCAAYC,MAAZ,EAAoBC,QAApB,EAA8BC,OAA9B,EAAuCC,oBAAvC,EAA6DC,aAA7D,EAA4E;AAAA;;AAAA;;AACxE,aAAKJ,MAAL,GAAcA,MAAd;AACA,aAAKC,QAAL,GAAgBA,QAAhB;AACA,aAAKC,OAAL,GAAeA,OAAf;AACA,aAAKC,oBAAL,GAA4BA,oBAA5B;AACA,aAAKC,aAAL,GAAqBA,aAArB;;AAEA,aAAKC,UAAL,GAAkB,KAAKH,OAAL,CAAa,WAAb,CAAlB;;AAEA,aAAKF,MAAL,CAAYM,MAAZ,CACI,YAAM;AAAE,mBAAO,MAAKC,QAAL,CAAcC,OAAd,CAAsBC,MAA7B;AAAsC,SADlD,EAEI,UAACC,QAAD,EAAWC,QAAX,EAAwB;AACpB,gBAAIA,aAAaD,QAAjB,EAA2B;AACvB,sBAAKE,cAAL,CAAoB,IAApB;AACA,sBAAKL,QAAL,CAAcM,SAAd,GAA0B,EAA1B;AACH;AACJ,SAPL;AASH;;;;qDAE4BC,W,EAAa;AACtC,mBAAO,KAAKV,aAAL,CAAmBW,4BAAnB,CAAgDD,WAAhD,CAAP;AACH;;;qCAEYE,M,EAAQT,Q,EAAU;AAC3B,gBAAIS,OAAOC,OAAP,KAAmB,EAAvB,EAA2B;AACvB,oBAAIV,SAASM,SAAb,EAAwB;AACpB,yBAAKK,mBAAL,CAAyBX,QAAzB;AACH;AACJ;AACJ;;;4CAEmBA,Q,EAAU;AAC1B;AACA,iBAAKY,mBAAL,CAAyB,EAACC,GAAGb,QAAJ,EAAzB;AACH;;AAED;;;;;;;4CAIoBc,c,EAAgB;;AAEhC,gBAAIC,SAASC,QAAQ,KAAKlB,UAAL,CAAgB,8CAAhB,CAAR,CAAb;;AAEA,gBAAIiB,MAAJ,EAAY;AACR;;AAEA;AACA,qBAAKE,mBAAL,CAAyB,EAACH,gBAAgBA,cAAjB,EAAzB;AACH;AACJ;;AAED;;;;;;;gDAIwBA,c,EAAgB;;AAEpC,gBAAIC,SAASC,QAAQ,KAAKlB,UAAL,CAAgB,4CAAhB,CAAR,CAAb;;AAEA,gBAAIiB,MAAJ,EAAY;AACR;;AAEA;AACA,qBAAKG,uBAAL,CAA6B,EAACJ,gBAAgBA,cAAjB,EAA7B;AACH;AACJ;;;uCAEcK,I,EAAM;AACjB,gBAAIA,IAAJ,EAAU;AACN,qBAAKC,QAAL,GAAgB,IAAhB;AACH,aAFD,MAEO;AACH,qBAAKA,QAAL,GAAgB,CAAC,KAAKA,QAAtB;AACH;;AAED,gBAAI,KAAKA,QAAT,EAAmB;AACf,oBAAIC,SAASC,EAAE,KAAKC,OAAP,EAAgBC,IAAhB,CAAqB,4BAArB,CAAb;AACAC,2BAAW,YAAY;AACnBJ,2BAAOK,OAAP,CAAe,EAACC,WAAWN,OAAOO,MAAP,EAAZ,EAAf,EAA6C,GAA7C;AACH,iBAFD,EAEG,GAFH;AAGH;AACJ;;;6CAEoBC,I,EAAM;AACvB,mBAAO,KAAKhC,aAAL,CAAmBiC,wBAAnB,CAA4CD,IAA5C,CAAP;AACH;;;;;;AAGLrC,wBAAwBuC,OAAxB,GAAkC,CAAC,QAAD,EAAU,UAAV,EAAqB,SAArB,EAA+B,sBAA/B,EAAsD,eAAtD,CAAlC;;AAEA,IAAMC,gCAAgC;AAClCC,cAAU;AACNjC,kBAAU,GADJ;AAENkC,cAAM,GAFA;AAGNjB,6BAAqB,GAHf;AAINC,iCAAyB,GAJnB;AAKNN,6BAAqB,GALf;AAMNuB,4BAAoB;AANd,KADwB;AASlCC,iBAAa,gDATqB;AAUlCC,gBAAY;AAVsB,CAAtC;;QAaS7C,uB,GAAAA,uB;QAAyBwC,6B,GAAAA,6B","file":"classResponse.js","sourcesContent":["'use strict';\n\nclass ClassResponseController {\n    constructor($scope, $element, $filter, StudentStatusService, ConfigService) {\n        this.$scope = $scope;\n        this.$element = $element;\n        this.$filter = $filter;\n        this.StudentStatusService = StudentStatusService;\n        this.ConfigService = ConfigService;\n\n        this.$translate = this.$filter('translate');\n\n        this.$scope.$watch(\n            () => { return this.response.replies.length; },\n            (oldValue, newValue) => {\n                if (newValue !== oldValue) {\n                    this.toggleExpanded(true);\n                    this.response.replyText = '';\n                }\n            }\n        );\n    }\n\n    getAvatarColorForWorkgroupId(workgroupId) {\n        return this.ConfigService.getAvatarColorForWorkgroupId(workgroupId);\n    }\n\n    replyEntered($event, response) {\n        if ($event.keyCode === 13) {\n            if (response.replyText) {\n                this.submitButtonClicked(response);\n            }\n        }\n    }\n\n    submitButtonClicked(response) {\n        // call the callback function in discussionController\n        this.submitbuttonclicked({r: response});\n    }\n\n    /**\n     * The delete button was clicked on a student post\n     * @param componentState the student component state\n     */\n    deleteButtonClicked(componentState) {\n\n        var answer = confirm(this.$translate(\"discussion.areYouSureYouWantToDeleteThisPost\"));\n\n        if (answer) {\n            // the teacher has answered yes to delete\n\n            // tell the discussionController to delete the post\n            this.deletebuttonclicked({componentState: componentState});\n        }\n    }\n\n    /**\n     * The undo delete button was clicked on a student post\n     * @param componentState the student component state\n     */\n    undoDeleteButtonClicked(componentState) {\n\n        var answer = confirm(this.$translate(\"discussion.areYouSureYouWantToShowThisPost\"));\n\n        if (answer) {\n            // the teacher has answered yes to undo the delete\n\n            // tell the discussionController to undo the delete of the post\n            this.undodeletebuttonclicked({componentState: componentState});\n        }\n    }\n\n    toggleExpanded(open) {\n        if (open) {\n            this.expanded = true;\n        } else {\n            this.expanded = !this.expanded;\n        }\n\n        if (this.expanded) {\n            var $clist = $(this.element).find('.discussion-comments__list');\n            setTimeout(function () {\n                $clist.animate({scrollTop: $clist.height()}, 250);\n            }, 250);\n        }\n    }\n\n    adjustClientSaveTime(time) {\n        return this.ConfigService.convertToClientTimestamp(time);\n    }\n}\n\nClassResponseController.$inject = ['$scope','$element','$filter','StudentStatusService','ConfigService'];\n\nconst ClassResponseComponentOptions = {\n    bindings: {\n        response: '=',\n        mode: '=',\n        deletebuttonclicked: '&',\n        undodeletebuttonclicked: '&',\n        submitbuttonclicked: '&',\n        studentdatachanged: '&'\n    },\n    templateUrl: 'wise5/components/discussion/classResponse.html',\n    controller: 'ClassResponseController as classResponseCtrl'\n};\n\nexport { ClassResponseController, ClassResponseComponentOptions };\n"]}