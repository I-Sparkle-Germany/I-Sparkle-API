{"version":3,"sources":["classResponse.es6"],"names":["ClassResponseController","$scope","$element","$filter","StudentStatusService","ConfigService","$translate","$watch","response","replies","length","oldValue","newValue","toggleExpanded","replyText","workgroupId","getAvatarColorForWorkgroupId","$event","keyCode","submitButtonClicked","submitbuttonclicked","r","componentState","answer","confirm","deletebuttonclicked","undodeletebuttonclicked","open","expanded","$clist","$","element","find","setTimeout","animate","scrollTop","height","time","convertToClientTimestamp","$inject","ClassResponseComponentOptions","bindings","mode","studentdatachanged","isdisabled","templateUrl","controller"],"mappings":"AAAA;;;;;;;;;;IAEMA,uB;AACJ,mCAAYC,MAAZ,EAAoBC,QAApB,EAA8BC,OAA9B,EAAuCC,oBAAvC,EAA6DC,aAA7D,EAA4E;AAAA;;AAAA;;AAC1E,SAAKJ,MAAL,GAAcA,MAAd;AACA,SAAKC,QAAL,GAAgBA,QAAhB;AACA,SAAKC,OAAL,GAAeA,OAAf;AACA,SAAKC,oBAAL,GAA4BA,oBAA5B;AACA,SAAKC,aAAL,GAAqBA,aAArB;;AAEA,SAAKC,UAAL,GAAkB,KAAKH,OAAL,CAAa,WAAb,CAAlB;;AAEA,SAAKF,MAAL,CAAYM,MAAZ,CACE,YAAM;AAAE,aAAO,MAAKC,QAAL,CAAcC,OAAd,CAAsBC,MAA7B;AAAsC,KADhD,EAEE,UAACC,QAAD,EAAWC,QAAX,EAAwB;AACtB,UAAIA,aAAaD,QAAjB,EAA2B;AACzB,cAAKE,cAAL,CAAoB,IAApB;AACA,cAAKL,QAAL,CAAcM,SAAd,GAA0B,EAA1B;AACD;AACF,KAPH;AASD;;;;iDAE4BC,W,EAAa;AACxC,aAAO,KAAKV,aAAL,CAAmBW,4BAAnB,CAAgDD,WAAhD,CAAP;AACD;;;iCAEYE,M,EAAQT,Q,EAAU;AAC7B,UAAIS,OAAOC,OAAP,KAAmB,EAAvB,EAA2B;AACzB,YAAIV,SAASM,SAAb,EAAwB;AACtB,eAAKK,mBAAL,CAAyBX,QAAzB;AACD;AACF;AACF;;;wCAEmBA,Q,EAAU;AAC5B;AACA,WAAKY,mBAAL,CAAyB,EAACC,GAAGb,QAAJ,EAAzB;AACD;;AAED;;;;;;;wCAIoBc,c,EAAgB;;AAElC,UAAIC,SAASC,QAAQ,KAAKlB,UAAL,CAAgB,8CAAhB,CAAR,CAAb;;AAEA,UAAIiB,MAAJ,EAAY;AACV;;AAEA;AACA,aAAKE,mBAAL,CAAyB,EAACH,gBAAgBA,cAAjB,EAAzB;AACD;AACF;;AAED;;;;;;;4CAIwBA,c,EAAgB;;AAEtC,UAAIC,SAASC,QAAQ,KAAKlB,UAAL,CAAgB,4CAAhB,CAAR,CAAb;;AAEA,UAAIiB,MAAJ,EAAY;AACV;;AAEA;AACA,aAAKG,uBAAL,CAA6B,EAACJ,gBAAgBA,cAAjB,EAA7B;AACD;AACF;;;mCAEcK,I,EAAM;AACnB,UAAIA,IAAJ,EAAU;AACR,aAAKC,QAAL,GAAgB,IAAhB;AACD,OAFD,MAEO;AACL,aAAKA,QAAL,GAAgB,CAAC,KAAKA,QAAtB;AACD;;AAED,UAAI,KAAKA,QAAT,EAAmB;AACjB,YAAIC,SAASC,EAAE,KAAKC,OAAP,EAAgBC,IAAhB,CAAqB,4BAArB,CAAb;AACAC,mBAAW,YAAY;AACrBJ,iBAAOK,OAAP,CAAe,EAACC,WAAWN,OAAOO,MAAP,EAAZ,EAAf,EAA6C,GAA7C;AACD,SAFD,EAEG,GAFH;AAGD;AACF;;;yCAEoBC,I,EAAM;AACzB,aAAO,KAAKhC,aAAL,CAAmBiC,wBAAnB,CAA4CD,IAA5C,CAAP;AACD;;;;;;AAGHrC,wBAAwBuC,OAAxB,GAAkC,CAAC,QAAD,EAAU,UAAV,EAAqB,SAArB,EAA+B,sBAA/B,EAAsD,eAAtD,CAAlC;;AAEA,IAAMC,gCAAgC;AACpCC,YAAU;AACRjC,cAAU,GADF;AAERkC,UAAM,GAFE;AAGRjB,yBAAqB,GAHb;AAIRC,6BAAyB,GAJjB;AAKRN,yBAAqB,GALb;AAMRuB,wBAAoB,GANZ;AAORC,gBAAY;AAPJ,GAD0B;AAUpCC,eAAa,gDAVuB;AAWpCC,cAAY;AAXwB,CAAtC;;QAcS9C,uB,GAAAA,uB;QAAyBwC,6B,GAAAA,6B","file":"classResponse.js","sourcesContent":["'use strict';\n\nclass ClassResponseController {\n  constructor($scope, $element, $filter, StudentStatusService, ConfigService) {\n    this.$scope = $scope;\n    this.$element = $element;\n    this.$filter = $filter;\n    this.StudentStatusService = StudentStatusService;\n    this.ConfigService = ConfigService;\n\n    this.$translate = this.$filter('translate');\n\n    this.$scope.$watch(\n      () => { return this.response.replies.length; },\n      (oldValue, newValue) => {\n        if (newValue !== oldValue) {\n          this.toggleExpanded(true);\n          this.response.replyText = '';\n        }\n      }\n    );\n  }\n\n  getAvatarColorForWorkgroupId(workgroupId) {\n    return this.ConfigService.getAvatarColorForWorkgroupId(workgroupId);\n  }\n\n  replyEntered($event, response) {\n    if ($event.keyCode === 13) {\n      if (response.replyText) {\n        this.submitButtonClicked(response);\n      }\n    }\n  }\n\n  submitButtonClicked(response) {\n    // call the callback function in discussionController\n    this.submitbuttonclicked({r: response});\n  }\n\n  /**\n   * The delete button was clicked on a student post\n   * @param componentState the student component state\n   */\n  deleteButtonClicked(componentState) {\n\n    var answer = confirm(this.$translate(\"discussion.areYouSureYouWantToDeleteThisPost\"));\n\n    if (answer) {\n      // the teacher has answered yes to delete\n\n      // tell the discussionController to delete the post\n      this.deletebuttonclicked({componentState: componentState});\n    }\n  }\n\n  /**\n   * The undo delete button was clicked on a student post\n   * @param componentState the student component state\n   */\n  undoDeleteButtonClicked(componentState) {\n\n    var answer = confirm(this.$translate(\"discussion.areYouSureYouWantToShowThisPost\"));\n\n    if (answer) {\n      // the teacher has answered yes to undo the delete\n\n      // tell the discussionController to undo the delete of the post\n      this.undodeletebuttonclicked({componentState: componentState});\n    }\n  }\n\n  toggleExpanded(open) {\n    if (open) {\n      this.expanded = true;\n    } else {\n      this.expanded = !this.expanded;\n    }\n\n    if (this.expanded) {\n      var $clist = $(this.element).find('.discussion-comments__list');\n      setTimeout(function () {\n        $clist.animate({scrollTop: $clist.height()}, 250);\n      }, 250);\n    }\n  }\n\n  adjustClientSaveTime(time) {\n    return this.ConfigService.convertToClientTimestamp(time);\n  }\n}\n\nClassResponseController.$inject = ['$scope','$element','$filter','StudentStatusService','ConfigService'];\n\nconst ClassResponseComponentOptions = {\n  bindings: {\n    response: '=',\n    mode: '=',\n    deletebuttonclicked: '&',\n    undodeletebuttonclicked: '&',\n    submitbuttonclicked: '&',\n    studentdatachanged: '&',\n    isdisabled: '='\n  },\n  templateUrl: 'wise5/components/discussion/classResponse.html',\n  controller: 'ClassResponseController as classResponseCtrl'\n};\n\nexport { ClassResponseController, ClassResponseComponentOptions };\n"]}