<link rel="stylesheet" type="text/css" href="wise5/lib/drawingTool/drawing-tool.css">

<div ng-controller='DrawController as drawController' flex>
    <div ng-if='drawController.mode === "authoring" && !drawController.authoringComponentContent.showPreviousWork'>
                <textarea ng-model='drawController.authoringComponentContent.prompt'
                          ng-change='drawController.authoringViewComponentChanged()'
                          ng-model-options='{ debounce: 1000 }'
                          rows='10'
                          cols='100'></textarea>
                <br/>
                {{ 'SHOWSAVEBUTTON' | translate }}:
                <input type='checkbox'
                       ng-model='drawController.authoringComponentContent.showSaveButton'
                       ng-change='drawController.authoringViewComponentChanged()'/>
                <br/>
                {{ 'SHOWSUBMITBUTTON' | translate }}:
                <input type='checkbox'
                       ng-model='drawController.authoringComponentContent.showSubmitButton'
                       ng-change='drawController.authoringViewComponentChanged()'/>

                <br/>
                {{ 'MAXSCORE' | translate }}:
                <input type='number'
                       ng-model='drawController.authoringComponentContent.maxScore'
                       ng-change='drawController.authoringViewComponentChanged()'
                       ng-model-options='{ debounce: 1000 }'
                       style='width: 3em'/>
                <br/>
                {{ 'BACKGROUNDIMAGE' | translate }}:
                <input type='text'
                       size='80'
                       ng-model='drawController.authoringComponentContent.background'
                       ng-change='drawController.authoringViewComponentChanged()'/>
                <br/>
                {{ 'WIDTH' | translate }}: <input type='number'
                              ng-model='drawController.authoringComponentContent.width'
                              ng-change='drawController.authoringViewWidthChanged()'/>
                <br/>
                {{ 'HEIGHT' | translate }}: <input type='number'
                              ng-model='drawController.authoringComponentContent.height'
                              ng-change='drawController.authoringViewHeightChanged()'/>
                <br/>
                <button ng-click='drawController.authoringAddStampButtonClicked()'>{{ 'addStamp' | translate }}</button>
                <div ng-repeat='stamp in drawController.authoringComponentContent.stamps.Stamps track by $index'>
                    <input type='text'
                           size='50'
                           ng-model='drawController.authoringComponentContent.stamps.Stamps[$index]'
                           ng-change='drawController.authoringViewComponentChanged()'/>
                    <button ng-click='drawController.authoringStampUpClicked($index)'>{{ 'UP' | translate }}</button>
                    <button ng-click='drawController.authoringStampDownClicked($index)'>{{ 'DOWN' | translate }}</button>
                    <button ng-click='drawController.authoringDeleteStampClicked($index)'>{{ 'DELETE' | translate }}</button>
                </div>
                <br/>
                <button ng-click='drawController.authoringEnableAllToolsButtonClicked()'>{{ 'enableAllTools' | translate }}</button>
                <button ng-click='drawController.authoringDisableAllToolsButtonClicked()'>{{ 'disableAllTools' | translate }}</button>
                <br/>
                <label>
                    <input type='checkbox'
                       ng-model='drawController.authoringComponentContent.tools.select'
                       ng-change='drawController.authoringViewToolClicked()'/>
                    {{ 'selectTool' | translate }}
                </label>
                <br/>
                <label>
                    <input type='checkbox'
                           ng-model='drawController.authoringComponentContent.tools.line'
                           ng-change='drawController.authoringViewToolClicked()'/>
                    {{ 'lineTool' | translate }}
                </label>
                <br/>
                <label>
                    <input type='checkbox'
                           ng-model='drawController.authoringComponentContent.tools.shape'
                           ng-change='drawController.authoringViewToolClicked()'/>
                    {{ 'shapeTool' | translate }}
                </label>
                <br/>
                <label>
                    <input type='checkbox'
                           ng-model='drawController.authoringComponentContent.tools.freeHand'
                           ng-change='drawController.authoringViewToolClicked()'/>
                    {{ 'freeHandTool' | translate }}
                </label>
                <br/>
                <label>
                    <input type='checkbox'
                           ng-model='drawController.authoringComponentContent.tools.text'
                           ng-change='drawController.authoringViewToolClicked()'/>
                    {{ 'textTool' | translate }}
                </label>
                <br/>
                <label>
                    <input type='checkbox'
                           ng-model='drawController.authoringComponentContent.tools.stamp'
                           ng-change='drawController.authoringViewToolClicked()'/>
                    {{ 'stampTool' | translate }}
                </label>
                <br/>
                <label>
                    <input type='checkbox'
                           ng-model='drawController.authoringComponentContent.tools.clone'
                           ng-change='drawController.authoringViewToolClicked()'/>
                    {{ 'cloneTool' | translate }}
                </label>
                <br/>
                <label>
                    <input type='checkbox'
                           ng-model='drawController.authoringComponentContent.tools.strokeColor'
                           ng-change='drawController.authoringViewToolClicked()'/>
                    {{ 'strokeColorTool' | translate }}
                </label>
                <br/>
                <label>
                    <input type='checkbox'
                           ng-model='drawController.authoringComponentContent.tools.fillColor'
                           ng-change='drawController.authoringViewToolClicked()'/>
                    {{ 'fillColorTool' | translate }}
                </label>
                <br/>
                <label>
                    <input type='checkbox'
                           ng-model='drawController.authoringComponentContent.tools.strokeWidth'
                           ng-change='drawController.authoringViewToolClicked()'/>
                    {{ 'strokeWidthTool' | translate }}
                </label>
                <br/>
                <label>
                    <input type='checkbox'
                           ng-model='drawController.authoringComponentContent.tools.sendBack'
                           ng-change='drawController.authoringViewToolClicked()'/>
                    {{ 'sendBackTool' | translate }}
                </label>
                <br/>
                <label>
                    <input type='checkbox'
                           ng-model='drawController.authoringComponentContent.tools.sendForward'
                           ng-change='drawController.authoringViewToolClicked()'/>
                    {{ 'sendForwardTool' | translate }}
                </label>
                <br/>
                <label>
                    <input type='checkbox'
                           ng-model='drawController.authoringComponentContent.tools.undo'
                           ng-change='drawController.authoringViewToolClicked()'/>
                    {{ 'undoTool' | translate }}
                </label>
                <br/>
                <label>
                    <input type='checkbox'
                           ng-model='drawController.authoringComponentContent.tools.redo'
                           ng-change='drawController.authoringViewToolClicked()'/>
                    {{ 'redoTool' | translate }}
                </label>
                <br/>
                <label>
                    <input type='checkbox'
                           ng-model='drawController.authoringComponentContent.tools.delete'
                           ng-change='drawController.authoringViewToolClicked()'/>
                    {{ 'deleteTool' | translate }}
                </label>
                <button ng-click='drawController.authoringSaveStarterDrawData()'>{{ 'saveStarterDrawing' | translate }}</button>
                <button ng-click='drawController.authoringDeleteStarterDrawData()'>{{ 'deleteStarterDrawing' | translate }}</button>
    </div>
    <div ng-if='drawController.mode === "authoring"'>
        {{ 'IMPORTPREVIOUSWORK' | translate }}:
        <input type='checkbox'
               ng-model='drawController.authoringComponentContent.importPreviousWork'
               ng-click='drawController.authoringImportPreviousWorkClicked()'
               ng-change='drawController.authoringViewComponentChanged()'/>
    </div>
    <div ng-if='drawController.mode === "authoring" && drawController.authoringComponentContent.importPreviousWork'>
        {{ 'IMPORTPREVIOUSWORKSTEP' | translate }}:
        <select ng-model='drawController.authoringComponentContent.importPreviousWorkNodeId'
                ng-change='drawController.authoringImportPreviousWorkNodeIdChanged()'>
            <option></option>
            <option ng-repeat='item in drawController.idToOrder | toArray | orderBy : "order"'
                    value='{{item.$key}}'
                    ng-if='drawController.isApplicationNode(item.$key)'>{{drawController.getNodePositionAndTitleByNodeId(item.$key)}}</option>
        </select>
        <br/>
        {{ 'IMPORTPREVIOUSWORKCOMPONENT' | translate }}:
        <select ng-model='drawController.authoringComponentContent.importPreviousWorkComponentId'
                ng-change='drawController.authoringImportPreviousWorkComponentIdChanged()'
                ng-options='component.id as component.type disable when !drawController.componentHasWork(component) for component in drawController.getComponentsByNodeId(drawController.authoringComponentContent.importPreviousWorkNodeId)'>
            <option></option>
        </select>
    </div>
    <div ng-if='drawController.mode === "authoring"'>
        {{ 'SHOWPREVIOUSWORK' | translate }}:
        <input type='checkbox'
               ng-model='drawController.authoringComponentContent.showPreviousWork'
               ng-click='drawController.authoringShowPreviousWorkClicked()'
               ng-change='drawController.authoringViewComponentChanged()'/>
    </div>
    <div ng-if='drawController.mode === "authoring" && drawController.authoringComponentContent.showPreviousWork'>
        {{ 'SHOWPREVIOUSWORKSTEP' | translate }}:
        <select ng-model='drawController.authoringComponentContent.showPreviousWorkNodeId'
                ng-change='drawController.authoringShowPreviousWorkNodeIdChanged()'>
            <option></option>
            <option ng-repeat='item in drawController.idToOrder | toArray | orderBy : "order"'
                    value='{{item.$key}}'
                    ng-if='drawController.isApplicationNode(item.$key)'>{{drawController.getNodePositionAndTitleByNodeId(item.$key)}}</option>
        </select>
        <br/>
        {{ 'SHOWPREVIOUSWORKCOMPONENT' | translate }}:
        <select ng-model='drawController.authoringComponentContent.showPreviousWorkComponentId'
                ng-change='drawController.authoringShowPreviousWorkComponentIdChanged()'
                ng-options='component.id as component.type disable when !drawController.componentHasWork(component) for component in drawController.getComponentsByNodeId(drawController.authoringComponentContent.showPreviousWorkNodeId)'>
            <option></option>
        </select>
        <br/>
        {{ 'SHOWPREVIOUSWORKPROMPT' | translate }}:
        <input type='checkbox'
               ng-model='drawController.authoringComponentContent.showPreviousWorkPrompt'
               ng-change='drawController.authoringViewComponentChanged()'/>
    </div>
    <div ng-if='drawController.mode === "authoring"'>
        <textarea ng-model='drawController.authoringComponentContentJSONString'
                  ng-change='drawController.advancedAuthoringViewComponentChanged()'
                  ng-model-options="{ updateOn: 'blur' }"
                  rows='10'
                  cols='100'></textarea>
    </div>
    <div class="component__prompt">
        <div class="component__prompt__content"><compile data='drawController.getPrompt()'></compile></div>
        <possible-score max-score="drawController.componentContent.maxScore"
                        ng-if="drawController.mode === 'student' && !drawController.latestAnnotations.score"></possible-score>
    </div>
    <div class="component__actions" layout="row">
        <md-button class="md-accent" ng-show="drawController.isStudentAttachmentEnabled"
                   ng-click="nodeController.showStudentAssets($event, component.id, drawController.isDisabled)">
            <md-icon>image</md-icon> {{ 'insertFile' | translate }}
        </md-button>
    </div>
    <md-button class="md-accent"
            ng-click="drawController.resetButtonClicked()"
            ng-show="drawController.isResetButtonVisible">
            <md-icon> restore </md-icon> {{ 'RESET' | translate }}
    </md-button>
    <md-button class="md-accent md-primary"
            ng-click='drawController.snipDrawing($event)'
            ng-if='drawController.showSnipDrawingButton()'>
        <md-icon> content_cut </md-icon> {{ 'ADDTONOTEBOOK' | translate:{label:drawController.notebookConfig.label} }}
    </md-button>
    <div data-drop="true"
         jqyoui-droppable="{onDrop: 'drawController.dropCallback(item, $index)'}">
        <div id="{{drawController.drawingToolId}}"></div>
        <!--
        <h2>API examples:</h2>
        <div>
          <button id="set-background">Set background</button>
          <input type="text" id="background-src" value="https://ccshutterbugtest.s3.amazonaws.com/7a72684bb7e.png" size="70" />
          <button id="resize-background">Resize background to canvas</button>
          <button id="resize-canvas">Resize cavas to background</button>
          <button id="shrink-background">Shrink background to cavas</button>
        </div>
        <div>
          <button id="clear">Clear</button>
          <button id="save">Save</button>
          <button id="load" disabled>Load</button>
        </div>
        -->
    </div>
    <md-button class="revision md-icon-button" ng-click='nodeController.showRevisions($event, component.id)'
               ng-if="nodeController.getRevisions(component.id).length > 1">
        <md-icon> history </md-icon>
        <md-tooltip md-direction="top">{{nodeController.getRevisions(component.id).length}} {{ 'versions' | translate }}</md-tooltip>
    </md-button>
    <div ng-if="drawController.isSaveButtonVisible || drawController.isSubmitButtonVisible"
         class="component__actions" layout="row" layout-align="start center">
        <md-button class="md-primary"
                   ng-class="{'md-raised': !drawController.isSubmitButtonVisible}"
                   ng-click='drawController.saveButtonClicked()'
                   ng-disabled='drawController.isDisabled || !drawController.isDirty'
                   ng-show='drawController.isSaveButtonVisible'>{{ 'SAVE' | translate }}</md-button>
        <md-button class="md-raised md-primary"
                   ng-click='drawController.submitButtonClicked()'
                   ng-disabled='drawController.isDisabled || !drawController.isSubmitDirty'
                   ng-show='drawController.isSubmitButtonVisible'>{{ 'SUBMIT' | translate }}</md-button>
        <span ng-show="drawController.saveMessage.text"
              class="component__actions__info md-caption">
              {{drawController.saveMessage.text}} <span class="component__actions__more"><md-tooltip md-direction="top">{{ drawController.saveMessage.time | amDateFormat:'ddd, MMM D YYYY, h:mm a' }}</md-tooltip><span am-time-ago="drawController.saveMessage.time"></span></span>
        </span>
    </div>
    <component-annotations ng-if="drawController.mode === 'student'"
                           annotations='drawController.latestAnnotations'
                           max-score="drawController.componentContent.maxScore"></component-annotations>
    <component-grading ng-if="drawController.mode === 'grading'"
                      node-id='drawController.nodeId'
                      component-id='drawController.componentId'
                      max-score="drawController.componentContent.maxScore"
                      from-workgroup-id='teacherWorkgroupId'
                      to-workgroup-id='workgroupId'
                      component-state-id='componentState.id'
                      active="true"></component-grading>
</div>
