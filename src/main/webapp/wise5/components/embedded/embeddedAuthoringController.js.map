{"version":3,"sources":["embeddedAuthoringController.es6"],"names":["EmbeddedAuthoringController","$filter","$mdDialog","$q","$rootScope","$scope","$sce","$timeout","$window","AnnotationService","ConfigService","EmbeddedService","NodeService","NotebookService","ProjectService","StudentAssetService","StudentDataService","UtilService","allowedConnectedComponentTypes","type","$watch","authoringComponentContent","bind","newValue","oldValue","componentContent","injectAssetPaths","isSaveButtonVisible","showSaveButton","isSubmitButtonVisible","showSubmitButton","width","height","setURL","url","event","args","isEventTargetThisComponent","fileName","assetItem","target","summernoteId","getSummernoteId","restoreSummernoteCursorPosition","fullAssetPath","getFullAssetPath","isImage","insertImageIntoSummernote","isVideo","insertVideoIntoSummernote","authoringViewComponentChanged","hide","params","isPopup","nodeId","componentId","$broadcast","EmbeddedController","$inject"],"mappings":"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","file":"embeddedAuthoringController.js","sourcesContent":["'use strict';\n\nimport EmbeddedController from \"./embeddedController\";\n\nclass EmbeddedAuthoringController extends EmbeddedController {\n  constructor($filter,\n              $mdDialog,\n              $q,\n              $rootScope,\n              $scope,\n              $sce,\n              $timeout,\n              $window,\n              AnnotationService,\n              ConfigService,\n              EmbeddedService,\n              NodeService,\n              NotebookService,\n              ProjectService,\n              StudentAssetService,\n              StudentDataService,\n              UtilService) {\n    super($filter,\n      $mdDialog,\n      $q,\n      $rootScope,\n      $scope,\n      $sce,\n      $timeout,\n      $window,\n      AnnotationService,\n      ConfigService,\n      EmbeddedService,\n      NodeService,\n      NotebookService,\n      ProjectService,\n      StudentAssetService,\n      StudentDataService,\n      UtilService);\n\n    this.allowedConnectedComponentTypes = [\n      { type: 'Animation' },\n      { type: 'AudioOscillator' },\n      { type: 'ConceptMap' },\n      { type: 'Discussion' },\n      { type: 'Draw' },\n      { type: 'Embedded' },\n      { type: 'Graph' },\n      { type: 'Label' },\n      { type: 'Match' },\n      { type: 'MultipleChoice' },\n      { type: 'OpenResponse' },\n      { type: 'Table' }\n    ];\n\n    $scope.$watch(function() {\n      return this.authoringComponentContent;\n    }.bind(this), function(newValue, oldValue) {\n      this.componentContent = this.ProjectService.injectAssetPaths(newValue);\n      this.isSaveButtonVisible = this.componentContent.showSaveButton;\n      this.isSubmitButtonVisible = this.componentContent.showSubmitButton;\n      this.width = this.componentContent.width ? this.componentContent.width : '100%';\n      this.height = this.componentContent.height ? this.componentContent.height : '100%';\n      this.setURL(this.componentContent.url);\n    }.bind(this), true);\n  }\n\n  assetSelected(event, args) {\n    if (this.isEventTargetThisComponent(args)) {\n      const fileName = args.assetItem.fileName;\n      if (args.target === 'rubric') {\n        const summernoteId = this.getSummernoteId(args);\n        this.restoreSummernoteCursorPosition(summernoteId);\n        const fullAssetPath = this.getFullAssetPath(fileName);\n        if (this.UtilService.isImage(fileName)) {\n          this.insertImageIntoSummernote(summernoteId, fullAssetPath, fileName);\n        } else if (this.UtilService.isVideo(fileName)) {\n          this.insertVideoIntoSummernote(summernoteId, fullAssetPath);\n        }\n      } else if (args.target === 'modelFile') {\n        this.authoringComponentContent.url = fileName;\n        this.authoringViewComponentChanged();\n      }\n    }\n    this.$mdDialog.hide();\n  }\n\n  showModelFileChooserPopup() {\n    const params = {\n      isPopup: true,\n      nodeId: this.nodeId,\n      componentId: this.componentId,\n      target: 'modelFile'\n    };\n    this.$rootScope.$broadcast('openAssetChooser', params);\n  }\n}\n\nEmbeddedAuthoringController.$inject = [\n  '$filter',\n  '$mdDialog',\n  '$q',\n  '$rootScope',\n  '$scope',\n  '$sce',\n  '$timeout',\n  '$window',\n  'AnnotationService',\n  'ConfigService',\n  'EmbeddedService',\n  'NodeService',\n  'NotebookService',\n  'ProjectService',\n  'StudentAssetService',\n  'StudentDataService',\n  'UtilService'\n];\n\nexport default EmbeddedAuthoringController;\n"]}