<div ng-controller='GraphController as graphController' listen-for-delete-keypress style='display: flex'>
    <div style='flex: 1'>
        <div ng-if='graphController.mode === "authoring"'>
            <textarea ng-model='graphController.authoringComponentContent.prompt'
                      ng-change='graphController.authoringViewComponentChanged()'
                      ng-model-options='{ debounce: 1000 }'
                      rows='10'
                      cols='100'></textarea>
            <br/>
            Graph Title: <input ng-model='graphController.authoringComponentContent.title'
                                ng-change='graphController.authoringViewComponentChanged()'
                                size='30'/>
            Graph Type: <input ng-model='graphController.authoringComponentContent.graphType'
                               ng-change='graphController.authoringViewComponentChanged()'/>
            <br/>
            <br/>
            X Axis Title: <input ng-model='graphController.authoringComponentContent.xAxis.title.text'
                                 ng-change='graphController.authoringViewComponentChanged()'/>
            X Min: <input type='number'
                          ng-model='graphController.authoringComponentContent.xAxis.min'
                          ng-change='graphController.authoringViewComponentChanged()'/>
            X Max: <input type='number'
                          ng-model='graphController.authoringComponentContent.xAxis.max'
                          ng-change='graphController.authoringViewComponentChanged()'/>
            <br/>
            <br/>
            Y Axis Title: <input ng-model='graphController.authoringComponentContent.yAxis.title.text'
                                 ng-change='graphController.authoringViewComponentChanged()'/>
            Y Min: <input type='number'
                          ng-model='graphController.authoringComponentContent.yAxis.min'
                          ng-change='graphController.authoringViewComponentChanged()'/>
            Y Max: <input type='number'
                          ng-model='graphController.authoringComponentContent.yAxis.max'
                          ng-change='graphController.authoringViewComponentChanged()'/>
            <br/>
            Series
            <button ng-click='graphController.authoringAddSeriesClicked()'>Add Series</button>
            <div ng-repeat='series in graphController.authoringComponentContent.series track by $index'
                 style='border: 1px solid black'>
                Name: <input ng-model='series.name'
                             ng-change='graphController.authoringViewComponentChanged()'
                             size='30'/>
                <br/>
                Color: <input ng-model='series.color'/>
                <br/>
                Symbol: <input ng-model='series.marker.symbol'/>
                <br/>
                Can Student Edit: <input type='checkbox' ng-model='series.canEdit'/>
                <br/>
                <button ng-click='graphController.authoringDeleteSeriesClicked($index)'>Delete Series</button>
            </div>
            <br/>
            Max Score:
            <input type='number'
                   ng-model='graphController.authoringComponentContent.maxScore'
                   ng-change='graphController.authoringViewComponentChanged()'
                   ng-model-options='{ debounce: 1000 }'
                   style='width: 3em'/>
            <br/>
            <textarea ng-model='graphController.authoringComponentContentJSONString'
                      ng-change='graphController.advancedAuthoringViewComponentChanged()'
                      ng-model-options='{ debounce: 1000 }'
                      rows='10'
                      cols='100'></textarea>
        </div>
        <div class="component__prompt">
            <div class="component__prompt__content" compile='graphController.getPrompt()'></div>
            <possible-score max-score="graphController.componentContent.maxScore"
                            ng-if="graphController.mode === 'student' && !graphController.latestAnnotations.score"></possible-score>
        </div>
        <div class="component__actions" layout="row">
            <md-button class="md-accent" ng-show="graphController.isStudentAttachmentEnabled"
                       ng-click="nodeController.showStudentAssets($event, component.id, graphController.isDisabled)">
                <md-icon>image</md-icon> Import Data
            </md-button>
        </div>
        <button id='resetGraphButton'
                ng-click='graphController.resetGraph()'
                ng-show='graphController.showResetGraphButton()'>Reset Graph</button>

        <select ng-model='graphController.activeSeries'
                ng-options='series as series.name for series in graphController.series'
                ng-change='graphController.activeSeriesChanged()'
                ng-show='graphController.showSelectSeries()'>
        </select>
        <highchart id="{{graphController.chartId}}" config="graphController.chartConfig" class="span10" style="width:80%"></highchart>
        <component-annotations ng-if="graphController.mode === 'student'"
                               score-annotation='graphController.latestAnnotations.score'
                               comment-annotation='graphController.latestAnnotations.comment'
                               max-score="graphController.componentContent.maxScore"></component-annotations>
        <div class="component__actions" layout="row" layout-align="start center">
            <md-button class="md-raised md-primary"
                       ng-click='graphController.submitButtonClicked()'
                       ng-if='graphController.showSubmitButton()'
                       ng-disabled='graphController.isDisabled || !graphController.isSubmitDirty'>Submit</md-button>
            <md-button class="md-primary"
                       ng-class="{'md-raised': !graphController.showSubmitButton()}"
                       ng-click='graphController.saveButtonClicked()'
                       ng-if='graphController.showSaveButton()'
                       ng-disabled='graphController.isDisabled || !graphController.isDirty'>Save</md-button>
            <span ng-if="graphController.showSaveButton() || graphController.showSubmitButton()"
                      ng-show="graphController.saveMessage.text"
                      class="component__actions__info md-caption">
                      {{graphController.saveMessage.text}} <span class="component__actions__more"><md-tooltip md-direction="top">{{ graphController.saveMessage.time | amDateFormat:'ddd, MMM D YYYY, h:mm a' }}</md-tooltip><span am-time-ago="graphController.saveMessage.time"></span></span>
            </span>
        </div>
    </div>
    <div ng-if='graphController.mode === "grading" && graphController.componentContent.maxScore > -1'>
        <annotation type='score'
                    mode='graphController.mode'
                    node-id='graphController.nodeId'
                    component-id='graphController.componentId'
                    from-workgroup-id='teacherWorkgroupId'
                    to-workgroup-id='workgroupId'
                    component-state-id='componentState.id'
                    active='true'></annotation>
        <br/>
        <annotation type='comment'
                    mode='graphController.mode'
                    node-id='graphController.nodeId'
                    component-id='graphController.componentId'
                    from-workgroup-id='teacherWorkgroupId'
                    to-workgroup-id='workgroupId'
                    component-state-id='componentState.id'
                    active='true'></annotation>
    </div>
</div>
