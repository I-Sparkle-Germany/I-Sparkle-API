<html>
    <head></head>
    <body>
        <div class='openResponse' ng-controller='OpenResponseController as openResponseController' flex>
            <div flex="100">
                <style>
                    {{openResponseController.nodeContent.style}}
                </style>

                <div ng-if='openResponseController.mode === "authoring"'>
                    Prompt:
                    <br/>
                    <textarea ng-model='openResponseController.authoringComponentContent.prompt'
                              ng-change='openResponseController.authoringViewComponentChanged()'
                              ng-model-options='{ debounce: 1000 }'
                              rows='10'
                              cols='100'></textarea>
                    <br/>
                    Max Score:
                    <input type='number'
                           ng-model='openResponseController.authoringComponentContent.maxScore'
                           ng-change='openResponseController.authoringViewComponentChanged()'
                           ng-model-options='{ debounce: 1000 }'
                           style='width: 3em'/>
                    <br/>
                    <textarea ng-model='openResponseController.authoringComponentContentJSONString'
                              ng-change='openResponseController.advancedAuthoringViewComponentChanged()'
                              ng-model-options='{ debounce: 1000 }'
                              rows='10'
                              cols='100'></textarea>
                </div>
            <md-input-container class="input-container md-block input-container--open-response input-container--component md-no-float">
                <label class="input-label md-no-float" ng-disabled="openResponseController.isDisabled"
                       compile="openResponseController.getPrompt()" ng-if="openResponseController.showPrompt()"></label>
                <div class="input-wrapper" ng-class="{'input-wrapper--richtext': openResponseController.isRichTextEnabled}">
                    <textarea ng-if="openResponseController.isRichTextEnabled && !openResponseController.isDisabled"
                              ui-tinymce="openResponseController.tinymceOptions"
                              ng-model="openResponseController.studentResponse"
                              ng-model-options='{ debounce: 100 }'
                              ng-change="openResponseController.studentDataChanged()"></textarea>
                    <div ng-if="openResponseController.isRichTextEnabled && openResponseController.isDisabled"
                         class="input--textarea input--textarea--disabled">
                    </div>
                    <textarea ng-if="!openResponseController.isRichTextEnabled"
                              class="input--textarea input--textarea--hasaction"
                              rows="{{openResponseController.getNumRows() || 3}}"
                              ng-model="openResponseController.studentResponse"
                              ng-model-options='{ debounce: 100 }'
                              ng-disabled="openResponseController.isDisabled"
                              ng-change="openResponseController.studentDataChanged()"></textarea>
                    <md-button class="input--textarea__action input--textarea__action--revision md-icon-button"
                               ng-click='nodeController.showRevisions($event, component.id, openResponseController.isDisabled)'
                               ng-if="nodeController.getRevisions(component.id).length > 1">
                        <md-icon> history </md-icon>
                        <md-tooltip md-direction="left">{{nodeController.getRevisions(component.id).length}} Versions</md-tooltip>
                    </md-button>
                </div>
                </md-input-container>
                <div class="component-content__actions" ng-show="openResponseController.isStudentAttachmentEnabled" layout="row" layout-wrap="true">
                    <div class="component__add-attachment">
                        <md-button class="md-accent"
                                   ng-click="nodeController.showStudentAssets($event, component.id, openResponseController.isDisabled)">
                            <md-icon>image</md-icon> <span>Add File</span>
                        </md-button>
                    </div>
                    <div class="component__attachment" ng-repeat="attachment in openResponseController.attachments">
                        <img ng-src="{{attachment.iconURL}}" class="component__attachment__content" />
                        <md-button ng-show="!openResponseController.isDisabled" class="component__attachment__delete" ng-click='openResponseController.removeAttachment(attachment)' title="Remove file"><md-icon>cancel</md-icon></md-button>
                    </div>
                </div>
                <div ng-if='openResponseController.mode == "student"'>
                    <annotation type='score'
                                mode='{{openResponseController.mode}}'
                                nodeid='{{openResponseController.nodeId}}'
                                componentid='{{openResponseController.componentId}}'
                                fromworkgroupid='{{teacherWorkgroupId}}'
                                toworkgroupid='{{workgroupId}}'
                                componentstateid='{{componentState.id}}'></annotation>
                    <annotation type='comment'
                                mode='{{openResponseController.mode}}'
                                nodeid='{{openResponseController.nodeId}}'
                                componentid='{{openResponseController.componentId}}'
                                fromworkgroupid='{{teacherWorkgroupId}}'
                                toworkgroupid='{{workgroupId}}'
                                componentstateid='{{componentState.id}}'></annotation>
                </div>
                <div class="component-content__actions" layout="row">
                    <md-button class="md-primary"
                               ng-class="{'md-raised': !openResponseController.showSubmitButton()}"
                               ng-click="openResponseController.saveButtonClicked()"
                               ng-disabled="openResponseController.isDisabled"
                               ng-if="openResponseController.showSaveButton()">Save</md-button>
                    <md-button class="md-raised md-primary"
                               ng-click="openResponseController.submitButtonClicked()"
                               ng-disabled="openResponseController.isDisabled"
                               ng-if="openResponseController.showSubmitButton()">Submit</md-button>
                </div>
            </div>
            <div ng-if='openResponseController.mode == "grading"' style='width: 400px'>
                <annotation type='score'
                            mode='{{openResponseController.mode}}'
                            nodeid='{{openResponseController.nodeId}}'
                            componentid='{{openResponseController.componentId}}'
                            fromworkgroupid='{{teacherWorkgroupId}}'
                            toworkgroupid='{{workgroupId}}'
                            componentstateid='{{componentState.id}}'
                            active='true'></annotation>
                <br/>
                <annotation type='comment'
                            mode='{{openResponseController.mode}}'
                            nodeid='{{openResponseController.nodeId}}'
                            componentid='{{openResponseController.componentId}}'
                            fromworkgroupid='{{teacherWorkgroupId}}'
                            toworkgroupid='{{workgroupId}}'
                            componentstateid='{{componentState.id}}'
                            active='true'></annotation>
            </div>
        </div>
    </body>
</html>
