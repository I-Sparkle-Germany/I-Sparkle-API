<html>
    <head></head>
    <body>
        <div class='openResponse' ng-controller='OpenResponseController as openResponseController'>
            <style>
            {{openResponseController.nodeContent.style}}
            </style>

            <md-input-container class="input-container md-block input-container--open-response md-no-float">
                <label class="input-label md-no-float" ng-disabled="openResponseController.isDisabled"
                       compile="openResponseController.getPrompt()" ng-if="openResponseController.getPrompt()"></label>
                <div class="input-wrapper" ng-class="{'input-wrapper--richtext': openResponseController.isRichTextEnabled}">
                    <textarea ng-if="openResponseController.isRichTextEnabled && !openResponseController.isDisabled"
                              ui-tinymce="openResponseController.tinymceOptions"
                              ng-model="openResponseController.studentResponse"
                              ng-change="openResponseController.studentDataChanged()"></textarea>
                    <div ng-if="openResponseController.isRichTextEnabled && openResponseController.isDisabled"
                         class="input--textarea input--textarea--disabled">
                        <componentstatehtml componentstate="{{componentState}}"></componentstatehtml>
                    </div>
                    <textarea ng-if="!openResponseController.isRichTextEnabled"
                              class="input--textarea input--textarea--hasaction"
                              rows="{{openResponseController.getNumRows() || 3}}"
                              ng-model="openResponseController.studentResponse"
                              ng-disabled="openResponseController.isDisabled"
                              ng-change="openResponseController.studentDataChanged()"></textarea>
                    <md-button class="input--textarea__action input--textarea__action--notebook md-icon-button"
                               ng-click='nodeCtrl.addStudentWorkItemToNotebook(component.id)'
                               ng-disabled="!openResponseController.getStudentResponse()">
                        <md-icon> book </md-icon>
                        <md-tooltip md-direction="left">Add to Notebook</md-tooltip>
                    </md-button>
                    <md-button class="input--textarea__action input--textarea__action--revision md-icon-button"
                               ng-click='nodeCtrl.showRevisions($event, component.id, openResponseController.isDisabled)'
                               ng-if="nodeCtrl.getRevisions(component.id).length > 1">
                        <md-icon> history </md-icon>
                        <md-tooltip md-direction="left">{{nodeCtrl.getRevisions(component.id).length}} Versions</md-tooltip>
                    </md-button>
                </div>
            </md-input-container>
            <div class="component-content__actions" ng-show="openResponseController.attachments.length && openResponseController.isStudentAttachmentEnabled" layout="row" layout-wrap="true">
                <div class="component__add-attachment">
                    <md-button class="md-accent"
                               ng-click="nodeCtrl.showNotebook($event, component.id, openResponseController.isDisabled)">
                        <md-icon>image</md-icon> <span>Add File</span>
                    </md-button>
                </div>
                <div class="component__attachment" ng-repeat="attachment in openResponseController.attachments">
                    <img src="{{attachment.iconURL}}" class="component__attachment__content" />
                    <md-button class="component__attachment__delete" ng-click='openResponseController.removeAttachment(attachment)' title="Remove file"><md-icon>cancel</md-icon></md-button>
                </div>
            </div>

            <div class="component-content__actions" layout="row">
                <md-button class="md-raised md-primary"
                           ng-click="openResponseController.saveButtonClicked()"
                           ng-disabled="openResponseController.isDisabled"
                           ng-if="openResponseController.showSaveButton()">Save</md-button>
                <md-button class="md-raised md-primary"
                        ng-click="openResponseController.submitButtonClicked()"
                        ng-disabled="openResponseController.isDisabled"
                        ng-if="openResponseController.showSubmitButton()">Submit</md-button>
            </div>
        </div>
    </body>
</html>
