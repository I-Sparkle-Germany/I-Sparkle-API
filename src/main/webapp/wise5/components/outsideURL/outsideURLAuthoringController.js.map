{"version":3,"sources":["outsideURLAuthoringController.es6"],"names":["OutsideURLAuthoringController","$filter","$mdDialog","$q","$rootScope","$sce","$scope","AnnotationService","ConfigService","NodeService","NotebookService","OutsideURLService","ProjectService","StudentAssetService","StudentDataService","UtilService","$watch","authoringComponentContent","newValue","oldValue","componentContent","injectAssetPaths","setURL","url","setWidthAndHeight","width","height","$on","event","args","nodeId","componentId","assetItem","fileName","assetsDirectoryPath","getProjectAssetsDirectoryPath","fullAssetPath","summernoteId","target","isImage","$","summernote","isVideo","videoElement","document","createElement","controls","innerHTML","hide","OutsideURLController","$inject"],"mappings":"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","sourcesContent":["'use strict';\n\nimport OutsideURLController from \"./outsideURLController\";\n\nclass OutsideURLAuthoringController extends OutsideURLController {\n  constructor($filter,\n              $mdDialog,\n              $q,\n              $rootScope,\n              $sce,\n              $scope,\n              AnnotationService,\n              ConfigService,\n              NodeService,\n              NotebookService,\n              OutsideURLService,\n              ProjectService,\n              StudentAssetService,\n              StudentDataService,\n              UtilService) {\n    super($filter,\n      $mdDialog,\n      $q,\n      $rootScope,\n      $sce,\n      $scope,\n      AnnotationService,\n      ConfigService,\n      NodeService,\n      NotebookService,\n      OutsideURLService,\n      ProjectService,\n      StudentAssetService,\n      StudentDataService,\n      UtilService);\n\n    $scope.$watch(() => {\n      return this.authoringComponentContent;\n    }, (newValue, oldValue) => {\n      this.componentContent = this.ProjectService.injectAssetPaths(newValue);\n      this.setURL(this.authoringComponentContent.url);\n      this.setWidthAndHeight(\n          this.authoringComponentContent.width, this.authoringComponentContent.height);\n    }, true);\n\n    /*\n     * Listen for the assetSelected event which occurs when the user\n     * selects an asset from the choose asset popup\n     */\n    this.$scope.$on('assetSelected', (event, args) => {\n\n      if (args != null) {\n\n        // make sure the event was fired for this component\n        if (args.nodeId == this.nodeId && args.componentId == this.componentId) {\n          // the asset was selected for this component\n          var assetItem = args.assetItem;\n\n          if (assetItem != null) {\n            var fileName = assetItem.fileName;\n\n            if (fileName != null) {\n              /*\n               * get the assets directory path\n               * e.g.\n               * /wise/curriculum/3/\n               */\n              var assetsDirectoryPath = this.ConfigService.getProjectAssetsDirectoryPath();\n              var fullAssetPath = assetsDirectoryPath + '/' + fileName;\n\n              var summernoteId = '';\n\n              if (args.target == 'rubric') {\n                // the target is the summernote rubric element\n                summernoteId = 'summernoteRubric_' + this.nodeId + '_' + this.componentId;\n              }\n\n              if (summernoteId != '') {\n                if (this.UtilService.isImage(fileName)) {\n                  /*\n                   * move the cursor back to its position when the asset chooser\n                   * popup was clicked\n                   */\n                  $('#' + summernoteId).summernote('editor.restoreRange');\n                  $('#' + summernoteId).summernote('editor.focus');\n\n                  // add the image html\n                  $('#' + summernoteId).summernote('insertImage', fullAssetPath, fileName);\n                } else if (this.UtilService.isVideo(fileName)) {\n                  /*\n                   * move the cursor back to its position when the asset chooser\n                   * popup was clicked\n                   */\n                  $('#' + summernoteId).summernote('editor.restoreRange');\n                  $('#' + summernoteId).summernote('editor.focus');\n\n                  // insert the video element\n                  var videoElement = document.createElement('video');\n                  videoElement.controls = 'true';\n                  videoElement.innerHTML = '<source ng-src=\"' + fullAssetPath + '\" type=\"video/mp4\">';\n                  $('#' + summernoteId).summernote('insertNode', videoElement);\n                }\n              }\n            }\n          }\n        }\n      }\n\n      // close the popup\n      this.$mdDialog.hide();\n    });\n  }\n}\n\n  OutsideURLAuthoringController.$inject = [\n  '$filter',\n  '$mdDialog',\n  '$q',\n  '$rootScope',\n  '$sce',\n  '$scope',\n  'AnnotationService',\n  'ConfigService',\n  'NodeService',\n  'NotebookService',\n  'OutsideURLService',\n  'ProjectService',\n  'StudentAssetService',\n  'StudentDataService',\n  'UtilService'\n];\n\nexport default OutsideURLAuthoringController;\n"],"file":"outsideURLAuthoringController.js"}