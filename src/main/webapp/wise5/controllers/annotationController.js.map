{"version":3,"sources":["annotationController.es6"],"names":[],"mappings":"AAAA;;;;;;;;;;IAEM;AACF,aADE,oBACF,CAAY,iBAAZ,EACY,aADZ,EAEY,WAFZ,EAEyB;8BAHvB,sBAGuB;;AAErB,aAAK,iBAAL,GAAyB,iBAAzB,CAFqB;AAGrB,aAAK,aAAL,GAAqB,aAArB,CAHqB;AAIrB,aAAK,WAAL,GAAmB,WAAnB,CAJqB;;AAMrB,aAAK,YAAL,GAAoB,IAApB,CANqB;AAOrB,aAAK,MAAL,GAAc,IAAd,CAPqB;AAQrB,aAAK,QAAL,GAAgB,IAAhB,CARqB;AASrB,aAAK,WAAL,GAAmB,IAAnB,CATqB;AAUrB,aAAK,eAAL,GAAuB,IAAvB,CAVqB;AAWrB,aAAK,aAAL,GAAqB,IAArB,CAXqB;AAYrB,aAAK,gBAAL,GAAwB,IAAxB,CAZqB;AAarB,aAAK,IAAL,GAAY,IAAZ,CAbqB;AAcrB,aAAK,KAAL,GAAa,IAAb,CAdqB;;AAgBrB,aAAK,KAAL,GAAa,KAAK,aAAL,CAAmB,QAAnB,EAAb,CAhBqB;KAFzB;;;;;;;iBADE;;yCAyBe;;AAEb,gBAAI,KAAK,KAAL,IAAc,IAAd,IACA,KAAK,QAAL,IAAiB,IAAjB,IACA,KAAK,MAAL,IAAe,IAAf,IACA,KAAK,WAAL,IAAoB,IAApB,IACA,KAAK,eAAL,IAAwB,IAAxB,IACA,KAAK,aAAL,IAAsB,IAAtB,IACA,KAAK,IAAL,IAAa,IAAb,IACA,KAAK,KAAL,IAAc,IAAd,EAAoB;;;AAGpB,oBAAI,iBAAiB,IAAI,IAAJ,GAAW,OAAX,EAAjB;;;AAHgB,oBAMhB,QAAQ,KAAK,KAAL;;;AANQ,qBASpB,GAAQ,KAAK,WAAL,CAAiB,qBAAjB,CAAuC,KAAvC,CAAR,CAToB;;AAWpB,oBAAI,OAAO,EAAP,CAXgB;AAYpB,qBAAK,KAAL,GAAa,KAAb;;;AAZoB,oBAehB,aAAa,KAAK,iBAAL,CAAuB,gBAAvB,CACb,KAAK,YAAL,EACA,KAAK,KAAL,EACA,KAAK,QAAL,EACA,KAAK,eAAL,EACA,KAAK,aAAL,EACA,KAAK,MAAL,EACA,KAAK,WAAL,EACA,KAAK,gBAAL,EACA,KAAK,IAAL,EACA,IAVa,EAWb,cAXa,CAAb;;;AAfgB,oBA6BpB,CAAK,iBAAL,CAAuB,cAAvB,CAAsC,UAAtC,EAAkD,IAAlD,CAAuD,QAAQ,IAAR,CAAa,IAAb,EAAmB,UAAS,MAAT,EAAiB;AACvF,wBAAI,kBAAkB,MAAlB,CADmF;;AAGvF,wBAAI,mBAAmB,IAAnB,EAAyB;AACzB,4BAAI,KAAK,YAAL,IAAqB,IAArB,EAA2B;;AAE3B,iCAAK,YAAL,GAAoB,gBAAgB,EAAhB,CAFO;yBAA/B;qBADJ;iBAHsE,CAA1E,EA7BoB;aAPxB;;;;WA3BF;;;AA6EN,qBAAqB,OAArB,GAA+B,CAC3B,mBAD2B,EAE3B,eAF2B,EAG3B,aAH2B,CAA/B;;kBAMe","file":"annotationController.js","sourcesContent":["'use strict';\n\nclass AnnotationController {\n    constructor(AnnotationService,\n                ConfigService,\n                UtilService) {\n\n        this.AnnotationService = AnnotationService;\n        this.ConfigService = ConfigService;\n        this.UtilService = UtilService;\n\n        this.annotationId = null;\n        this.nodeId = null;\n        this.periodId = null;\n        this.componentId = null;\n        this.fromWorkgroupId = null;\n        this.toWorkgroupId = null;\n        this.componentStateId = null;\n        this.type = null;\n        this.value = null;\n\n        this.runId = this.ConfigService.getRunId();\n    }\n\n    /**\n     * Save the annotation to the server\n     */\n    postAnnotation() {\n\n        if (this.runId != null &&\n            this.periodId != null &&\n            this.nodeId != null &&\n            this.componentId != null &&\n            this.fromWorkgroupId != null &&\n            this.toWorkgroupId != null &&\n            this.type != null &&\n            this.value != null) {\n\n            // get the current time\n            var clientSaveTime = new Date().getTime();\n\n            // get the value\n            var value = this.value;\n\n            // convert the value to a number if possible\n            value = this.UtilService.convertStringToNumber(value);\n\n            var data = {};\n            data.value = value;\n\n            // create the annotation object\n            var annotation = this.AnnotationService.createAnnotation(\n                this.annotationId,\n                this.runId,\n                this.periodId,\n                this.fromWorkgroupId,\n                this.toWorkgroupId,\n                this.nodeId,\n                this.componentId,\n                this.componentStateId,\n                this.type,\n                data,\n                clientSaveTime);\n\n            // save the annotation to the server\n            this.AnnotationService.saveAnnotation(annotation).then(angular.bind(this, function(result) {\n                var localAnnotation = result;\n\n                if (localAnnotation != null) {\n                    if (this.annotationId == null) {\n                        // set the annotation id if there was no annotation id\n                        this.annotationId = localAnnotation.id;\n                    }\n                }\n            }));\n        }\n    };\n}\n\nAnnotationController.$inject = [\n    'AnnotationService',\n    'ConfigService',\n    'UtilService'\n];\n\nexport default AnnotationController;\n"]}