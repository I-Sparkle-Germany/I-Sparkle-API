{"version":3,"sources":["globalAnnotations.es6"],"names":["GlobalAnnotationsController","$mdDialog","$rootScope","$scope","$timeout","$translate","AnnotationService","active","$onInit","setModel","$on","event","args","show","activeGlobalAnnotationGroups","getActiveGlobalAnnotationGroups","length","visible","template","closeTo","angular","element","document","querySelector","openFrom","controller","GlobalAnnotationsDialogController","close","hide","$inject","GlobalAnnotations","bindings"],"mappings":"AAAA;;;;;;;;;;IAEMA,2B;AACF,yCAAYC,SAAZ,EACYC,UADZ,EAEYC,MAFZ,EAGYC,QAHZ,EAIYC,UAJZ,EAKYC,iBALZ,EAK+B;AAAA;;AAAA;;AAC3B,aAAKL,SAAL,GAAiBA,SAAjB;AACA,aAAKC,UAAL,GAAkBA,UAAlB;AACA,aAAKC,MAAL,GAAcA,MAAd;AACA,aAAKC,QAAL,GAAgBA,QAAhB;AACA,aAAKC,UAAL,GAAkBA,UAAlB;AACA,aAAKC,iBAAL,GAAyBA,iBAAzB;;AAEA,aAAKC,MAAL,GAAc,KAAd;;AAEA,aAAKC,OAAL,GAAe,YAAM;AACjB,kBAAKC,QAAL;AACH,SAFD;;AAIA;AACA,aAAKN,MAAL,CAAYO,GAAZ,CAAgB,yBAAhB,EAA2C,UAACC,KAAD,EAAQC,IAAR,EAAiB;AACxD,kBAAKH,QAAL;AACH,SAFD;;AAIA;AACA,aAAKP,UAAL,CAAgBQ,GAAhB,CAAoB,qBAApB,EAA2C,UAACC,KAAD,EAAQC,IAAR,EAAiB;AACxD,kBAAKH,QAAL;AACH,SAFD;;AAIA;AACA,aAAKP,UAAL,CAAgBQ,GAAhB,CAAoB,0BAApB,EAAgD,UAACC,KAAD,EAAQC,IAAR,EAAiB;AAC7D,kBAAKR,QAAL,CAAc,YAAM;AAChB;;;AAGA,sBAAKS,IAAL;AACH,aALD,EAKG,GALH;AAMH,SAPD;AAQH;;;;mCAEU;AACP,gBAAIC,+BAA+B,KAAKR,iBAAL,CAAuBS,+BAAvB,EAAnC;;AAEA,gBAAID,6BAA6BE,MAAjC,EAAyC;AACrC,qBAAKC,OAAL,GAAe,IAAf;AACH,aAFD,MAEO;AACH,qBAAKA,OAAL,GAAe,KAAf;AACH;AACJ;;;+BAEM;AACH;AACI,iBAAKhB,SAAL,CAAeY,IAAf,CAAoB;AAChBK,qqCADgB;AAsBhBC,yBAASC,QAAQC,OAAR,CAAgBC,SAASC,aAAT,CAAuB,mBAAvB,CAAhB,CAtBO;AAuBhBC,0BAAUJ,QAAQC,OAAR,CAAgBC,SAASC,aAAT,CAAuB,mBAAvB,CAAhB,CAvBM;AAwBhBE,4BAAYC;AAxBI,aAApB;;AA2BA,qBAASA,iCAAT,CAA2CvB,MAA3C,EAAmDF,SAAnD,EAA8D;AAC1DE,uBAAOwB,KAAP,GAAe,YAAW;AACtB1B,8BAAU2B,IAAV;AACH,iBAFD;AAGH;;AAEDF,8CAAkCG,OAAlC,GAA4C,CAAC,QAAD,EAAW,WAAX,CAA5C;AACJ;AACH;;;;;;AAGL7B,4BAA4B6B,OAA5B,GAAsC,CAClC,WADkC,EAElC,YAFkC,EAGlC,QAHkC,EAIlC,UAJkC,EAKlC,YALkC,EAMlC,mBANkC,CAAtC;;AASA,IAAMC,oBAAoB;AACtBC,cAAU,EADY;AAEtBb,yXAFsB;AAUtBO,gBAAYzB;AAVU,CAA1B;;kBAae8B,iB","file":"globalAnnotations.js","sourcesContent":["\"use strict\";\n\nclass GlobalAnnotationsController {\n    constructor($mdDialog,\n                $rootScope,\n                $scope,\n                $timeout,\n                $translate,\n                AnnotationService) {\n        this.$mdDialog = $mdDialog;\n        this.$rootScope = $rootScope;\n        this.$scope = $scope;\n        this.$timeout = $timeout;\n        this.$translate = $translate;\n        this.AnnotationService = AnnotationService;\n\n        this.active = false;\n\n        this.$onInit = () => {\n            this.setModel();\n        }\n\n        // list for new annotations or updates\n        this.$scope.$on('annotationSavedToServer', (event, args) => {\n            this.setModel();\n        });\n\n        // listen for node status changes\n        this.$rootScope.$on('nodeStatusesChanged', (event, args) => {\n            this.setModel();\n        });\n\n        // listen for the display global annotation event\n        this.$rootScope.$on('displayGlobalAnnotations', (event, args) => {\n            this.$timeout(() => {\n                /* waiting slightly here to make sure the #globalMsgTrigger is\n                 * shown and $mdDialog can get it's position upon opening\n                 */\n                this.show();\n            }, 300);\n        });\n    };\n\n    setModel() {\n        let activeGlobalAnnotationGroups = this.AnnotationService.getActiveGlobalAnnotationGroups();\n\n        if (activeGlobalAnnotationGroups.length) {\n            this.visible = true;\n        } else {\n            this.visible = false;\n        }\n    }\n\n    show() {\n        //this.$translate(['itemLocked', 'ok']).then((translations) => {\n            this.$mdDialog.show({\n                template:\n                    `<md-dialog aria-label=\"Global Feedback Dialog\">\n                        <!--<md-toolbar md-theme=\"light\">\n                            <div class=\"md-toolbar-tools\">\n                                <h2>Feedback</h2>\n                                <span flex></span>\n                                <md-button class=\"md-icon-button\" ng-click=\"close()\">\n                                    <md-icon aria-label=\"Close dialog\"> close </md-icon>\n                                </md-button>\n                            </div>\n                        </md-toolbar>-->\n                        <md-dialog-content class=\"md-dialog-content\">\n                            <h2 class=\"md-title\">{{ 'FEEDBACK' | translate }}</h2>\n                            <global-annotations-list></global-annotations-list>\n                        </md-dialog-content>\n                        <md-dialog-actions>\n                            <md-button ng-click=\"close()\" class=\"md-primary\">\n                                {{ 'CLOSE' | translate }}\n                            </md-button>\n                        </md-dialog-actions>\n                    </md-dialog>`,\n                closeTo: angular.element(document.querySelector('#globalMsgTrigger')),\n                openFrom: angular.element(document.querySelector('#globalMsgTrigger')),\n                controller: GlobalAnnotationsDialogController\n            });\n\n            function GlobalAnnotationsDialogController($scope, $mdDialog) {\n                $scope.close = function() {\n                    $mdDialog.hide();\n                }\n            }\n\n            GlobalAnnotationsDialogController.$inject = [\"$scope\", \"$mdDialog\"];\n        //})\n    }\n}\n\nGlobalAnnotationsController.$inject = [\n    '$mdDialog',\n    '$rootScope',\n    '$scope',\n    '$timeout',\n    '$translate',\n    'AnnotationService'\n];\n\nconst GlobalAnnotations = {\n    bindings: {},\n    template:\n        `<md-button id=\"globalMsgTrigger\"\n                    class=\"md-fab md-fab-bottom-right animate-fade\"\n                    aria-label=\"View Messages\"\n                    ng-if=\"$ctrl.visible && !$ctrl.active\" ng-click=\"$ctrl.show()\">\n            <md-icon>forum</md-icon>\n            <md-tooltip md-direction=\"left\">Feedback</md-tooltip>\n        </md-button>`,\n    controller: GlobalAnnotationsController\n};\n\nexport default GlobalAnnotations;\n"]}