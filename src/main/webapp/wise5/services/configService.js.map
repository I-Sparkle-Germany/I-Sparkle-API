{"version":3,"sources":["configService.es6"],"names":["ConfigService","$filter","$http","$location","config","$translate","sortClassmateUserInfosAlphabeticallyByName","setPermissions","setClassmateDisplayNames","configURL","get","then","result","configJSON","data","retrievalTimestamp","clientTimestamp","Date","getTime","serverTimestamp","timestampDiff","constraints","mode","absURL","$$absUrl","constraintsRegEx","RegExp","match","showProjectPathRegEx","host","location","origin","projectURL","projectPath","console","log","setConfig","isPreview","myUserInfo","getMyUserInfo","workgroupId","Math","floor","random","paramName","getConfigParam","periodId","periods","myClassInfo","userId","id","userInfo","getUserInfo","userName","classmateUserInfos","getClassmateUserInfos","n","length","i","workgroup","displayNames","getDisplayUserNamesByWorkgroupId","sortedClassmateUserInfos","c","push","sort","compareClassmateUserInfosByWorkgroupId","a","b","teacherWorkgroupId","teacherUserInfo","getTeacherUserInfo","sharedTeacherUserInfos","includeSelf","workgroupIds","getWorkgroupId","classmateUserInfo","sortClassmateUserInfosAlphabeticallyByNameHelper","aUserName","toLowerCase","bUserName","role","getTeacherRole","canViewStudentNames","canGradeStudentWork","isSwitchedUser","tempWorkgroupId","getUserInfoByWorkgroupId","studentNames","userNames","getUserNameByWorkgroupId","userNamesSplit","split","x","indexOfSpace","indexOf","studentFirstName","substring","userIds","userNamesObjects","name","regex","matches","exec","usernames","getPermissions","names","getUserNamesByWorkgroupId","l","getUserIdsByWorkgroupId","getMode","getSharedTeacherUserInfos","s","sharedTeacherUserInfo","isRunOwner","isRunSharedTeacher","getSharedTeacherRole","content","contentString","JSON","stringify","firstNames","getStudentFirstNamesByWorkgroupId","replace","join","parse","avatarColors","modulo","getLibraryProjectsURL","reverse","includeHost","projectAssetsDirectoryPath","projectBaseURL","window","html","assetsDirectoryPathIncludingHost","getProjectAssetsDirectoryPath","assetsDirectoryPathIncludingHostRegEx","assetsDirectoryPathNotIncludingHost","assetsDirectoryPathNotIncludingHostRegEx","wiseIds","projects","sharedProjects","authorableProjects","concat","sortByProjectId","projectA","projectB","projectIdA","projectIdB","$inject"],"mappings":"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","file":"configService.js","sourcesContent":["'use strict';\n\nclass ConfigService {\n\n  constructor($filter, $http, $location) {\n    this.$filter = $filter;\n    this.$http = $http;\n    this.$location = $location;\n    this.config = null;\n\n    this.$translate = this.$filter('translate');\n  };\n\n  setConfig(config) {\n    this.config = config;\n    this.sortClassmateUserInfosAlphabeticallyByName();\n    this.setPermissions();\n    this.setClassmateDisplayNames();\n  };\n\n  retrieveConfig(configURL) {\n    return this.$http.get(configURL).then((result) => {\n      var configJSON = result.data;\n\n      if (configJSON.retrievalTimestamp != null) {\n        // get the client timestamp\n        var clientTimestamp = new Date().getTime();\n\n        // get the server timestamp\n        var serverTimestamp = configJSON.retrievalTimestamp;\n\n        // get the difference between the client and server time\n        var timestampDiff = clientTimestamp - serverTimestamp;\n\n        // add the timestamp diff to the config object\n        configJSON.timestampDiff = timestampDiff;\n      }\n\n      var constraints = true;\n\n      if (configJSON.mode == 'preview') {\n        // constraints can only be disabled using the url in preview mode\n\n        // get the full url\n        var absURL = this.$location.$$absUrl;\n\n        // regex to match constraints=false in the url\n        var constraintsRegEx = new RegExp(\"constraints=false\", 'gi');\n\n        if (absURL != null && absURL.match(constraintsRegEx)) {\n          // the url contains constraints=false\n          constraints = false;\n        }\n      }\n\n      // set the constraints value into the config so we can access it later\n      configJSON.constraints = constraints;\n\n      // regex to match showProjectPath=true in the url\n      var showProjectPathRegEx = new RegExp(\"showProjectPath=true\", 'gi');\n\n      if (absURL != null && absURL.match(showProjectPathRegEx)) {\n        // the url contains showProjectPath=true\n\n        // get the host e.g. http://wise.berkeley.edu\n        var host = location.origin;\n\n        // get the project URL e.g. /wise/curriculum/123/project.json\n        var projectURL = configJSON.projectURL;\n\n        // get the full project path\n        var projectPath = host + projectURL;\n\n        // output the full project path to the console\n        console.log(projectPath);\n      }\n\n      this.setConfig(configJSON);\n\n      if (this.isPreview()) {\n        // assign a random workgroup id\n        var myUserInfo = this.getMyUserInfo();\n        if (myUserInfo != null) {\n          // set the workgroup id to a random integer between 1 and 100\n          myUserInfo.workgroupId = Math.floor(100 * Math.random()) + 1;\n        }\n      }\n\n      return configJSON;\n    });\n  };\n\n  getConfigParam(paramName) {\n    if (this.config !== null) {\n      return this.config[paramName];\n    } else {\n      return null;\n    }\n  };\n\n  getAchievementsURL() {\n    return this.getConfigParam('achievementURL');\n  };\n\n  getCRaterRequestURL() {\n    return this.getConfigParam('cRaterRequestURL');\n  };\n\n  getMainHomePageURL() {\n    return this.getConfigParam('mainHomePageURL');\n  };\n\n  getNotificationURL() {\n    return this.getConfigParam('notificationURL');\n  };\n\n  getRunId() {\n    return this.getConfigParam('runId');\n  };\n\n  getProjectId() {\n    return this.getConfigParam('projectId');\n  };\n\n  getOpenCPUURL() {\n    return this.getConfigParam('openCPUURL');\n  };\n\n  getSessionLogOutURL() {\n    return this.getConfigParam('sessionLogOutURL');\n  };\n\n  getStudentAssetsURL() {\n    return this.getConfigParam('studentAssetsURL');\n  };\n\n  getStudentStatusURL() {\n    return this.getConfigParam('studentStatusURL');\n  };\n\n  getStudentMaxTotalAssetsSize() {\n    return this.getConfigParam('studentMaxTotalAssetsSize');\n  };\n\n  getStudentNotebookURL() {\n    return this.getConfigParam('studentNotebookURL');\n  };\n\n  getStudentUploadsBaseURL() {\n    return this.getConfigParam('studentUploadsBaseURL');\n  };\n\n  getUserInfo() {\n    return this.getConfigParam('userInfo');\n  };\n\n  getWebSocketURL() {\n    return this.getConfigParam('webSocketURL');\n  };\n\n  getWISEBaseURL() {\n    return this.getConfigParam('wiseBaseURL');\n  };\n\n  getLocale() {\n    return this.getConfigParam('locale') || 'en';\n  };\n\n  getMode() {\n    return this.getConfigParam('mode');\n  };\n\n  /**\n   * Returns the period id of the logged-in user.\n   */\n  getPeriodId() {\n    var periodId = null;\n    var myUserInfo = this.getMyUserInfo();\n    if (myUserInfo != null) {\n      periodId = myUserInfo.periodId;\n    }\n    return periodId;\n  };\n\n  /**\n   * Get the periods\n   * @returns an array of period objects\n   */\n  getPeriods() {\n    var periods = [];\n\n    var myUserInfo = this.getMyUserInfo();\n    if (myUserInfo != null) {\n\n      var myClassInfo = myUserInfo.myClassInfo;\n      if (myClassInfo != null) {\n\n        if (myClassInfo.periods != null) {\n          periods = myClassInfo.periods;\n        }\n      }\n    }\n\n    return periods;\n  };\n\n  getWorkgroupId() {\n    var workgroupId = null;\n\n    var myUserInfo = this.getMyUserInfo();\n    if (myUserInfo != null) {\n      workgroupId = myUserInfo.workgroupId;\n    }\n\n    return workgroupId;\n  };\n\n  /**\n   * Get the user id (aka WISE ID)\n   * @return the user id\n   */\n  getUserId() {\n\n    var userId = null;\n\n    var myUserInfo = this.getMyUserInfo();\n\n    if (myUserInfo != null) {\n      userId = myUserInfo.id;\n    }\n\n    return userId;\n  }\n\n  getMyUserInfo() {\n    var myUserInfo = null;\n\n    var userInfo = this.getUserInfo();\n    if (userInfo != null) {\n      myUserInfo = userInfo.myUserInfo;\n    }\n\n    return myUserInfo;\n  };\n\n  /**\n   * Get the user name of the signed in user\n   * @return the user name of the signed in user\n   */\n  getMyUserName() {\n\n    var userName = null;\n\n    // get my user info\n    var myUserInfo = this.getMyUserInfo();\n\n    if (myUserInfo != null) {\n      // get the user name\n      userName = myUserInfo.userName;\n    }\n\n    return userName;\n  }\n\n  getClassmateUserInfos() {\n    var classmateUserInfos = null;\n    var myUserInfo = this.getMyUserInfo();\n    if (myUserInfo != null) {\n      var myClassInfo = myUserInfo.myClassInfo;\n      if (myClassInfo != null) {\n        classmateUserInfos = myClassInfo.classmateUserInfos;\n      }\n    }\n\n    return classmateUserInfos;\n  };\n\n  setClassmateDisplayNames() {\n    let classmateUserInfos = this.getClassmateUserInfos();\n\n    if (classmateUserInfos) {\n      let n = classmateUserInfos.length;\n\n      for (let i = 0; i < n; i++) {\n        let workgroup = classmateUserInfos[i];\n        workgroup.displayNames = this.getDisplayUserNamesByWorkgroupId(workgroup.workgroupId);\n      }\n    }\n  }\n\n  /**\n   * Get the classmate user infos sorted by ascending workgroup id\n   * @return an array of classmate user info objects sorted by ascending\n   * workgroup id\n   */\n  getClassmateUserInfosSortedByWorkgroupId() {\n\n    var sortedClassmateUserInfos = [];\n\n    // get all the classmate user info objects\n    var classmateUserInfos = this.getClassmateUserInfos();\n\n    if (classmateUserInfos != null) {\n\n      /*\n       * loop through all the classmate user info objects and add it to\n       * new array of classmate user infos\n       */\n      for (var c = 0; c < classmateUserInfos.length; c++) {\n        sortedClassmateUserInfos.push(classmateUserInfos[c]);\n      }\n    }\n\n    // sort the new classmate user infos array by ascending workgroup id\n    sortedClassmateUserInfos.sort(this.compareClassmateUserInfosByWorkgroupId);\n\n    return sortedClassmateUserInfos;\n  }\n\n  /**\n   * Used to sort the classmate user infos by ascending workgroup id.\n   * Use by calling myArray.sort(compareClassmateUserInfosByWorkgroupId)\n   * @param a a user info object\n   * @param b a user info Object\n   * @return -1 if a comes before b\n   * 1 if a comes after b\n   * 0 if a equals b\n   */\n  compareClassmateUserInfosByWorkgroupId(a, b) {\n    if (a.workgroupId < b.workgroupId) {\n      return -1;\n    } else if (a.workgroupId > b.workgroupId) {\n      return 1;\n    } else {\n      return 0;\n    }\n  }\n\n  getTeacherWorkgroupId() {\n    var teacherWorkgroupId = null;\n    var teacherUserInfo = this.getTeacherUserInfo();\n    if (teacherUserInfo != null) {\n      teacherWorkgroupId = teacherUserInfo.workgroupId;\n    }\n    return teacherWorkgroupId;\n  };\n\n  getTeacherUserInfo() {\n    var teacherUserInfo = null;\n    var myUserInfo = this.getMyUserInfo();\n    if (myUserInfo != null) {\n      var myClassInfo = myUserInfo.myClassInfo;\n      if (myClassInfo != null) {\n        teacherUserInfo = myClassInfo.teacherUserInfo;\n      }\n    }\n    return teacherUserInfo;\n  };\n\n  /**\n   * Get the shared teacher user infos for the run\n   */\n  getSharedTeacherUserInfos() {\n    var sharedTeacherUserInfos = null;\n    var myUserInfo = this.getMyUserInfo();\n    if (myUserInfo != null) {\n      var myClassInfo = myUserInfo.myClassInfo;\n      if (myClassInfo != null) {\n        sharedTeacherUserInfos = myClassInfo.sharedTeacherUserInfos;\n      }\n    }\n    return sharedTeacherUserInfos;\n  }\n\n  getClassmateWorkgroupIds(includeSelf) {\n    var workgroupIds = [];\n\n    if (includeSelf) {\n      workgroupIds.push(this.getWorkgroupId());\n    }\n\n    var classmateUserInfos = this.getClassmateUserInfos();\n\n    if (classmateUserInfos != null) {\n      for (var c = 0; c < classmateUserInfos.length; c++) {\n        var classmateUserInfo = classmateUserInfos[c];\n\n        if (classmateUserInfo != null) {\n          var workgroupId = classmateUserInfo.workgroupId;\n\n          if (workgroupId != null) {\n            workgroupIds.push(workgroupId);\n          }\n        }\n      }\n    }\n\n    return workgroupIds;\n  };\n\n  sortClassmateUserInfosAlphabeticallyByName() {\n    var classmateUserInfos = this.getClassmateUserInfos();\n\n    if (classmateUserInfos != null) {\n      classmateUserInfos.sort(this.sortClassmateUserInfosAlphabeticallyByNameHelper);\n    }\n\n    return classmateUserInfos;\n  };\n\n  sortClassmateUserInfosAlphabeticallyByNameHelper(a, b) {\n    var result = 0;\n\n    if (a != null && a.userName != null && b != null && b.userName != null) {\n      var aUserName = a.userName.toLowerCase();\n      var bUserName = b.userName.toLowerCase();\n\n      if (aUserName < bUserName) {\n        result = -1;\n      } else if (aUserName > bUserName) {\n        result = 1;\n      }\n    }\n\n    return result;\n  };\n\n  setPermissions() {\n    // get the role of the teacher for the run e.g. 'owner', 'write', 'read'\n    let role = this.getTeacherRole(this.getWorkgroupId());\n\n    if (role === 'owner') {\n      // the teacher is the owner of the run and has full access\n      this.config.canViewStudentNames = true;\n      this.config.canGradeStudentWork = true;\n    } else if (role === 'write') {\n      // the teacher is a shared teacher that can grade the student work\n      this.config.canViewStudentNames = true;\n      this.config.canGradeStudentWork = true;\n    } else if (role === 'read') {\n      // the teacher is a shared teacher that can only view the student work\n      this.config.canViewStudentNames = false;\n      this.config.canGradeStudentWork = false;\n    } else {\n      // teacher role is null, so assume we're in student mode\n      this.config.canViewStudentNames = true;\n      this.config.canGradeStudentWork = false;\n    }\n  }\n\n  getPermissions() {\n\n    // a switched user (admin/researcher user impersonating a teacher) should not be able to view/grade\n    return {\n      canViewStudentNames: this.config.canViewStudentNames && !this.isSwitchedUser(),\n      canGradeStudentWork: this.config.canGradeStudentWork && !this.isSwitchedUser()\n    }\n  }\n\n  getUserInfoByWorkgroupId(workgroupId) {\n    var userInfo = null;\n\n    if (workgroupId != null) {\n\n      var myUserInfo = this.getMyUserInfo();\n\n      if (myUserInfo != null) {\n        var tempWorkgroupId = myUserInfo.workgroupId;\n\n        if (workgroupId === tempWorkgroupId) {\n          userInfo = myUserInfo;\n        }\n      }\n\n      if (userInfo == null) {\n        var classmateUserInfos = this.getClassmateUserInfos();\n\n        if (classmateUserInfos != null) {\n          for (var c = 0; c < classmateUserInfos.length; c++) {\n            var classmateUserInfo = classmateUserInfos[c];\n\n            if (classmateUserInfo != null) {\n              var tempWorkgroupId = classmateUserInfo.workgroupId;\n\n              if (workgroupId == tempWorkgroupId) {\n                userInfo = classmateUserInfo;\n                break;\n              }\n            }\n          }\n        }\n      }\n    }\n\n    return userInfo;\n  };\n\n  /**\n   * Get the period id for a workgroup id\n   * @param workgroupId the workgroup id\n   * @returns the period id the workgroup id is in\n   */\n  getPeriodIdByWorkgroupId(workgroupId) {\n    var periodId = null;\n\n    if (workgroupId != null) {\n      var userInfo = this.getUserInfoByWorkgroupId(workgroupId);\n\n      if (userInfo != null) {\n        periodId = userInfo.periodId;\n      }\n    }\n\n    return periodId;\n  };\n\n  /**\n   * Get the student names\n   * @param workgroupId the workgroup id\n   * @return an array containing the student names\n   */\n  getStudentFirstNamesByWorkgroupId(workgroupId) {\n    var studentNames = [];\n\n    // get the user names for the workgroup e.g. \"Spongebob Squarepants (SpongebobS0101):Patrick Star (PatrickS0101)\"\n    var userNames = this.getUserNameByWorkgroupId(workgroupId);\n\n    if (userNames != null) {\n      // split the user names string by ':'\n      var userNamesSplit = userNames.split(':');\n\n      if (userNamesSplit != null) {\n        // loop through each user name\n        for (var x = 0; x < userNamesSplit.length; x++) {\n          // get a user name e.g. \"Spongebob Squarepants (spongebobs0101)\"\n          var userName = userNamesSplit[x];\n\n          // get the index of the first empty space\n          var indexOfSpace = userName.indexOf(' ');\n\n          // get the student first name e.g. \"Spongebob\"\n          var studentFirstName = userName.substring(0, indexOfSpace);\n\n          // add the student name to the array\n          studentNames.push(studentFirstName);\n        }\n      }\n    }\n\n    return studentNames;\n  };\n\n  getUserIdsByWorkgroupId(workgroupId) {\n    var userIds = [];\n\n    if (workgroupId != null) {\n      var userInfo = this.getUserInfoByWorkgroupId(workgroupId);\n\n      if (userInfo != null) {\n        userIds = userInfo.userIds;\n      }\n    }\n\n    return userIds;\n  };\n\n  getUserNameByWorkgroupId(workgroupId) {\n    var userName = null;\n\n    if (workgroupId != null) {\n      var userInfo = this.getUserInfoByWorkgroupId(workgroupId);\n\n      if (userInfo != null) {\n        userName = userInfo.userName;\n      }\n    }\n\n    return userName;\n  };\n\n  getDisplayNamesByWorkgroupId(workgroupId) {\n    var displayNames = null;\n\n    if (workgroupId != null) {\n      var userInfo = this.getUserInfoByWorkgroupId(workgroupId);\n\n      if (userInfo != null) {\n        displayNames = userInfo.displayNames;\n      }\n    }\n\n    return displayNames;\n  };\n\n  getUserNamesByWorkgroupId(workgroupId) {\n    let userNamesObjects = [];\n\n    if (workgroupId != null) {\n      let userInfo = this.getUserInfoByWorkgroupId(workgroupId);\n\n      if (userInfo != null) {\n        let userNames = userInfo.userName.split(':');\n\n        for (let i = 0; i < userNames.length; i++) {\n          let name = userNames[i];\n          let id = \"\";\n          let regex = /(.+) \\((.+)\\)/g;\n          let matches = regex.exec(name);\n          if (matches) {\n            name = matches[1];\n            id = matches[2];\n          }\n          userNamesObjects.push({\n            name: name,\n            id: id\n          });\n        }\n      }\n    }\n\n    return userNamesObjects;\n  };\n\n  getDisplayUserNamesByWorkgroupId(workgroupId) {\n    let usernames = '';\n\n    if (workgroupId != null) {\n      if (this.getPermissions().canViewStudentNames) {\n        let names = this.getUserNamesByWorkgroupId(workgroupId);\n        let l = names.length;\n        for (let i = 0; i < l; i++) {\n          let name = names[i].name;\n          usernames += name;\n\n          if (i < (l-1)) {\n            usernames += ', ';\n          }\n        }\n      } else {\n        // current user is not allowed to view student names, so return string with student ids\n        let userIds = this.getUserIdsByWorkgroupId(workgroupId);\n        for (let i = 0; i < userIds.length; i++) {\n          let id = userIds[i];\n          if (i !== 0) {\n            usernames += ', ';\n          }\n          usernames += this.$translate('studentId', {id: id});\n        }\n      }\n    }\n\n    return usernames;\n  };\n\n  isPreview() {\n    var result = false;\n\n    var mode = this.getMode();\n\n    if (mode != null && mode === 'preview') {\n      result = true;\n    }\n\n    return result;\n  };\n\n  /**\n   * Convert a client timestamp to a server timestamp. This is required\n   * in case the client and server clocks are not synchronized.\n   * @param clientTimestamp the client timestamp\n   */\n  convertToServerTimestamp(clientTimestamp) {\n\n    // get the difference between the client time and server time\n    var timestampDiff = this.getConfigParam('timestampDiff');\n\n    // convert the client timestamp to a server timestamp\n    var serverTimestamp = clientTimestamp - timestampDiff;\n\n    return serverTimestamp;\n  }\n\n  /**\n   * Convert a server timestamp to a client timestamp. This is required\n   * in case the client and server clocks are not synchronized.\n   * @param serverTimestamp the client timestamp\n   */\n  convertToClientTimestamp(serverTimestamp) {\n\n    // get the difference between the client time and server time\n    var timestampDiff = this.getConfigParam('timestampDiff');\n\n    // convert the client timestamp to a server timestamp\n    var clientTimestamp = serverTimestamp + timestampDiff;\n\n    return clientTimestamp;\n  }\n\n  /**\n   * Check if the workgroup is the owner of the run\n   * @param workgroupId the workgroup id\n   * @returns whether the workgroup is the owner of the run\n   */\n  isRunOwner(workgroupId) {\n\n    var result = false;\n\n    if (workgroupId != null) {\n      var teacherUserInfo = this.getTeacherUserInfo();\n\n      if (teacherUserInfo != null) {\n\n        if (workgroupId == teacherUserInfo.workgroupId) {\n          result = true;\n        }\n      }\n    }\n\n    return result;\n  }\n\n  /**\n   * Check if the workgroup is a shared teacher for the run\n   * @param workgroupId the workgroup id\n   * @returns whether the workgroup is a shared teacher of the run\n   */\n  isRunSharedTeacher(workgroupId) {\n\n    var result = false;\n\n    if (workgroupId != null) {\n      var sharedTeacherUserInfos = this.getSharedTeacherUserInfos();\n\n      if (sharedTeacherUserInfos != null) {\n\n        for (var s = 0; s < sharedTeacherUserInfos.length; s++) {\n          var sharedTeacherUserInfo = sharedTeacherUserInfos[s];\n\n          if (sharedTeacherUserInfo != null) {\n            if (workgroupId == sharedTeacherUserInfo.workgroupId) {\n              result = true;\n            }\n          }\n        }\n      }\n    }\n\n    return result;\n  }\n\n  /**\n   * Get the teacher role for the run\n   * @param workgroupId the workgroup id\n   * @returns the role of the teacher for the run. the possible values are\n   * 'owner', 'write', 'read'\n   */\n  getTeacherRole(workgroupId) {\n    var role = null;\n\n    if (this.isRunOwner(workgroupId)) {\n      // the teacher is the owner of the run\n      role = 'owner';\n    } else if (this.isRunSharedTeacher(workgroupId)) {\n      // the teacher is a shared teacher so their role may be 'write' or 'read'\n      role = this.getSharedTeacherRole(workgroupId);\n    }\n\n    return role;\n  }\n\n  /**\n   * Get the shared teacher role for the run\n   * @param workgroupId the workgroup id\n   * @returns the shared teacher role for the run. the possible values are\n   * 'write' or 'read'\n   */\n  getSharedTeacherRole(workgroupId) {\n    var role = null;\n\n    if (workgroupId != null) {\n      var sharedTeacherUserInfos = this.getSharedTeacherUserInfos();\n\n      if (sharedTeacherUserInfos != null) {\n\n        for (var s = 0; s < sharedTeacherUserInfos.length; s++) {\n          var sharedTeacherUserInfo = sharedTeacherUserInfos[s];\n\n          if (sharedTeacherUserInfo != null) {\n            if (workgroupId == sharedTeacherUserInfo.workgroupId) {\n              role = sharedTeacherUserInfo.role;\n            }\n          }\n        }\n      }\n    }\n\n    return role;\n  }\n\n  /**\n   * Replace student names in the content.\n   * For example, we will replace instances of {{firstStudentFirstName}}\n   * with the actual first name of the first student in the workgroup.\n   * @param content a content object or string\n   * @return an updated content object or string\n   */\n  replaceStudentNames(content) {\n    if (content != null) {\n\n      var contentString = content;\n\n      if (typeof content === 'object') {\n        // get the content as a string\n        contentString = JSON.stringify(content);\n      }\n\n      if (contentString != null) {\n\n        // get the workgroup id\n        var workgroupId = this.getWorkgroupId();\n\n        // get all the first names\n        var firstNames = this.getStudentFirstNamesByWorkgroupId(workgroupId);\n\n        if (firstNames.length >= 1) {\n          /*\n           * there are 1 or more students in the workgroup so we can\n           * replace the first student first name with the actual\n           * name\n           */\n          contentString = contentString.replace(new RegExp('{{firstStudentFirstName}}', 'gi'), firstNames[0]);\n\n          /*\n           * there are 1 or more students in the workgroup so we can\n           * replace the student first names with the actual names\n           */\n          contentString = contentString.replace(new RegExp('{{studentFirstNames}}', 'gi'), firstNames.join(\", \"));\n        }\n\n        if (firstNames.length >= 2) {\n          /*\n           * there are 2 or more students in the workgroup so we can\n           * replace the second student first name with the actual\n           * name\n           */\n          contentString = contentString.replace(new RegExp('{{secondStudentFirstName}}', 'gi'), firstNames[1]);\n        }\n\n        if (firstNames.length >= 3) {\n          /*\n           * there are 3 or more students in the workgroup so we can\n           * replace the third student first name with the actual\n           * name\n           */\n          contentString = contentString.replace(new RegExp('{{thirdStudentFirstName}}', 'gi'), firstNames[2]);\n        }\n      }\n\n      if (typeof content === 'object') {\n        // convert the content string back into an object\n        content = JSON.parse(contentString);\n      } else if (typeof content === 'string') {\n        // the content was a string so we can just use the content string\n        content = contentString;\n      }\n    }\n\n    return content;\n  }\n\n  getAvatarColorForWorkgroupId(workgroupId) {\n    var avatarColors = ['#E91E63', '#9C27B0', '#CDDC39', '#2196F3', '#FDD835', '#43A047', '#795548', '#EF6C00', '#C62828', '#607D8B'];\n    var modulo = workgroupId % 10;\n    return avatarColors[modulo];\n  }\n\n  /**\n   * Get the library projects\n   */\n  getLibraryProjects() {\n\n    // get the URL to get the list of library projects\n    var getLibraryProjectsURL = this.getConfigParam('getLibraryProjectsURL');\n\n    if (getLibraryProjectsURL != null) {\n\n      // request the list of library projects\n      return this.$http.get(getLibraryProjectsURL).then((result) => {\n\n        var data = result.data;\n\n        if (data != null) {\n          // reverse the list so that it is ordered newest to oldest\n          data.reverse();\n        }\n\n        return data;\n      });\n    }\n  }\n\n  /**\n   * Get the project assets folder path\n   * @param includeHost whether to include the host in the URL\n   * @return the project assets folder path\n   * e.g.\n   * with host\n   * http://wise.berkeley.edu/wise/curriculum/3/assets\n   * without host\n   * /wise/curriculum/3/assets\n   */\n  getProjectAssetsDirectoryPath(includeHost) {\n    var projectAssetsDirectoryPath = null;\n\n    // get the project base URL e.g. /wise/curriculum/3/\n    var projectBaseURL = this.getConfigParam('projectBaseURL');\n\n    if (projectBaseURL != null) {\n      if (includeHost) {\n        // get the host e.g. http://wise.berkeley.edu\n        var host = window.location.origin;\n\n        /*\n         * get the full path including the host\n         * e.g. http://wise.berkeley.edu/wise/curriculum/3/assets\n         */\n        projectAssetsDirectoryPath = host + projectBaseURL + 'assets';\n      } else {\n        /*\n         * get the full path not including the host\n         * e.g. /wise/curriculum/3/assets\n         */\n        projectAssetsDirectoryPath = projectBaseURL + 'assets';\n      }\n    }\n\n    return projectAssetsDirectoryPath;\n  }\n\n  /**\n   * Remove the absolute asset paths\n   * e.g.\n   * <img src='https://wise.berkeley.edu/curriculum/3/assets/sun.png'/>\n   * will be changed to\n   * <img src='sun.png'/>\n   * @param html the html\n   * @return the modified html without the absolute asset paths\n   */\n  removeAbsoluteAssetPaths(html) {\n    /*\n     * get the assets directory path with the host\n     * e.g.\n     * https://wise.berkeley.edu/wise/curriculum/3/assets/\n     */\n    var includeHost = true;\n    var assetsDirectoryPathIncludingHost = this.getProjectAssetsDirectoryPath(includeHost);\n    var assetsDirectoryPathIncludingHostRegEx = new RegExp(assetsDirectoryPathIncludingHost, 'g');\n\n    /*\n     * get the assets directory path without the host\n     * e.g.\n     * /wise/curriculum/3/assets/\n     */\n    var assetsDirectoryPathNotIncludingHost = this.getProjectAssetsDirectoryPath() + '/';\n    var assetsDirectoryPathNotIncludingHostRegEx = new RegExp(assetsDirectoryPathNotIncludingHost, 'g');\n\n    /*\n     * remove the directory path from the html so that only the file name\n     * remains in asset references\n     * e.g.\n     * <img src='https://wise.berkeley.edu/wise/curriculum/3/assets/sun.png'/>\n     * will be changed to\n     * <img src='sun.png'/>\n     */\n    html = html.replace(assetsDirectoryPathIncludingHostRegEx, '');\n    html = html.replace(assetsDirectoryPathNotIncludingHostRegEx, '');\n\n    return html\n  }\n\n  /**\n   * Get the WISE IDs for a workgroup\n   * @param workgroupId get the WISE IDs for this workgroup\n   * @return an array of WISE IDs\n   */\n  getWISEIds(workgroupId) {\n\n    var wiseIds = [];\n\n    if (workgroupId != null) {\n      // get the user info object for the workgroup id\n      var userInfo = this.getUserInfoByWorkgroupId(workgroupId);\n\n      if (userInfo != null) {\n        // get the WISE IDs\n        wiseIds = userInfo.userIds;\n      }\n    }\n\n    return wiseIds;\n  }\n\n  /**\n   * Get all the authorable projects\n   */\n  getAuthorableProjects() {\n\n    // get the projects this teacher owns\n    var projects = this.getConfigParam('projects');\n\n    // get the projects that were shared with the teacher\n    var sharedProjects = this.getConfigParam('sharedProjects');\n\n    var authorableProjects = [];\n\n    if (projects != null) {\n      // add the owned projects\n      authorableProjects = authorableProjects.concat(projects);\n    }\n\n    if (sharedProjects != null) {\n      // add the shared projects\n      authorableProjects = authorableProjects.concat(sharedProjects);\n    }\n\n    // sort the projects by descending id\n    authorableProjects.sort(this.sortByProjectId);\n\n    return authorableProjects;\n  }\n\n  /**\n   * Determines whether the current user is logged in as somebody else\n   * @return true iff the user is a switched user\n   */\n  isSwitchedUser() {\n    let myUserInfo = this.getMyUserInfo();\n\n    if (myUserInfo != null) {\n\n      if (myUserInfo.isSwitchedUser) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Sort the objects by descending id.\n   * @param projectA an object with an id field\n   * @param projectB an object with an id field\n   * @return 1 if projectA comes before projectB\n   * -1 if projectA comes after projectB\n   * 0 if they are the same\n   */\n  sortByProjectId(projectA, projectB) {\n    var projectIdA = projectA.id;\n    var projectIdB = projectB.id;\n\n    if (projectIdA < projectIdB) {\n      return 1;\n    } else if (projectIdA > projectIdB) {\n      return -1;\n    } else {\n      return 0;\n    }\n  }\n};\n\nConfigService.$inject = [\n  '$filter',\n  '$http',\n  '$location'\n];\n\nexport default ConfigService;\n"]}