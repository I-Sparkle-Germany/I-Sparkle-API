{"version":3,"sources":["configService.es6"],"names":["ConfigService","$filter","$http","$location","config","$translate","sortClassmateUserInfosAlphabeticallyByName","setPermissions","setClassmateDisplayNames","configURL","get","then","result","configJSON","data","retrievalTimestamp","clientTimestamp","Date","getTime","serverTimestamp","timestampDiff","constraints","absURL","$$absUrl","mode","constraintsRegEx","RegExp","match","showProjectPathRegEx","host","location","origin","projectURL","projectPath","console","log","setConfig","isPreview","myUserInfo","getMyUserInfo","workgroupId","Math","floor","random","paramName","getConfigParam","periodId","myClassInfo","periods","id","userInfo","getUserInfo","userName","classmateUserInfos","getClassmateUserInfos","workgroup","displayNames","getDisplayUserNamesByWorkgroupId","sortedClassmateUserInfos","classmateUserInfo","push","sort","compareClassmateUserInfosByWorkgroupId","a","b","teacherUserInfo","getTeacherUserInfo","sharedTeacherUserInfos","includeSelf","workgroupIds","getWorkgroupId","sortClassmateUserInfosAlphabeticallyByNameHelper","aUserName","toLowerCase","bUserName","role","getTeacherRole","canViewStudentNames","canGradeStudentWork","isSwitchedUser","tempWorkgroupId","getUserInfoByWorkgroupId","studentNames","userNames","getUserNameByWorkgroupId","userNamesSplit","split","indexOfSpace","indexOf","studentFirstName","substring","userIds","userNamesObjects","name","regex","matches","exec","usernames","getPermissions","names","getUserNamesByWorkgroupId","l","length","i","getUserIdsByWorkgroupId","getMode","getSharedTeacherUserInfos","sharedTeacherUserInfo","isRunOwner","isRunSharedTeacher","getSharedTeacherRole","content","contentString","JSON","stringify","firstNames","getStudentFirstNamesByWorkgroupId","replace","join","parse","avatarColors","modulo","getLibraryProjectsURL","reverse","includeHost","projectBaseURL","window","html","assetsDirectoryPathIncludingHost","getProjectAssetsDirectoryPath","assetsDirectoryPathIncludingHostRegEx","assetsDirectoryPathNotIncludingHost","assetsDirectoryPathNotIncludingHostRegEx","ownedProjects","sharedProjects","authorableProjects","concat","sortByProjectId","projectA","projectB","projectIdA","projectIdB","$inject"],"mappings":"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","file":"configService.js","sourcesContent":["'use strict';\n\nclass ConfigService {\n  constructor($filter, $http, $location) {\n    this.$filter = $filter;\n    this.$http = $http;\n    this.$location = $location;\n    this.config = null;\n    this.$translate = this.$filter('translate');\n  };\n\n  setConfig(config) {\n    this.config = config;\n    this.sortClassmateUserInfosAlphabeticallyByName();\n    this.setPermissions();\n    this.setClassmateDisplayNames();\n  };\n\n  retrieveConfig(configURL) {\n    return this.$http.get(configURL).then((result) => {\n      const configJSON = result.data;\n      if (configJSON.retrievalTimestamp != null) {\n        const clientTimestamp = new Date().getTime();\n        const serverTimestamp = configJSON.retrievalTimestamp;\n        const timestampDiff = clientTimestamp - serverTimestamp;\n        configJSON.timestampDiff = timestampDiff;\n      }\n\n      let constraints = true;\n\n      const absURL = this.$location.$$absUrl;\n\n      if (configJSON.mode == 'preview') {\n        // constraints can only be disabled using the url in preview mode\n\n        // regex to match constraints=false in the url\n        const constraintsRegEx = new RegExp(\"constraints=false\", 'gi');\n\n        if (absURL != null && absURL.match(constraintsRegEx)) {\n          // the url contains constraints=false\n          constraints = false;\n        }\n      }\n\n      // set the constraints value into the config so we can access it later\n      configJSON.constraints = constraints;\n\n      // regex to match showProjectPath=true in the url\n      const showProjectPathRegEx = new RegExp(\"showProjectPath=true\", 'gi');\n\n      if (absURL != null && absURL.match(showProjectPathRegEx)) {\n        // the url contains showProjectPath=true\n        const host = location.origin;\n        const projectURL = configJSON.projectURL;\n        const projectPath = host + projectURL;\n        console.log(projectPath);\n      }\n\n      this.setConfig(configJSON);\n\n      if (this.isPreview()) {\n        const myUserInfo = this.getMyUserInfo();\n        if (myUserInfo != null) {\n          // set the workgroup id to a random integer between 1 and 100\n          myUserInfo.workgroupId = Math.floor(100 * Math.random()) + 1;\n        }\n      }\n\n      return configJSON;\n    });\n  };\n\n  getConfigParam(paramName) {\n    if (this.config !== null) {\n      return this.config[paramName];\n    } else {\n      return null;\n    }\n  };\n\n  getAchievementsURL() {\n    return this.getConfigParam('achievementURL');\n  };\n\n  getCRaterRequestURL() {\n    return this.getConfigParam('cRaterRequestURL');\n  };\n\n  getMainHomePageURL() {\n    return this.getConfigParam('mainHomePageURL');\n  };\n\n  getNotificationURL() {\n    return this.getConfigParam('notificationURL');\n  };\n\n  getRunId() {\n    return this.getConfigParam('runId');\n  };\n\n  getProjectId() {\n    return this.getConfigParam('projectId');\n  };\n\n  getOpenCPUURL() {\n    return this.getConfigParam('openCPUURL');\n  };\n\n  getSessionLogOutURL() {\n    return this.getConfigParam('sessionLogOutURL');\n  };\n\n  getStudentAssetsURL() {\n    return this.getConfigParam('studentAssetsURL');\n  };\n\n  getStudentStatusURL() {\n    return this.getConfigParam('studentStatusURL');\n  };\n\n  getStudentMaxTotalAssetsSize() {\n    return this.getConfigParam('studentMaxTotalAssetsSize');\n  };\n\n  getStudentNotebookURL() {\n    return this.getConfigParam('studentNotebookURL');\n  };\n\n  getStudentUploadsBaseURL() {\n    return this.getConfigParam('studentUploadsBaseURL');\n  };\n\n  getUserInfo() {\n    return this.getConfigParam('userInfo');\n  };\n\n  getWebSocketURL() {\n    return this.getConfigParam('webSocketURL');\n  };\n\n  getWISEBaseURL() {\n    return this.getConfigParam('wiseBaseURL');\n  };\n\n  getLocale() {\n    return this.getConfigParam('locale') || 'en';\n  };\n\n  getMode() {\n    return this.getConfigParam('mode');\n  };\n\n  getContextPath() {\n    return this.getConfigParam('contextPath');\n  }\n\n  /**\n   * Returns the period id of the logged-in user.\n   */\n  getPeriodId() {\n    const myUserInfo = this.getMyUserInfo();\n    if (myUserInfo != null) {\n      return myUserInfo.periodId;\n    }\n    return null;\n  };\n\n  /**\n   * Get the periods\n   * @returns an array of period objects\n   */\n  getPeriods() {\n    const myUserInfo = this.getMyUserInfo();\n    if (myUserInfo != null) {\n      const myClassInfo = myUserInfo.myClassInfo;\n      if (myClassInfo != null) {\n        if (myClassInfo.periods != null) {\n          return myClassInfo.periods;\n        }\n      }\n    }\n    return [];\n  };\n\n  getWorkgroupId() {\n    const myUserInfo = this.getMyUserInfo();\n    if (myUserInfo != null) {\n      return myUserInfo.workgroupId;\n    }\n    return null;\n  };\n\n  /**\n   * Get the user id (aka WISE ID)\n   * @return the user id\n   */\n  getUserId() {\n    const myUserInfo = this.getMyUserInfo();\n    if (myUserInfo != null) {\n      return myUserInfo.id;\n    }\n    return null;\n  }\n\n  getMyUserInfo() {\n    const userInfo = this.getUserInfo();\n    if (userInfo != null) {\n      return userInfo.myUserInfo;\n    }\n    return null;\n  };\n\n  /**\n   * Get the user name of the signed in user\n   * @return the user name of the signed in user\n   */\n  getMyUserName() {\n    const myUserInfo = this.getMyUserInfo();\n    if (myUserInfo != null) {\n      return myUserInfo.userName;\n    }\n    return null;\n  }\n\n  getClassmateUserInfos() {\n    const myUserInfo = this.getMyUserInfo();\n    if (myUserInfo != null) {\n      const myClassInfo = myUserInfo.myClassInfo;\n      if (myClassInfo != null) {\n        return myClassInfo.classmateUserInfos;\n      }\n    }\n    return null;\n  };\n\n  setClassmateDisplayNames() {\n    let classmateUserInfos = this.getClassmateUserInfos();\n    if (classmateUserInfos) {\n      for (let workgroup of classmateUserInfos) {\n        workgroup.displayNames = this.getDisplayUserNamesByWorkgroupId(workgroup.workgroupId);\n      }\n    }\n  }\n\n  /**\n   * Get the classmate user infos sorted by ascending workgroup id\n   * @return an array of classmate user info objects sorted by ascending\n   * workgroup id\n   */\n  getClassmateUserInfosSortedByWorkgroupId() {\n    const sortedClassmateUserInfos = [];\n    const classmateUserInfos = this.getClassmateUserInfos();\n    if (classmateUserInfos != null) {\n      for (let classmateUserInfo of classmateUserInfos) {\n        sortedClassmateUserInfos.push(classmateUserInfo);\n      }\n    }\n    // sort the new classmate user infos array by ascending workgroup id\n    sortedClassmateUserInfos.sort(this.compareClassmateUserInfosByWorkgroupId);\n    return sortedClassmateUserInfos;\n  }\n\n  /**\n   * Used to sort the classmate user infos by ascending workgroup id.\n   * Use by calling myArray.sort(compareClassmateUserInfosByWorkgroupId)\n   * @param a a user info object\n   * @param b a user info Object\n   * @return -1 if a comes before b\n   * 1 if a comes after b\n   * 0 if a equals b\n   */\n  compareClassmateUserInfosByWorkgroupId(a, b) {\n    if (a.workgroupId < b.workgroupId) {\n      return -1;\n    } else if (a.workgroupId > b.workgroupId) {\n      return 1;\n    } else {\n      return 0;\n    }\n  }\n\n  getTeacherWorkgroupId() {\n    const teacherUserInfo = this.getTeacherUserInfo();\n    if (teacherUserInfo != null) {\n      return teacherUserInfo.workgroupId;\n    }\n    return null;\n  };\n\n  getTeacherUserInfo() {\n    const myUserInfo = this.getMyUserInfo();\n    if (myUserInfo != null) {\n      const myClassInfo = myUserInfo.myClassInfo;\n      if (myClassInfo != null) {\n        return myClassInfo.teacherUserInfo;\n      }\n    }\n    return null;\n  };\n\n  /**\n   * Get the shared teacher user infos for the run\n   */\n  getSharedTeacherUserInfos() {\n    const myUserInfo = this.getMyUserInfo();\n    if (myUserInfo != null) {\n      const myClassInfo = myUserInfo.myClassInfo;\n      if (myClassInfo != null) {\n        return myClassInfo.sharedTeacherUserInfos;\n      }\n    }\n    return null;\n  }\n\n  getClassmateWorkgroupIds(includeSelf) {\n    const workgroupIds = [];\n    if (includeSelf) {\n      workgroupIds.push(this.getWorkgroupId());\n    }\n    const classmateUserInfos = this.getClassmateUserInfos();\n    if (classmateUserInfos != null) {\n      for (let classmateUserInfo of classmateUserInfos) {\n        if (classmateUserInfo != null) {\n          const workgroupId = classmateUserInfo.workgroupId;\n\n          if (workgroupId != null) {\n            workgroupIds.push(workgroupId);\n          }\n        }\n      }\n    }\n    return workgroupIds;\n  };\n\n  sortClassmateUserInfosAlphabeticallyByName() {\n    const classmateUserInfos = this.getClassmateUserInfos();\n    if (classmateUserInfos != null) {\n      classmateUserInfos.sort(this.sortClassmateUserInfosAlphabeticallyByNameHelper);\n    }\n    return classmateUserInfos;\n  };\n\n  sortClassmateUserInfosAlphabeticallyByNameHelper(a, b) {\n    if (a != null && a.userName != null && b != null && b.userName != null) {\n      const aUserName = a.userName.toLowerCase();\n      const bUserName = b.userName.toLowerCase();\n      if (aUserName < bUserName) {\n        return -1;\n      } else if (aUserName > bUserName) {\n        return 1;\n      }\n    }\n    return 0;\n  };\n\n  setPermissions() {\n    let role = this.getTeacherRole(this.getWorkgroupId());\n    if (role === 'owner') {\n      // the teacher is the owner of the run and has full access\n      this.config.canViewStudentNames = true;\n      this.config.canGradeStudentWork = true;\n    } else if (role === 'write') {\n      // the teacher is a shared teacher that can grade the student work\n      this.config.canViewStudentNames = true;\n      this.config.canGradeStudentWork = true;\n    } else if (role === 'read') {\n      // the teacher is a shared teacher that can only view the student work\n      this.config.canViewStudentNames = false;\n      this.config.canGradeStudentWork = false;\n    } else {\n      // teacher role is null, so assume we're in student mode\n      this.config.canViewStudentNames = true;\n      this.config.canGradeStudentWork = false;\n    }\n  }\n\n  getPermissions() {\n    // a switched user (admin/researcher user impersonating a teacher) should not be able to view/grade\n    return {\n      canViewStudentNames: this.config.canViewStudentNames && !this.isSwitchedUser(),\n      canGradeStudentWork: this.config.canGradeStudentWork && !this.isSwitchedUser()\n    }\n  }\n\n  getUserInfoByWorkgroupId(workgroupId) {\n    let userInfo = null;\n    if (workgroupId != null) {\n      const myUserInfo = this.getMyUserInfo();\n      if (myUserInfo != null) {\n        const tempWorkgroupId = myUserInfo.workgroupId;\n        if (workgroupId === tempWorkgroupId) {\n          userInfo = myUserInfo;\n        }\n      }\n\n      if (userInfo == null) {\n        const classmateUserInfos = this.getClassmateUserInfos();\n        if (classmateUserInfos != null) {\n          for (let classmateUserInfo of classmateUserInfos) {\n            if (classmateUserInfo != null) {\n              const tempWorkgroupId = classmateUserInfo.workgroupId;\n              if (workgroupId == tempWorkgroupId) {\n                userInfo = classmateUserInfo;\n                break;\n              }\n            }\n          }\n        }\n      }\n    }\n    return userInfo;\n  };\n\n  /**\n   * Get the period id for a workgroup id\n   * @param workgroupId the workgroup id\n   * @returns the period id the workgroup id is in\n   */\n  getPeriodIdByWorkgroupId(workgroupId) {\n    if (workgroupId != null) {\n      const userInfo = this.getUserInfoByWorkgroupId(workgroupId);\n      if (userInfo != null) {\n        return userInfo.periodId;\n      }\n    }\n    return null;\n  };\n\n  /**\n   * Get the student names\n   * @param workgroupId the workgroup id\n   * @return an array containing the student names\n   */\n  getStudentFirstNamesByWorkgroupId(workgroupId) {\n    const studentNames = [];\n    const userNames = this.getUserNameByWorkgroupId(workgroupId);\n\n    if (userNames != null) {\n      // split the user names string by ':'\n      const userNamesSplit = userNames.split(':');\n\n      if (userNamesSplit != null) {\n        for (let userName of userNamesSplit) {\n          const indexOfSpace = userName.indexOf(' ');\n          const studentFirstName = userName.substring(0, indexOfSpace);\n          studentNames.push(studentFirstName);\n        }\n      }\n    }\n    return studentNames;\n  };\n\n  getUserIdsByWorkgroupId(workgroupId) {\n    if (workgroupId != null) {\n      const userInfo = this.getUserInfoByWorkgroupId(workgroupId);\n      if (userInfo != null) {\n        return userInfo.userIds;\n      }\n    }\n    return [];\n  };\n\n  getUserNameByWorkgroupId(workgroupId) {\n    if (workgroupId != null) {\n      const userInfo = this.getUserInfoByWorkgroupId(workgroupId);\n      if (userInfo != null) {\n        return userInfo.userName;\n      }\n    }\n    return null;\n  };\n\n  getDisplayNamesByWorkgroupId(workgroupId) {\n    if (workgroupId != null) {\n      const userInfo = this.getUserInfoByWorkgroupId(workgroupId);\n      if (userInfo != null) {\n        return userInfo.displayNames;\n      }\n    }\n    return null;\n  };\n\n  getUserNamesByWorkgroupId(workgroupId) {\n    let userNamesObjects = [];\n    if (workgroupId != null) {\n      let userInfo = this.getUserInfoByWorkgroupId(workgroupId);\n      if (userInfo != null) {\n        let userNames = userInfo.userName.split(':');\n        for (let name of userNames) {\n          let id = \"\";\n          let regex = /(.+) \\((.+)\\)/g;\n          let matches = regex.exec(name);\n          if (matches) {\n            name = matches[1];\n            id = matches[2];\n          }\n          userNamesObjects.push({\n            name: name,\n            id: id\n          });\n        }\n      }\n    }\n    return userNamesObjects;\n  };\n\n  getDisplayUserNamesByWorkgroupId(workgroupId) {\n    let usernames = '';\n    if (workgroupId != null) {\n      if (this.getPermissions().canViewStudentNames) {\n        let names = this.getUserNamesByWorkgroupId(workgroupId);\n        let l = names.length;\n        for (let i = 0; i < l; i++) {\n          let name = names[i].name;\n          usernames += name;\n\n          if (i < (l-1)) {\n            usernames += ', ';\n          }\n        }\n      } else {\n        // current user is not allowed to view student names, so return string with student ids\n        let userIds = this.getUserIdsByWorkgroupId(workgroupId);\n        for (let i = 0; i < userIds.length; i++) {\n          let id = userIds[i];\n          if (i !== 0) {\n            usernames += ', ';\n          }\n          usernames += this.$translate('studentId', {id: id});\n        }\n      }\n    }\n    return usernames;\n  };\n\n  isPreview() {\n    const mode = this.getMode();\n    return mode != null && mode === 'preview';\n  };\n\n  /**\n   * Convert a client timestamp to a server timestamp. This is required\n   * in case the client and server clocks are not synchronized.\n   * @param clientTimestamp the client timestamp\n   */\n  convertToServerTimestamp(clientTimestamp) {\n    const timestampDiff = this.getConfigParam('timestampDiff');\n    const serverTimestamp = clientTimestamp - timestampDiff;\n    return serverTimestamp;\n  }\n\n  /**\n   * Convert a server timestamp to a client timestamp. This is required\n   * in case the client and server clocks are not synchronized.\n   * @param serverTimestamp the client timestamp\n   */\n  convertToClientTimestamp(serverTimestamp) {\n    const timestampDiff = this.getConfigParam('timestampDiff');\n    const clientTimestamp = serverTimestamp + timestampDiff;\n    return clientTimestamp;\n  }\n\n  /**\n   * Check if the workgroup is the owner of the run\n   * @param workgroupId the workgroup id\n   * @returns whether the workgroup is the owner of the run\n   */\n  isRunOwner(workgroupId) {\n    if (workgroupId != null) {\n      const teacherUserInfo = this.getTeacherUserInfo();\n      if (teacherUserInfo != null) {\n        if (workgroupId == teacherUserInfo.workgroupId) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Check if the workgroup is a shared teacher for the run\n   * @param workgroupId the workgroup id\n   * @returns whether the workgroup is a shared teacher of the run\n   */\n  isRunSharedTeacher(workgroupId) {\n    if (workgroupId != null) {\n      const sharedTeacherUserInfos = this.getSharedTeacherUserInfos();\n      if (sharedTeacherUserInfos != null) {\n        for (let sharedTeacherUserInfo of sharedTeacherUserInfos) {\n          if (sharedTeacherUserInfo != null) {\n            if (workgroupId == sharedTeacherUserInfo.workgroupId) {\n              return true;\n            }\n          }\n        }\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Get the teacher role for the run\n   * @param workgroupId the workgroup id\n   * @returns the role of the teacher for the run. the possible values are\n   * 'owner', 'write', 'read'\n   */\n  getTeacherRole(workgroupId) {\n    if (this.isRunOwner(workgroupId)) {\n      return 'owner';\n    } else if (this.isRunSharedTeacher(workgroupId)) {\n      return this.getSharedTeacherRole(workgroupId);\n    }\n    return null;\n  }\n\n  /**\n   * Get the shared teacher role for the run\n   * @param workgroupId the workgroup id\n   * @returns the shared teacher role for the run. the possible values are\n   * 'write' or 'read'\n   */\n  getSharedTeacherRole(workgroupId) {\n    if (workgroupId != null) {\n      const sharedTeacherUserInfos = this.getSharedTeacherUserInfos();\n      if (sharedTeacherUserInfos != null) {\n        for (let sharedTeacherUserInfo of sharedTeacherUserInfos) {\n          if (sharedTeacherUserInfo != null) {\n            if (workgroupId == sharedTeacherUserInfo.workgroupId) {\n              return sharedTeacherUserInfo.role;\n            }\n          }\n        }\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Replace student names in the content.\n   * For example, we will replace instances of {{firstStudentFirstName}}\n   * with the actual first name of the first student in the workgroup.\n   * @param content a content object or string\n   * @return an updated content object or string\n   */\n  replaceStudentNames(content) {\n    if (content != null) {\n      let contentString = content;\n      if (typeof content === 'object') {\n        contentString = JSON.stringify(content);\n      }\n      if (contentString != null) {\n        const workgroupId = this.getWorkgroupId();\n        const firstNames = this.getStudentFirstNamesByWorkgroupId(workgroupId);\n\n        if (firstNames.length >= 1) {\n          /*\n           * there are 1 or more students in the workgroup so we can\n           * replace the first student first name with the actual\n           * name\n           */\n          contentString = contentString.replace(new RegExp('{{firstStudentFirstName}}', 'gi'), firstNames[0]);\n\n          /*\n           * there are 1 or more students in the workgroup so we can\n           * replace the student first names with the actual names\n           */\n          contentString = contentString.replace(new RegExp('{{studentFirstNames}}', 'gi'), firstNames.join(\", \"));\n        }\n\n        if (firstNames.length >= 2) {\n          /*\n           * there are 2 or more students in the workgroup so we can\n           * replace the second student first name with the actual\n           * name\n           */\n          contentString = contentString.replace(new RegExp('{{secondStudentFirstName}}', 'gi'), firstNames[1]);\n        }\n\n        if (firstNames.length >= 3) {\n          /*\n           * there are 3 or more students in the workgroup so we can\n           * replace the third student first name with the actual\n           * name\n           */\n          contentString = contentString.replace(new RegExp('{{thirdStudentFirstName}}', 'gi'), firstNames[2]);\n        }\n      }\n\n      if (typeof content === 'object') {\n        // convert the content string back into an object\n        content = JSON.parse(contentString);\n      } else if (typeof content === 'string') {\n        // the content was a string so we can just use the content string\n        content = contentString;\n      }\n    }\n    return content;\n  }\n\n  getAvatarColorForWorkgroupId(workgroupId) {\n    const avatarColors = ['#E91E63', '#9C27B0', '#CDDC39', '#2196F3', '#FDD835', '#43A047', '#795548', '#EF6C00', '#C62828', '#607D8B'];\n    const modulo = workgroupId % 10;\n    return avatarColors[modulo];\n  }\n\n  /**\n   * Get the library projects\n   */\n  getLibraryProjects() {\n    const getLibraryProjectsURL = this.getConfigParam('getLibraryProjectsURL');\n\n    if (getLibraryProjectsURL != null) {\n      // request the list of library projects\n      return this.$http.get(getLibraryProjectsURL).then((result) => {\n        const data = result.data;\n        if (data != null) {\n          // reverse the list so that it is ordered newest to oldest\n          data.reverse();\n        }\n        return data;\n      });\n    }\n  }\n\n  /**\n   * Get the project assets folder path\n   * @param includeHost whether to include the host in the URL\n   * @return the project assets folder path\n   * e.g.\n   * with host\n   * http://wise.berkeley.edu/wise/curriculum/3/assets\n   * without host\n   * /wise/curriculum/3/assets\n   */\n  getProjectAssetsDirectoryPath(includeHost) {\n    const projectBaseURL = this.getConfigParam('projectBaseURL');\n    if (projectBaseURL != null) {\n      if (includeHost) {\n        const host = window.location.origin;\n\n        /*\n         * get the full path including the host\n         * e.g. http://wise.berkeley.edu/wise/curriculum/3/assets\n         */\n        return host + projectBaseURL + 'assets';\n      } else {\n        /*\n         * get the full path not including the host\n         * e.g. /wise/curriculum/3/assets\n         */\n        return projectBaseURL + 'assets';\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Remove the absolute asset paths\n   * e.g.\n   * <img src='https://wise.berkeley.edu/curriculum/3/assets/sun.png'/>\n   * will be changed to\n   * <img src='sun.png'/>\n   * @param html the html\n   * @return the modified html without the absolute asset paths\n   */\n  removeAbsoluteAssetPaths(html) {\n    /*\n     * get the assets directory path with the host\n     * e.g.\n     * https://wise.berkeley.edu/wise/curriculum/3/assets/\n     */\n    const includeHost = true;\n    const assetsDirectoryPathIncludingHost = this.getProjectAssetsDirectoryPath(includeHost);\n    const assetsDirectoryPathIncludingHostRegEx = new RegExp(assetsDirectoryPathIncludingHost, 'g');\n\n    /*\n     * get the assets directory path without the host\n     * e.g.\n     * /wise/curriculum/3/assets/\n     */\n    const assetsDirectoryPathNotIncludingHost = this.getProjectAssetsDirectoryPath() + '/';\n    const assetsDirectoryPathNotIncludingHostRegEx = new RegExp(assetsDirectoryPathNotIncludingHost, 'g');\n\n    /*\n     * remove the directory path from the html so that only the file name\n     * remains in asset references\n     * e.g.\n     * <img src='https://wise.berkeley.edu/wise/curriculum/3/assets/sun.png'/>\n     * will be changed to\n     * <img src='sun.png'/>\n     */\n    html = html.replace(assetsDirectoryPathIncludingHostRegEx, '');\n    html = html.replace(assetsDirectoryPathNotIncludingHostRegEx, '');\n    return html\n  }\n\n  /**\n   * Get the WISE IDs for a workgroup\n   * @param workgroupId get the WISE IDs for this workgroup\n   * @return an array of WISE IDs\n   */\n  getWISEIds(workgroupId) {\n    if (workgroupId != null) {\n      const userInfo = this.getUserInfoByWorkgroupId(workgroupId);\n      if (userInfo != null) {\n        return userInfo.userIds;\n      }\n    }\n    return [];\n  }\n\n  /**\n   * Get all the authorable projects\n   */\n  getAuthorableProjects() {\n    const ownedProjects = this.getConfigParam('projects');\n    const sharedProjects = this.getConfigParam('sharedProjects');\n    let authorableProjects = [];\n    if (ownedProjects != null) {\n      authorableProjects = authorableProjects.concat(ownedProjects);\n    }\n\n    if (sharedProjects != null) {\n      authorableProjects = authorableProjects.concat(sharedProjects);\n    }\n\n    // sort the projects by descending id\n    authorableProjects.sort(this.sortByProjectId);\n    return authorableProjects;\n  }\n\n  /**\n   * Determines whether the current user is logged in as somebody else\n   * @return true iff the user is a switched user\n   */\n  isSwitchedUser() {\n    let myUserInfo = this.getMyUserInfo();\n    if (myUserInfo != null) {\n      if (myUserInfo.isSwitchedUser) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Sort the objects by descending id.\n   * @param projectA an object with an id field\n   * @param projectB an object with an id field\n   * @return 1 if projectA comes before projectB\n   * -1 if projectA comes after projectB\n   * 0 if they are the same\n   */\n  sortByProjectId(projectA, projectB) {\n    const projectIdA = projectA.id;\n    const projectIdB = projectB.id;\n    if (projectIdA < projectIdB) {\n      return 1;\n    } else if (projectIdA > projectIdB) {\n      return -1;\n    } else {\n      return 0;\n    }\n  }\n}\n\nConfigService.$inject = [\n  '$filter',\n  '$http',\n  '$location'\n];\n\nexport default ConfigService;\n"]}