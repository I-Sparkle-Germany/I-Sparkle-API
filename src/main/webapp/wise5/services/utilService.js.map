{"version":3,"sources":["utilService.es6"],"names":[],"mappings":"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","file":"utilService.js","sourcesContent":["'use strict';\n\nclass UtilService {\n\n    constructor() {\n    }\n\n    /**\n     * Generates and returns a random key of the given length if\n     * specified. If length is not specified, returns a key 10\n     * characters in length.\n     */\n    generateKey(length) {\n        this.CHARS = [\"a\",\"b\",\"c\",\"d\",\"e\",\"f\",\"g\",\"h\",\"i\",\"j\",\"k\",\"l\",\"m\",\"n\",\"o\",\"p\",\"q\",\"r\", \"s\",\"t\",\n            \"u\",\"v\",\"w\",\"x\",\"y\",\"z\",\"0\",\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\"];\n\n        /* set default length if not specified */\n        if (!length) {\n            length = 10;\n        }\n\n        /* generate the key */\n        var key = '';\n        for (var a = 0; a < length; a++) {\n            key += this.CHARS[Math.floor(Math.random() * (this.CHARS.length - 1))];\n        }\n\n        /* return the generated key */\n        // TODO: check that the new key is unique\n        return key;\n    };\n\n    /**\n     * Try to convert a string to a number\n     * @param str the string to convert\n     * @returns a number if we were able to convert the string to a number.\n     * if we couldn't convert the string to a number we will just return the string.\n     */\n    convertStringToNumber(str) {\n        var result = str;\n\n        if (str != null && str != '' && !isNaN(Number(str))) {\n            result = Number(str);\n        }\n\n        return result;\n    };\n\n    /**\n     * Create a copy of a JSON object\n     * @param jsonObject the JSON object to get a copy of\n     * @return a copy of the JSON object that was passed in\n     */\n    makeCopyOfJSONObject(jsonObject) {\n        var copyOfJSONObject = null;\n\n        if (jsonObject != null) {\n            // create a JSON string from the JSON object\n            var jsonObjectString = angular.toJson(jsonObject);\n\n            // create a JSON object from the JSON string\n            copyOfJSONObject = angular.fromJson(jsonObjectString);\n        }\n\n        return copyOfJSONObject;\n    };\n    \n    /**\n     * Get the image object\n     * @params img_b64 the base64 image string\n     * @returns an image object\n     */\n    getImageObjectFromBase64String(img_b64) {\n        \n        // create a blob from the base64 image string\n        var blob = this.dataURItoBlob(img_b64);\n        \n        var now = new Date().getTime();\n        var filename = encodeURIComponent('picture_' + now + '.png');\n        var pngFile = new File([blob], filename, {\n            lastModified: now, // optional - default = now\n            type: 'image/png' // optional - default = ''\n        });\n        \n        return pngFile;\n    }\n    \n    /**\n     * Convert base64/URLEncoded data component to raw binary data held in a string\n     * @param dataURI base64/URLEncoded data\n     * @returns a Blob object\n     */\n    dataURItoBlob(dataURI) {\n        \n        var byteString;\n        if (dataURI.split(',')[0].indexOf('base64') >= 0)\n            byteString = atob(dataURI.split(',')[1]);\n        else\n            byteString = unescape(dataURI.split(',')[1]);\n\n        // separate out the mime component\n        var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];\n\n        // write the bytes of the string to a typed array\n        var ia = new Uint8Array(byteString.length);\n        for (var i = 0; i < byteString.length; i++) {\n            ia[i] = byteString.charCodeAt(i);\n        }\n\n        return new Blob([ia], {type:mimeString});\n    };\n    \n    /**\n     * Get an image object from an image element\n     * @param imageElement an image element (<img src='abc.jpg'/>)\n     * @returns an image object\n     */\n    getImageObjectFromImageElement(imageElement) {\n        \n        var imageObject = null;\n        \n        if (imageElement != null) {\n            // create a canvas element that we will use to generate a base64 string\n            var canvas = document.createElement(\"canvas\");\n            \n            // set the width and height of the canvas to match the image dimensions\n            canvas.width = imageElement.naturalWidth;\n            canvas.height = imageElement.naturalHeight;\n            \n            // draw the image onto the canvas\n            var ctx = canvas.getContext(\"2d\");\n            ctx.drawImage(imageElement, 0, 0);\n\n            // create the base64 string representation of the image\n            var dataURL = canvas.toDataURL(\"image/png\");\n\n            // get the image object\n            imageObject = this.getImageObjectFromBase64String(dataURL);\n        }\n        \n        return imageObject;\n    }\n    \n    /**\n     * Hide all the iframes. This is used before a student snips something\n     * to put into their notebook. Iframes shift the position of elements\n     * below it which causes issues when html2canvas tries to capture\n     * certain elements.\n     */\n    hideIFrames() {\n        \n        // get all the iframes\n        var iframes = angular.element('iframe');\n        \n        // loop through all the iframes\n        for (var i = 0; i < iframes.length; i++) {\n            var iframe = iframes[i];\n            \n            if (iframe != null) {\n                // hide the iframe\n                iframe.style.display = 'none';\n            }\n        }\n    }\n    \n    /**\n     * Show all the iframes. This is used after the student snips something\n     * to put into their notebook. Iframes shift the position of elements\n     * below it which causes issues when html2canvas tries to capture\n     * certain elements.\n     */\n    showIFrames() {\n        \n        // get all the iframes\n        var iframes = angular.element('iframe');\n        \n        // loop through all the iframes\n        for (var i = 0; i < iframes.length; i++) {\n            var iframe = iframes[i];\n            \n            if (iframe != null) {\n                // show the iframe\n                iframe.style.display = '';\n            }\n        }\n    }\n}\n\n// Get the last element of the array\nif (!Array.prototype.last) {\n    Array.prototype.last = function() {\n        return this[this.length - 1];\n    };\n};\n\nUtilService.$inject = [];\n\nexport default UtilService;\n"]}