{"version":3,"sources":["authoringTool.spec.es6"],"names":["describe","hasClass","element","cls","getAttribute","then","classes","split","indexOf","waitForUrlToChangeTo","urlRegex","currentUrl","browser","getCurrentUrl","storeCurrentUrl","url","wait","compareCurrentUrl","test","projectStructureButton","by","xpath","createNewStepButton","$","createNewProjectButton","it","ignoreSynchronization","get","expect","getTitle","toEqual","sendKeys","click","refresh","RegExp","isPresent","toBeTruthy","createProjectButton","cancelCreateProjectButton","clear","toMatch","cssContainingText","isDisplayed","all","repeater","nodeItem","getText","toBe","isEnabled","toBeFalsy","className","insertInsideAct1Button","EC","protractor","ExpectedConditions","alertIsPresent","switchTo","alert","accept","insertAfterStep1Button","enableNotebookCheckbox","metadataField","titleInput","model","summaryTextarea","projectTitle","css","getAllWindowHandles","handles","window","toContain","driver","close"],"mappings":"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","file":"authoringTool.spec.js","sourcesContent":["// E2E test for Authoring Tool\ndescribe('WISE Authoring Tool', () => {\n\n    function hasClass(element, cls) {\n        return element.getAttribute('class').then((classes) => {\n            return classes.split(' ').indexOf(cls) !== -1;\n        });\n    }\n\n    /**\n     * @name waitForUrlToChangeTo\n     * @description Wait until the URL changes to match a provided regex\n     * @param {RegExp} urlRegex wait until the URL changes to match this regex\n     * @returns {!webdriver.promise.Promise} Promise\n     */\n    function waitForUrlToChangeTo(urlRegex) {\n        let currentUrl;\n\n        return browser.getCurrentUrl().then(function storeCurrentUrl(url) {\n                currentUrl = url;\n            }\n        ).then(function waitForUrlToChangeTo() {\n                return browser.wait(function waitForUrlToChangeTo() {\n                    return browser.getCurrentUrl().then(function compareCurrentUrl(url) {\n                        return urlRegex.test(url);\n                    });\n                });\n            }\n        );\n    }\n\n    let projectStructureButton = element(by.xpath('//side-menu/div/a[@aria-label=\"Project Structure\"]'));\n    let createNewStepButton = $(\"#createNewStepButton\");\n    let createNewProjectButton = $('#createNewProjectButton');\n\n    it('should require user to log in to use the authoring tool', () => {\n        browser.ignoreSynchronization = true;  // doesn't use Angular\n        browser.get('http://localhost:8080/wise/login');\n\n        expect(browser.getTitle()).toEqual('Sign In');\n    });\n\n    it('should log in using preview username and password and open the authoring tool', () => {\n        browser.ignoreSynchronization = true;  // doesn't use Angular\n        $('#username').sendKeys('preview');\n        $('#password').sendKeys('wise');\n        $('#signInButton').click();\n\n        browser.ignoreSynchronization = false;  // uses Angular\n        browser.get('http://localhost:8080/wise/author');\n        browser.refresh();  // needed for this issue https://github.com/angular/protractor/issues/2643\n        waitForUrlToChangeTo(new RegExp('http://localhost:8080/wise/author#/', 'gi'));\n\n        // check that the create new project button is displayed\n        expect(browser.getTitle()).toEqual('WISE Authoring Tool');\n        expect(browser.getCurrentUrl()).toEqual('http://localhost:8080/wise/author#/');\n        expect(createNewProjectButton.isPresent()).toBeTruthy();\n    });\n\n    it('should create a new project and open it', () => {\n        createNewProjectButton.click();  // click button to create a new project\n        expect(browser.getCurrentUrl()).toEqual('http://localhost:8080/wise/author#/new');\n        let createProjectButton = $('#createProjectButton');\n        expect(createProjectButton.isPresent()).toBeTruthy();\n        let cancelCreateProjectButton = $('#cancelCreateProjectButton');\n        expect(cancelCreateProjectButton.isPresent()).toBeTruthy();\n        cancelCreateProjectButton.click();  // cancel create. We should go back to main authoring page.\n        expect(browser.getCurrentUrl()).toEqual('http://localhost:8080/wise/author#/');\n\n        createNewProjectButton.click();  // click button to create a new project\n        expect(browser.getCurrentUrl()).toEqual('http://localhost:8080/wise/author#/new');\n        $('#newProjectTitle').clear();  // clear out what's there.\n        $('#newProjectTitle').sendKeys('My Science Project');\n        createProjectButton.click();\n        expect(browser.getCurrentUrl()).toMatch('http://localhost:8080/wise/author#/project/[0-9]+');  // should open the project editing view.\n    });\n\n    it('should have elements on the page in project view', () => {\n        expect(element(by.cssContainingText('top-bar',\"My Science Project\")).isDisplayed()).toBeTruthy();\n\n        element.all(by.repeater(\"item in projectController.items\")).then((nodeItem) => {\n            expect(nodeItem[1].getText()).toBe(\"1 First Activity\");  // should have one default activity\n        });\n\n        // check that move, delete buttons are disabled and other buttons are enabled.\n        expect($(\"#moveButton\").isEnabled()).toBe(false);\n        expect($(\"#copyButton\").isEnabled()).toBe(false);\n        expect($(\"#deleteButton\").isEnabled()).toBe(false);\n        expect($(\"#saveProjectButton\").isEnabled()).toBe(true);\n        expect($(\"#createNewActivityButton\").isEnabled()).toBe(true);\n        expect(createNewStepButton.isEnabled()).toBe(true);\n        expect($(\"#previewProjectButton\").isEnabled()).toBe(true);\n        // look for side-menu items\n        expect(projectStructureButton.isDisplayed()).toBe(true);\n        expect(element(by.xpath('//side-menu/div/a[@aria-label=\"Notebook Settings\"]')).isDisplayed()).toBe(true);\n        expect(element(by.xpath('//side-menu/div/a[@aria-label=\"File Manager\"]')).isDisplayed()).toBe(true);\n        expect(element(by.xpath('//side-menu/div/a[@aria-label=\"Project Info\"]')).isDisplayed()).toBe(true);\n    });\n\n    it('should create new steps', () => {\n        // test adding a new step to an empty project\n        createNewStepButton.click();\n        expect($(\"#createNodeTitle\").isDisplayed()).toBeTruthy();\n        expect($(\"#createNodeCreateButton\").isDisplayed()).toBeTruthy();\n        expect($(\"#createNodeCancelButton\").isDisplayed()).toBeTruthy();\n        // clicking on cancel should hide the create node input and buttons\n        $(\"#createNodeCancelButton\").click();\n        expect($(\"#createNodeTitle\").isDisplayed()).toBeFalsy();\n        expect($(\"#createNodeCreateButton\").isDisplayed()).toBeFalsy();\n        expect($(\"#createNodeCancelButton\").isDisplayed()).toBeFalsy();\n\n        createNewStepButton.click();\n        $('#createNodeTitle').clear();  // clear out what's there.\n        $('#createNodeTitle').sendKeys('Step 1');\n        $(\"#createNodeCreateButton\").click();\n\n        element.all(by.repeater(\"item in projectController.items\")).then((nodeItem) => {\n            expect(nodeItem[1].element(by.className('groupHeader')).getText()).toBe(\"1 First Activity\");\n            let insertInsideAct1Button = nodeItem[1].element(by.cssContainingText('button','Insert Inside'));\n            expect(insertInsideAct1Button.isDisplayed()).toBeTruthy();\n            insertInsideAct1Button.click();\n            let EC = protractor.ExpectedConditions;\n            browser.wait(EC.alertIsPresent(), 5000);  // Wait for an alert pops up asking if it should this should be the first step in the project.\n            browser.switchTo().alert().accept();   // accept the alert\n        });\n\n        element.all(by.repeater(\"item in projectController.items\")).then((nodeItem) => {\n            expect(nodeItem[1].element(by.className('groupHeader')).getText()).toBe(\"1 First Activity\");  // should have one default activity\n            expect(nodeItem[2].element(by.className('stepHeader')).getText()).toBe(\"1.1 Step 1\");  // should now have the newly added step\n        });\n\n        // now test adding another step after the first step. This time the alert should not show.\n\n        createNewStepButton.click();\n        $('#createNodeTitle').clear();  // clear out what's there.\n        $('#createNodeTitle').sendKeys('Step 2');\n        $(\"#createNodeCreateButton\").click();\n\n        element.all(by.repeater(\"item in projectController.items\")).then((nodeItem) => {\n            let insertAfterStep1Button = nodeItem[2].element(by.cssContainingText('button','Insert After'));\n            expect(insertAfterStep1Button.isDisplayed()).toBeTruthy();\n            insertAfterStep1Button.click();\n        });\n\n        element.all(by.repeater(\"item in projectController.items\")).then((nodeItem) => {\n            expect(nodeItem[1].element(by.className('groupHeader')).getText()).toBe(\"1 First Activity\");  // should have one default activity\n            expect(nodeItem[2].element(by.className('stepHeader')).getText()).toBe(\"1.1 Step 1\");  // should have step 1\n            expect(nodeItem[3].element(by.className('stepHeader')).getText()).toBe(\"1.2 Step 2\");  // should now have the newly added step\n        });\n    });\n\n    it('should display my assets', () => {\n        element(by.xpath('//side-menu/div/a[@aria-label=\"File Manager\"]')).click();\n        expect(browser.getCurrentUrl()).toMatch('http://localhost:8080/wise/author#/project/[0-9]+/asset');\n        expect($(\".drop-box\").isPresent()).toBeTruthy();  // the drop box for uploading assets should exist.\n        projectStructureButton.click();\n        expect(browser.getCurrentUrl()).toMatch('http://localhost:8080/wise/author#/project/[0-9]+');  // should go back to the project editing view.\n    });\n\n    it('should allow user to edit notebook settings', () => {\n        element(by.xpath('//side-menu/div/a[@aria-label=\"Notebook Settings\"]')).click();\n        expect(browser.getCurrentUrl()).toMatch('http://localhost:8080/wise/author#/project/[0-9]+/notebook');\n        let enableNotebookCheckbox = $(\"#enableNotebookCheckbox\");\n        expect(enableNotebookCheckbox.isPresent()).toBeTruthy();  // the checkbox for enabling/disabling notebook should exist.\n        // TODO: the checkbox should be unchecked by default.\n        $(\"#closeNotebookSettingsButton\").click();\n        expect(browser.getCurrentUrl()).toMatch('http://localhost:8080/wise/author#/project/[0-9]+');  // should go back to the project editing view.\n    });\n\n    it('should allow user to edit project info', () => {\n        // TODO add more tests here\n        element(by.xpath('//side-menu/div/a[@aria-label=\"Project Info\"]')).click();\n        expect(browser.getCurrentUrl()).toMatch('http://localhost:8080/wise/author#/project/[0-9]+/info');\n\n        // check that there are inputs for metadata items\n        element.all(by.repeater(\"metadataField in projectInfoController.metadataAuthoring.fields\")).then((metadataField) => {\n            let titleInput = metadataField[0].element(by.model('projectInfoController.metadata[metadataField.key]'));\n            expect(titleInput.getAttribute('value')).toBe(\"My Science Project\");  // should show the title of the project\n            titleInput.clear();  // clear out what's there.\n            titleInput.sendKeys('My Awesome Science Project');  // change the title to \"My Awesome Science Project\"\n            let summaryTextarea = metadataField[1].element(by.model('projectInfoController.metadata[metadataField.key]'));\n            expect(summaryTextarea.getAttribute('value')).toBe(\"\");  // should show the summary of the project, which is empty to start with\n            summaryTextarea.sendKeys('This is my science project summary.');\n        });\n\n        projectStructureButton.click();\n        expect(browser.getCurrentUrl()).toMatch('http://localhost:8080/wise/author#/project/[0-9]+');  // should go back to the project editing view.\n        let projectTitle = element(by.css('[ng-if=\"$ctrl.projectTitle\"]'));\n        expect(element(by.cssContainingText('top-bar',\"My Awesome Science Project\")).isDisplayed()).toBeTruthy();  // check that the title has been updated\n    });\n\n    it('should allow user to preview the project', () => {\n        // Clicking on the preview project button should open the preview in a new window\n        $(\"#previewProjectButton\").click();\n        browser.getAllWindowHandles().then((handles) => {\n            browser.switchTo().window(handles[1]).then(() => {\n                browser.refresh();  // needed for this issue https://github.com/angular/protractor/issues/2643\n                expect(browser.getCurrentUrl()).toContain('http://localhost:8080/wise/project/');\n                // close the current window\n                browser.driver.close().then(() => {\n                    // switch to the main authoring window\n                    browser.switchTo().window(handles[0]);\n                });\n            });\n        });\n    });\n\n    // TODO: add test for opening newly-created project\n\n    // TODO: add test for copying a project\n\n    // TODO: add test for copying a step\n\n\n    /*\n    it('should exit the authoring tool and then sign out', () => {\n        exitAuthoringToolButton.click();\n\n        browser.ignoreSynchronization = true;  // doesn't use Angular\n        expect(browser.getTitle()).toEqual('WISE Teacher Dashboard');\n        let signOutButton = $(\"#signOut\");\n        expect(signOutButton.isPresent()).toBeTruthy();\n        signOutButton.click();\n        expect(browser.getTitle()).toEqual('Web-based Inquiry Science Environment (WISE)');\n        expect(browser.getCurrentUrl()).toEqual('http://localhost:8080/wise/');\n    });\n    */\n});"]}