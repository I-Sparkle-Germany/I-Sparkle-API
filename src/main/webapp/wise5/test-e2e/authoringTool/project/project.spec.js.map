{"version":3,"sources":["project.spec.es6"],"names":["common","describe","projectId","browser","params","authoringProjectId","beforeAll","page","isAngularSite","get","$","sendKeys","login","user","password","click","beforeEach","refresh","wait","projectTitleSpan","isPresent","it","expect","getText","toEqual","shouldBeDisplayed","projectHomeButton","notebookButton","assetButton","infoButton","projectListButton","createNewActivityButton","createNewStepButton","previewProjectButton","ms","Date","getTime","newActivityTitle","clickCreateNewActivityButton","setCreateGroupTitle","clickCreateGroupCreateButton","clickToInsertActivityAfter","getTitleOfActivity","toBe","newStepTitle","clickCreateNewStepButton","setCreateNodeTitle","clickCreateNodeCreateButton","clickToInsertStepInside","getTitleOfStep","clickToInsertStepAfter","clickOnStep","addComponentButton","backToProjectButton","clickStepBackButton","clickOnAStepIntheStepSelectMenu","element","by","cssContainingText","clickAssetButton","clickNotebookButton","clickInfoButton","clickPreviewProjectButton","getAllWindowHandles","then","handles","switchTo","window","getCurrentUrl","toContain","driver","close","clickPreviewProjectWithoutConstraintsButton","clickGoHomeButton","toMatch"],"mappings":"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","file":"project.spec.js","sourcesContent":["import * as common from '../../common.js';\nimport ProjectPage from './project.page.js';\n\n/*\n * E2E tests for the project view in the Authoring Tool\n */\ndescribe('WISE Authoring Tool Project View', () => {\n\n  const projectId = browser.params.authoringProjectId;\n\n  beforeAll(() => {\n    const page = new ProjectPage();\n    const params = browser.params;\n    isAngularSite(false);\n    browser.get('http://localhost:8080/wise/login');\n    $('#username').sendKeys(params.login.user);\n    $('#password').sendKeys(params.login.password);\n    $('#signInButton').click();\n  });\n\n  beforeEach(() => {\n    const page = new ProjectPage();\n    isAngularSite(true);\n    browser.get('http://localhost:8080/wise/author#/project/' + projectId);\n    browser.refresh();  // needed for this issue https://github.com/angular/protractor/issues/2643\n    browser.wait(() => {\n      return page.projectTitleSpan.isPresent()\n    }, 5000, 'Authoring Tool didn\\'t load properly');\n  });\n\n  it('should have elements on the page in the project view', () => {\n    const page = new ProjectPage();\n    expect(page.projectTitleSpan.getText()).toEqual('My Science Project');\n    common.shouldBeDisplayed(page.projectHomeButton);\n    common.shouldBeDisplayed(page.notebookButton);\n    common.shouldBeDisplayed(page.assetButton);\n    common.shouldBeDisplayed(page.infoButton);\n    common.shouldBeDisplayed(page.projectListButton);\n    common.shouldBeDisplayed(page.createNewActivityButton);\n    common.shouldBeDisplayed(page.createNewStepButton);\n    common.shouldBeDisplayed(page.previewProjectButton);\n  });\n\n  it('should create a new activity', () => {\n    const page = new ProjectPage();\n    const ms = new Date().getTime();\n    const newActivityTitle = 'Activity 1 ' + ms;\n    common.shouldBeDisplayed(page.createNewActivityButton);\n    page.clickCreateNewActivityButton();\n    page.setCreateGroupTitle('Activity 1 ' + ms);\n    page.clickCreateGroupCreateButton();\n    page.clickToInsertActivityAfter(0);\n    expect(page.getTitleOfActivity(1)).toBe('1: ' + newActivityTitle);\n  });\n\n  it('should create a new step as the first step in the first activity', () => {\n    const page = new ProjectPage();\n    const ms = new Date().getTime();\n    const newStepTitle = 'Step 1 ' + ms;\n    common.shouldBeDisplayed(page.createNewStepButton);\n    page.clickCreateNewStepButton();\n    page.setCreateNodeTitle(newStepTitle);\n    page.clickCreateNodeCreateButton();\n    page.clickToInsertStepInside(1);\n    expect(page.getTitleOfStep(1, 0)).toBe('1.1: ' + newStepTitle);\n  });\n\n  it('should create a new step as the second step in the first activity', () => {\n    const page = new ProjectPage();\n    const ms = new Date().getTime();\n    const newStepTitle = 'Step 2 ' + ms;\n    common.shouldBeDisplayed(page.createNewStepButton);\n    page.clickCreateNewStepButton();\n    page.setCreateNodeTitle(newStepTitle);\n    page.clickCreateNodeCreateButton();\n    page.clickToInsertStepAfter(1, 1);\n    expect(page.getTitleOfStep(1, 1)).toBe('1.2: ' + newStepTitle);\n  });\n\n  it('should open a step', () => {\n    const page = new ProjectPage();\n    page.clickOnStep(1, 1);\n    common.shouldBeDisplayed(page.addComponentButton);\n    common.shouldBeDisplayed(page.backToProjectButton);\n  });\n\n  it('should open a step and then go back to the project view', () => {\n    const page = new ProjectPage();\n    page.clickOnStep(1, 1);\n    common.shouldBeDisplayed(page.addComponentButton);\n    common.shouldBeDisplayed(page.backToProjectButton);\n    page.clickStepBackButton();\n  });\n\n  it('should allow author to jump to step authoring using the navigation drop-down menu', () => {\n    const page = new ProjectPage();\n    page.clickOnAStepIntheStepSelectMenu(1, 2);\n    common.shouldBeDisplayed(element(by.cssContainingText('h6', 'Step Title 1.2:')));\n  });\n\n  it('should display my assets', () => {\n    const page = new ProjectPage();\n    page.clickAssetButton();\n    common.shouldBeDisplayed(element(by.cssContainingText('span', 'File Manager')));\n  });\n\n  it('should display notebook settings', () => {\n    const page = new ProjectPage();\n    page.clickNotebookButton();\n    common.shouldBeDisplayed(element(by.cssContainingText('span', 'Notebook Settings')));\n  });\n\n  it('should display info settings', () => {\n    const page = new ProjectPage();\n    page.clickInfoButton();\n    common.shouldBeDisplayed(element(by.cssContainingText('span', 'Project Info')));\n  });\n\n  it('should allow user to preview the project', () => {\n    const page = new ProjectPage();\n    page.clickPreviewProjectButton();\n    // Clicking on the preview project button should open the preview in a new window\n    browser.getAllWindowHandles().then((handles) => {\n      browser.switchTo().window(handles[1]).then(() => {\n        browser.refresh();  // needed for this issue https://github.com/angular/protractor/issues/2643\n        expect(browser.getCurrentUrl()).toContain('http://localhost:8080/wise/project/' + projectId + '#/vle/');\n        // close the current window\n        browser.driver.close().then(() => {\n          // switch to the main authoring window\n          browser.switchTo().window(handles[0]);\n        });\n      });\n    });\n  });\n\n  it('should allow user to preview the project without constraints', () => {\n    const page = new ProjectPage();\n    page.clickPreviewProjectWithoutConstraintsButton();\n    // Clicking on the preview project button should open the preview in a new window\n    browser.getAllWindowHandles().then((handles) => {\n      browser.switchTo().window(handles[1]).then(() => {\n        browser.refresh();  // needed for this issue https://github.com/angular/protractor/issues/2643\n        expect(browser.getCurrentUrl()).toContain('http://localhost:8080/wise/project/' + projectId + '?constraints=false#/vle/');\n        // close the current window\n        browser.driver.close().then(() => {\n          // switch to the main authoring window\n          browser.switchTo().window(handles[0]);\n        });\n      });\n    });\n  });\n\n  it('should exit the authoring tool from project listing view and go to teacher home', () => {\n    const page = new ProjectPage();\n    page.clickGoHomeButton();\n    isAngularSite(false);\n    expect(browser.getCurrentUrl()).toMatch(/.*\\/wise\\//);\n   });\n\n  // TODO: add test for copying a step\n\n});\n"]}