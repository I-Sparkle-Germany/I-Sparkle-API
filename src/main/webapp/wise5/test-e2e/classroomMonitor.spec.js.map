{"version":3,"sources":["classroomMonitor.spec.es6"],"names":["describe","hasClass","element","cls","getAttribute","then","classes","split","indexOf","waitForUrlToChangeTo","urlRegex","currentUrl","browser","getCurrentUrl","storeCurrentUrl","url","wait","compareCurrentUrl","test","it","ignoreSynchronization","get","expect","getTitle","toEqual","$","sendKeys","click","classroomMonitorLink","isPresent","toBeTruthy","getAllWindowHandles","handles","switchTo","window","refresh","waitForAngular","toMatch","by","xpath","notificationButton","notificationMenu","cssContainingText","accountButton","filterByWorkgroup","periodFilter","all","repeater","groupNavItems","activity1","className","getText","toBe","driver","close","signOutButton"],"mappings":"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","file":"classroomMonitor.spec.js","sourcesContent":["// E2E test for Classroom Monitor\ndescribe('WISE Classroom Monitor', () => {\n\n    function hasClass(element, cls) {\n        return element.getAttribute('class').then((classes) => {\n            return classes.split(' ').indexOf(cls) !== -1;\n        });\n    };\n\n    /**\n     * @name waitForUrlToChangeTo\n     * @description Wait until the URL changes to match a provided regex\n     * @param {RegExp} urlRegex wait until the URL changes to match this regex\n     * @returns {!webdriver.promise.Promise} Promise\n     */\n    function waitForUrlToChangeTo(urlRegex) {\n        var currentUrl;\n\n        return browser.getCurrentUrl().then(function storeCurrentUrl(url) {\n                currentUrl = url;\n            }\n        ).then(function waitForUrlToChangeTo() {\n                return browser.wait(function waitForUrlToChangeTo() {\n                    return browser.getCurrentUrl().then(function compareCurrentUrl(url) {\n                        return urlRegex.test(url);\n                    });\n                });\n            }\n        );\n    }\n\n    it('should log in using preview username and password and open the classroom monitor tool', () => {\n        browser.ignoreSynchronization = true;  // doesn't use Angular\n        browser.get('http://localhost:8080/wise/login');\n        expect(browser.getTitle()).toEqual('Sign In');\n        $('#username').sendKeys('preview');\n        $('#password').sendKeys('wise');\n        $('#signInButton').click();\n\n        expect(browser.getCurrentUrl()).toEqual('http://localhost:8080/wise/teacher');\n        expect(browser.getTitle()).toEqual('WISE Teacher Dashboard');\n        // Find and click on the classroom monitor link\n        let classroomMonitorLink = $(\".classroomMonitor\");\n        expect(classroomMonitorLink.isPresent()).toBeTruthy();\n        classroomMonitorLink.click();\n\n        // Clicking on the classroom monitor link should open the classroom monitor in a new window\n        browser.getAllWindowHandles().then((handles) => {\n            browser.switchTo().window(handles[1]).then(() => {\n                browser.ignoreSynchronization = false;  // uses Angular\n                browser.refresh();  // needed for this issue https://github.com/angular/protractor/issues/2643\n                browser.waitForAngular();   // wait for Angular to load\n                expect(browser.getCurrentUrl()).toMatch('http://localhost:8080/wise/classroomMonitor/[0-9]+#/project/');\n                expect(browser.getTitle()).toEqual('WISE Classroom Monitor');\n\n                // check for elements on the page\n                expect(element(by.xpath('//button[@aria-label=\"Classroom Monitor menu\"]')).isPresent()).toBeTruthy();\n                expect(element(by.xpath('//a[@aria-label=\"Grading & Feedback\"]')).isPresent()).toBeTruthy();\n                expect(element(by.xpath('//a[@aria-label=\"Student Summary\"]')).isPresent()).toBeTruthy();\n                expect(element(by.xpath('//md-switch[@aria-label=\"Lock student screens switch\"]')).isPresent()).toBeTruthy();\n\n                let notificationButton = element(by.xpath('//button[@aria-label=\"View notifications\"]'));\n                let notificationMenu = element(by.cssContainingText('.md-open-menu-container','Alerts'));\n                expect(notificationMenu.getAttribute('aria-hidden')).toEqual(\"true\");  // Notification menu should be hidden\n\n                notificationButton.click();   // Open the Notification Menu by clicking on the notification button\n                expect(notificationMenu.getAttribute('aria-hidden')).toEqual(\"false\");  // Notification Menu should be displayed\n                // Clicking outside of the Notification Menu should dismiss the Notification Menu\n                element(by.xpath('//body')).click();\n                expect(notificationMenu.getAttribute('aria-hidden')).toEqual(\"true\");  // Notification menu should be hidden\n\n                let accountButton = element(by.xpath('//button[@aria-label=\"Open user menu\"]'));\n                expect(accountButton.isPresent()).toBeTruthy();\n\n                let filterByWorkgroup = element(by.xpath('//workgroup-select'));\n                expect(filterByWorkgroup.isPresent()).toBeTruthy(); // make sure filter by workgroup input is present\n\n                let periodFilter = element(by.xpath('//period-select'));\n                expect(periodFilter.isPresent()).toBeTruthy(); // make sure filter by workgroup input is present\n\n                // test that the project map is displayed\n                element.all(by.repeater('id in nodeProgressController.rootNode.ids')).then((groupNavItems) => {\n                    let activity1 = groupNavItems[0];\n\n                    expect(activity1.element(by.className('md-title')).getText()).toEqual('1: First Activity');\n\n                    // Activity 1 should not be expanded yet, so expand it\n                    activity1.click();\n                    expect(hasClass(activity1, 'expanded')).toBe(true);\n                });\n\n                // close the current window\n                browser.driver.close().then(() => {\n                    // switch to the main authoring window\n                    browser.switchTo().window(handles[0]);\n                });\n            });\n        });\n\n        browser.ignoreSynchronization = true;  // doesn't use Angular\n        expect(browser.getTitle()).toEqual('WISE Teacher Dashboard');\n        var signOutButton = $(\"#signOut\");\n        expect(signOutButton.isPresent()).toBeTruthy();\n        signOutButton.click();\n        expect(browser.getTitle()).toEqual('Web-based Inquiry Science Environment (WISE)');\n        expect(browser.getCurrentUrl()).toEqual('http://localhost:8080/wise/');\n    });\n});"]}