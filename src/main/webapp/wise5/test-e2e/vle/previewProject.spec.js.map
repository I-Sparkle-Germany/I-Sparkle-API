{"version":3,"sources":["previewProject.spec.es6"],"names":["common","describe","clickOnPageBody","by","xpath","click","beforeEach","vle","get","wait","nodeDropDownMenu","isPresent","then","expect","getTitle","toEqual","it","nodeSelectMenuShouldSay","shouldBePresent","prevButton","nextButton","closeNodeButton","accountButton","accountMenu","notificationButton","notificationMenu","shouldBeHidden","nodeContent","cssContainingText","shouldBeEnabled","shouldBeDisabled","goToNextStep","urlShouldBe","goToPreviousStep","openDropDownMenu","all","repeater","stepSelectOptions","element","css","getText","toBe","closeNode","groupNavItems","activity1","activity2","className","hasClass","stepNavItems","toBeTruthy","toBeFalsy","tagName","openAccountMenu","shouldBeDisplayed","workgroupNames","exitButton","logOutButton","actions","sendKeys","protractor","Key","ESCAPE","perform","openNotificationMenu","notificationDialogTitle","isDisplayed","notificationDialogContent"],"mappings":"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","file":"previewProject.spec.js","sourcesContent":["import {browser, element} from 'protractor';\nimport * as common from '../common.js';\nimport VLEPage from '../vlePage.js';\n\ndescribe('WISE5 Student VLE Preview', () => {\n\n  function clickOnPageBody() {\n    element(by.xpath('//body')).click();\n  }\n\n  beforeEach(() => {\n    const vle = new VLEPage();\n    browser.get('http://localhost:8080/wise/project/demo#/vle/node1');\n    browser.wait(function() {\n      return vle.nodeDropDownMenu.isPresent()\n    }, 5000, 'VLE didn\\'t load properly').then(() => {\n      expect(browser.getTitle()).toEqual('WISE');\n    });\n  });\n\n  it('should show first step and default UI elements on the page', () => {\n    const vle = new VLEPage();\n    vle.nodeSelectMenuShouldSay('1.1: HTML Step');\n    common.shouldBePresent([vle.prevButton, vle.nextButton, vle.closeNodeButton,\n      vle.accountButton, vle.accountMenu, vle.notificationButton, vle.notificationMenu]);\n    common.shouldBeHidden([vle.accountMenu, vle.notificationMenu]);\n    const nodeContent = element(by.cssContainingText('.node-content','This is a step where authors can enter their own html.'));\n    common.shouldBePresent([nodeContent]);\n    common.shouldBeEnabled([vle.nextButton]);\n    common.shouldBeDisabled([vle.prevButton]);\n  });\n\n  it('should navigate next and previous steps using the buttons', () => {\n    const vle = new VLEPage();\n    vle.goToNextStep();\n    common.urlShouldBe('http://localhost:8080/wise/project/demo#/vle/node2');\n    vle.nodeSelectMenuShouldSay('1.2: Open Response Step');\n    common.shouldBeEnabled([vle.prevButton, vle.nextButton]);\n    let nodeContent = element(by.cssContainingText('.node-content','This is a step where students enter text.'));\n    common.shouldBePresent([nodeContent]);\n\n    vle.goToNextStep();\n    common.urlShouldBe('http://localhost:8080/wise/project/demo#/vle/node3');\n    vle.nodeSelectMenuShouldSay('1.3: Open Response Step Auto Graded');\n    nodeContent = element(by.cssContainingText('.node-content','Explain how the sun helps animals survive.'));\n    common.shouldBePresent([nodeContent]);\n\n    vle.goToPreviousStep();\n    common.urlShouldBe('http://localhost:8080/wise/project/demo#/vle/node2');\n    vle.nodeSelectMenuShouldSay('1.2: Open Response Step');\n  });\n\n  it('should allow user to jump to a step using the navigation drop-down menu', () => {\n    const vle = new VLEPage();\n    vle.openDropDownMenu();\n    element.all(by.repeater(\"item in stepToolsCtrl.idToOrder | toArray | orderBy : 'order'\")).then((stepSelectOptions) => {\n      expect(stepSelectOptions[1].element(by.css('.node-select__text')).getText()).toBe(\"1.1: HTML Step\");\n      expect(stepSelectOptions[7].element(by.css('.node-select__text')).getText()).toBe(\"1.7: Challenge Question Step\");\n      stepSelectOptions[7].element(by.css('.node-select__text')).click();\n      common.urlShouldBe('http://localhost:8080/wise/project/demo#/vle/node7');\n    });\n  });\n\n  it('should display the group view and allow user to collapse/expand group navitems', () => {\n    const vle = new VLEPage();\n    vle.closeNode();\n    common.urlShouldBe('http://localhost:8080/wise/project/demo#/vle/group1');\n\n    element.all(by.repeater('id in navCtrl.rootNode.ids')).then((groupNavItems) => {\n      const activity1 = groupNavItems[0];\n      const activity2 = groupNavItems[1];\n\n      expect(activity1.element(by.className('md-title')).getText()).toEqual('1: Example Steps');\n      expect(activity2.element(by.className('md-title')).getText()).toEqual('2: Example Features');\n\n      // activity 1 should be expanded, Activity 2 should be collapsed\n      expect(common.hasClass(activity1, 'expanded')).toBe(true);\n      expect(common.hasClass(activity2, 'expanded')).toBe(false);\n\n      // check for completion icons for steps in Activity 1\n      activity1.all(by.repeater('childId in navitemCtrl.item.ids')).then((stepNavItems) => {\n\n        // step 1.1 should be completed because it's an HTML step and we visited it\n        // (the previous step we were on) should be highlighted because we came from it\n        expect(stepNavItems[0].getText()).toBe('school\\n1.1: HTML Step check_circle');\n        expect(common.hasClass(stepNavItems[0], 'prev')).toBe(true);\n        expect(stepNavItems[0].element(by.cssContainingText('.material-icons', 'check_circle')).isPresent()).toBeTruthy();\n\n        // step 1.2 should not be completed yet\n        expect(stepNavItems[1].getText()).toBe('school\\n1.2: Open Response Step');\n        expect(stepNavItems[1].element(by.cssContainingText('.material-icons', 'check_circle')).isPresent()).toBeFalsy();\n\n        // step 1.7 should not be completed yet\n        expect(stepNavItems[6].getText()).toBe('school\\n1.7: Challenge Question Step');\n        expect(stepNavItems[6].element(by.cssContainingText('.material-icons', 'check_circle')).isPresent()).toBeFalsy();\n      });\n\n      // activity 2 should not be expanded yet, so expand it\n      activity2.element(by.className('nav-item--card__content')).click();\n      expect(common.hasClass(activity2, 'expanded')).toBe(true);\n      expect(common.hasClass(activity1, 'expanded')).toBe(true);\n\n      // check that steps in activity 2 displays the step title and icon\n      activity2.all(by.repeater('childId in navitemCtrl.item.ids')).then((stepNavItems) => {\n        expect(stepNavItems[0].getText()).toBe('school\\n2.1: Show Previous Work 1');\n        expect(stepNavItems[1].getText()).toBe('school\\n2.2: Show Previous Work 2');\n        expect(stepNavItems[2].getText()).toBe('school\\n2.3: Import Work 1');\n        // go to step 2.3.\n        stepNavItems[2].element(by.tagName('button')).click();\n        common.urlShouldBe('http://localhost:8080/wise/project/demo#/vle/node22');\n      });\n    });\n  });\n\n  it('should allow user to jump to a step by changing the URL path', () => {\n    const vle = new VLEPage();\n    // the user changes the URL\n    browser.get('http://localhost:8080/wise/project/demo#/vle/node11');\n    expect(browser.getTitle()).toEqual('WISE');\n    vle.nodeSelectMenuShouldSay('1.11: Draw Step');\n  });\n\n  it('should allow preview user to view the account menu', () => {\n    const vle = new VLEPage();\n    vle.openAccountMenu();\n    common.shouldBeDisplayed([vle.accountMenu]);\n\n    // account menu should have the preview user account icon and the exit and sign out buttons\n    element.all(by.repeater('userName in themeCtrl.workgroupUserNames')).then((workgroupNames) => {\n      expect(workgroupNames[0].getText()).toBe('Preview Team');\n    });\n\n    common.shouldBePresent([vle.exitButton, vle.logOutButton]);\n\n    browser.actions().sendKeys(protractor.Key.ESCAPE).perform();\n    common.shouldBeHidden([vle.accountMenu]);\n\n    vle.openAccountMenu();\n    common.shouldBeDisplayed([vle.accountMenu]);\n\n    clickOnPageBody();\n    common.shouldBeHidden([vle.accountMenu]);\n  });\n\n  it('should allow preview user to view the notification menu', () => {\n    const vle = new VLEPage();\n    vle.openNotificationMenu();\n    common.shouldBeDisplayed([vle.notificationMenu]);\n\n    // notification menu should have the Alerts title and say that there are no alerts.\n    const notificationDialogTitle = element(by.xpath('//md-toolbar/span/span[@translate=\"notificationsTitle\"]'));\n    expect(notificationDialogTitle.isDisplayed()).toBeTruthy();\n    expect(notificationDialogTitle.getText()).toEqual(\"Alerts\");\n\n    const notificationDialogContent = element(by.xpath('//md-content/div/span[@translate=\"noAlerts\"]'));\n    expect(notificationDialogContent.isDisplayed()).toBeTruthy();\n    expect(notificationDialogContent.getText()).toEqual(\"Hi there! You currently have no alerts.\");\n\n    browser.actions().sendKeys(protractor.Key.ESCAPE).perform();\n    common.shouldBeHidden([vle.notificationMenu]);\n\n    vle.openNotificationMenu();\n    common.shouldBeDisplayed([vle.notificationMenu]);\n\n    clickOnPageBody();\n    common.shouldBeHidden([vle.notificationMenu]);\n  });\n});\n"]}