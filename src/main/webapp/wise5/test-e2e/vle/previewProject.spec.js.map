{"version":3,"sources":["previewProject.spec.es6"],"names":["common","describe","clickOnPageBody","by","xpath","click","beforeEach","vle","VLEPage","browser","get","wait","nodeDropDownMenu","isPresent","then","expect","getTitle","toEqual","it","nodeSelectMenuShouldSay","shouldBePresent","prevButton","nextButton","closeNodeButton","accountButton","accountMenu","notificationButton","notificationMenu","shouldBeHidden","nodeContent","cssContainingText","shouldBeEnabled","shouldBeDisabled","goToNextStep","urlShouldBe","goToPreviousStep","openDropDownMenu","element","all","repeater","stepSelectOptions","css","getText","toBe","toggleConstraints","closeNode","groupNavItems","activity1","activity2","className","hasClass","stepNavItems","toBeTruthy","toBeFalsy","tagName","openAccountMenu","shouldBeDisplayed","workgroupNames","exitButton","logOutButton","actions","sendKeys","protractor","Key","ESCAPE","perform","openNotificationMenu","notificationDialogTitle","isDisplayed","notificationDialogContent"],"mappings":"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","file":"previewProject.spec.js","sourcesContent":["import {browser, element} from 'protractor';\nimport * as common from '../common.js';\nimport VLEPage from '../vlePage.js';\n\ndescribe('WISE5 Student VLE Preview', () => {\n\n  function clickOnPageBody() {\n    element(by.xpath('//body')).click();\n  }\n\n  beforeEach(() => {\n    const vle = new VLEPage();\n    browser.get('http://localhost:8080/wise/project/demo#/vle/node1');\n    browser.wait(function() {\n      return vle.nodeDropDownMenu.isPresent()\n    }, 5000, 'VLE didn\\'t load properly').then(() => {\n      expect(browser.getTitle()).toEqual('WISE');\n    });\n  });\n\n  it('should show first step and default UI elements on the page', () => {\n    const vle = new VLEPage();\n    vle.nodeSelectMenuShouldSay('1.1: HTML Step');\n    common.shouldBePresent(vle.prevButton, vle.nextButton, vle.closeNodeButton,\n      vle.accountButton, vle.accountMenu, vle.notificationButton, vle.notificationMenu);\n    common.shouldBeHidden(vle.accountMenu, vle.notificationMenu);\n    const nodeContent = element(by.cssContainingText('.node-content','This is a step where authors can enter their own html.'));\n    common.shouldBePresent(nodeContent);\n    common.shouldBeEnabled(vle.nextButton);\n    common.shouldBeDisabled(vle.prevButton);\n  });\n\n  it('should navigate next and previous steps using the buttons', () => {\n    const vle = new VLEPage();\n    vle.goToNextStep();\n    common.urlShouldBe('http://localhost:8080/wise/project/demo#/vle/node2');\n    vle.nodeSelectMenuShouldSay('1.2: Open Response Step');\n    common.shouldBeEnabled(vle.prevButton, vle.nextButton);\n    let nodeContent = element(by.cssContainingText('.node-content','This is a step where students enter text.'));\n    common.shouldBePresent(nodeContent);\n\n    vle.goToNextStep();\n    common.urlShouldBe('http://localhost:8080/wise/project/demo#/vle/node3');\n    vle.nodeSelectMenuShouldSay('1.3: Open Response Step Auto Graded');\n    nodeContent = element(by.cssContainingText('.node-content','Explain how the sun helps animals survive.'));\n    common.shouldBePresent(nodeContent);\n\n    vle.goToPreviousStep();\n    common.urlShouldBe('http://localhost:8080/wise/project/demo#/vle/node2');\n    vle.nodeSelectMenuShouldSay('1.2: Open Response Step');\n  });\n\n  it('should allow user to jump to a step using the navigation drop-down menu', () => {\n    const vle = new VLEPage();\n    vle.openDropDownMenu();\n    element.all(by.repeater(\"item in stepToolsCtrl.idToOrder | toArray | orderBy : 'order'\")).then((stepSelectOptions) => {\n      expect(stepSelectOptions[1].element(by.css('.node-select__text')).getText()).toBe(\"1.1: HTML Step\");\n      expect(stepSelectOptions[7].element(by.css('.node-select__text')).getText()).toBe(\"1.7: Challenge Question Step\");\n      stepSelectOptions[7].element(by.css('.node-select__text')).click();\n      common.urlShouldBe('http://localhost:8080/wise/project/demo#/vle/node7');\n    });\n  });\n\n  it('should display the group view and allow user to collapse/expand group navitems', () => {\n    const vle = new VLEPage();\n    vle.toggleConstraints();\n    vle.closeNode();\n    common.urlShouldBe('http://localhost:8080/wise/project/demo#/vle/group1');\n\n    element.all(by.repeater('id in navCtrl.rootNode.ids')).then((groupNavItems) => {\n      const activity1 = groupNavItems[0];\n      const activity2 = groupNavItems[1];\n\n      expect(activity1.element(by.className('md-title')).getText()).toEqual('1: Example Steps');\n      expect(activity2.element(by.className('md-title')).getText()).toEqual('2: Example Features');\n\n      // activity 1 should be expanded, Activity 2 should be collapsed\n      expect(common.hasClass(activity1, 'expanded')).toBe(true);\n      expect(common.hasClass(activity2, 'expanded')).toBe(false);\n\n      // check for completion icons for steps in Activity 1\n      activity1.all(by.repeater('childId in navitemCtrl.item.ids')).then((stepNavItems) => {\n\n        // step 1.1 should be completed because it's an HTML step and we visited it\n        // (the previous step we were on) should be highlighted because we came from it\n        expect(stepNavItems[0].getText()).toBe('school\\n1.1: HTML Step check_circle');\n        expect(common.hasClass(stepNavItems[0], 'prev')).toBe(true);\n        expect(stepNavItems[0].element(by.cssContainingText('.material-icons', 'check_circle')).isPresent()).toBeTruthy();\n\n        // step 1.2 should not be completed yet\n        expect(stepNavItems[1].getText()).toBe('school\\n1.2: Open Response Step');\n        expect(stepNavItems[1].element(by.cssContainingText('.material-icons', 'check_circle')).isPresent()).toBeFalsy();\n\n        // step 1.7 should not be completed yet\n        expect(stepNavItems[6].getText()).toBe('school\\n1.7: Challenge Question Step');\n        expect(stepNavItems[6].element(by.cssContainingText('.material-icons', 'check_circle')).isPresent()).toBeFalsy();\n      });\n\n      // activity 2 should not be expanded yet, so expand it\n      activity2.element(by.className('nav-item--card__content')).click();\n      expect(common.hasClass(activity2, 'expanded')).toBe(true);\n      expect(common.hasClass(activity1, 'expanded')).toBe(true);\n\n      // check that steps in activity 2 displays the step title and icon\n      activity2.all(by.repeater('childId in navitemCtrl.item.ids')).then((stepNavItems) => {\n        expect(stepNavItems[0].getText()).toBe('school\\n2.1: Show Previous Work 1');\n        expect(stepNavItems[1].getText()).toBe('school\\n2.2: Show Previous Work 2');\n        expect(stepNavItems[2].getText()).toBe('school\\n2.3: Import Work 1');\n        // go to step 2.3.\n        stepNavItems[2].element(by.tagName('button')).click();\n        common.urlShouldBe('http://localhost:8080/wise/project/demo#/vle/node22');\n      });\n    });\n  });\n\n  it('should allow user to jump to a step by changing the URL path', () => {\n    const vle = new VLEPage();\n    // the user changes the URL\n    browser.get('http://localhost:8080/wise/project/demo#/vle/node11');\n    browser.wait(function() {\n      return vle.nodeDropDownMenu.isPresent()\n    }, 5000, 'VLE didn\\'t load properly').then(() => {\n      vle.nodeSelectMenuShouldSay('1.11: Draw Step');\n    });\n    browser.get('http://localhost:8080/wise/project/demo#/vle/node14');\n    browser.wait(function() {\n      return vle.nodeDropDownMenu.isPresent()\n    }, 5000, 'VLE didn\\'t load properly').then(() => {\n      vle.nodeSelectMenuShouldSay('1.15: Table Step');\n    });\n  });\n\n  it('should allow preview user to view the account menu', () => {\n    const vle = new VLEPage();\n    vle.openAccountMenu();\n    common.shouldBeDisplayed(vle.accountMenu);\n\n    // account menu should have the preview user account icon and the exit and sign out buttons\n    element.all(by.repeater('username in themeCtrl.workgroupUsernames')).then((workgroupNames) => {\n      expect(workgroupNames[0].getText()).toBe('Preview Team');\n    });\n\n    common.shouldBePresent(vle.exitButton, vle.logOutButton);\n\n    browser.actions().sendKeys(protractor.Key.ESCAPE).perform();\n    common.shouldBeHidden(vle.accountMenu);\n\n    vle.openAccountMenu();\n    common.shouldBeDisplayed(vle.accountMenu);\n\n    clickOnPageBody();\n    common.shouldBeHidden(vle.accountMenu);\n  });\n\n  it('should allow preview user to view the notification menu', () => {\n    const vle = new VLEPage();\n    vle.openNotificationMenu();\n    common.shouldBeDisplayed(vle.notificationMenu);\n\n    // notification menu should have the Alerts title and say that there are no alerts.\n    const notificationDialogTitle = element(by.xpath('//md-toolbar/span/span[@translate=\"notificationsTitle\"]'));\n    expect(notificationDialogTitle.isDisplayed()).toBeTruthy();\n    expect(notificationDialogTitle.getText()).toEqual(\"Alerts\");\n\n    const notificationDialogContent = element(by.xpath('//md-content/div/span[@translate=\"noAlerts\"]'));\n    expect(notificationDialogContent.isDisplayed()).toBeTruthy();\n    expect(notificationDialogContent.getText()).toEqual(\"Hi there! You currently have no alerts.\");\n\n    browser.actions().sendKeys(protractor.Key.ESCAPE).perform();\n    common.shouldBeHidden(vle.notificationMenu);\n\n    vle.openNotificationMenu();\n    common.shouldBeDisplayed(vle.notificationMenu);\n\n    clickOnPageBody();\n    common.shouldBeHidden(vle.notificationMenu);\n  });\n});\n"]}