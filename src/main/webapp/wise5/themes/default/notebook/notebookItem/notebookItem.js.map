{"version":3,"sources":["notebookItem.es6"],"names":["NotebookItemController","$injector","$rootScope","$scope","$filter","ConfigService","NotebookService","ProjectService","StudentAssetService","StudentDataService","UtilService","$translate","item","getLatestNotebookItemByLocalNotebookItemId","itemId","workgroupId","id","type","label","config","itemTypes","$on","event","args","notebook","items","last","nodeId","getNodePositionAndTitleByNodeId","getNodePositionById","getThemePath","ev","onDelete","stopPropagation","$ev","$itemId","localNotebookItemId","onRevive","onSelect","$inject","NotebookItem","bindings","isChooseMode","componentController","template","controller"],"mappings":"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","file":"notebookItem.js","sourcesContent":["\"use strict\";\r\n\r\nclass NotebookItemController {\r\n    constructor($injector,\r\n                $rootScope,\r\n                $scope,\r\n                $filter,\r\n                ConfigService,\r\n                NotebookService,\r\n                ProjectService,\r\n                StudentAssetService,\r\n                StudentDataService,\r\n                UtilService) {\r\n        this.$injector = $injector;\r\n        this.$rootScope = $rootScope;\r\n        this.$scope = $scope;\r\n        this.$filter = $filter;\r\n        this.ConfigService = ConfigService;\r\n        this.NotebookService = NotebookService;\r\n        this.ProjectService = ProjectService;\r\n        this.StudentAssetService = StudentAssetService;\r\n        this.StudentDataService = StudentDataService;\r\n        this.UtilService = UtilService;\r\n\r\n        this.$translate = this.$filter('translate');\r\n        //this.mode = this.ConfigService.getMode();\r\n\r\n        this.item = this.NotebookService.getLatestNotebookItemByLocalNotebookItemId(this.itemId, this.workgroupId);\r\n        this.item.id = null; // set to null so we're creating a new notebook item. An edit to a notebook item results in a new entry in the db.\r\n\r\n        // set the type in the controller\r\n        this.type = this.item ? this.item.type : null;\r\n\r\n        //this.notebookConfig = this.NotebookService.getNotebookConfig();\r\n        this.label = this.config.itemTypes[this.type].label;\r\n\r\n        this.$rootScope.$on('notebookUpdated', (event, args) => {\r\n            let notebook = args.notebook;\r\n            if (notebook.items[this.itemId]) {\r\n                this.item = notebook.items[this.itemId].last();\r\n            }\r\n        });\r\n    }\r\n\r\n    getItemNodeId() {\r\n        if (this.item == null) {\r\n            return null;\r\n        } else {\r\n            return this.item.nodeId;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns this NotebookItem's position link\r\n     */\r\n    getItemNodeLink() {\r\n        if (this.item == null) {\r\n            return \"\";\r\n        } else {\r\n            return this.ProjectService.getNodePositionAndTitleByNodeId(this.item.nodeId);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns this NotebookItem's position\r\n     */\r\n    getItemNodePosition() {\r\n        if (this.item == null) {\r\n            return \"\";\r\n        } else {\r\n            return this.ProjectService.getNodePositionById(this.item.nodeId);\r\n        }\r\n    }\r\n\r\n    getTemplateUrl() {\r\n        return this.ProjectService.getThemePath() + '/notebook/notebookItem.html';\r\n    }\r\n\r\n    doDelete(ev) {\r\n        if (this.onDelete) {\r\n            ev.stopPropagation();  // don't follow-through on the doSelect callback after this\r\n            this.onDelete({$ev: ev, $itemId: this.item.localNotebookItemId});\r\n        }\r\n    }\r\n\r\n    doRevive(ev) {\r\n        if (this.onRevive) {\r\n            ev.stopPropagation();  // don't follow-through on the doRevive callback after this\r\n            this.onRevive({$ev: ev, $itemId: this.item.localNotebookItemId});\r\n        }\r\n    }\r\n\r\n    doSelect(ev) {\r\n        if (this.onSelect) {\r\n            this.onSelect({$ev: ev, $itemId: this.item.localNotebookItemId});\r\n        }\r\n    }\r\n}\r\n\r\nNotebookItemController.$inject = [\r\n    \"$injector\",\r\n    \"$rootScope\",\r\n    \"$scope\",\r\n    \"$filter\",\r\n    \"ConfigService\",\r\n    \"NotebookService\",\r\n    \"ProjectService\",\r\n    \"StudentAssetService\",\r\n    \"StudentDataService\",\r\n    \"UtilService\"\r\n];\r\n\r\nconst NotebookItem = {\r\n    bindings: {\r\n        itemId: '<',\r\n        isChooseMode: '<',\r\n        config: '<',\r\n        componentController: '<',\r\n        workgroupId: '<',\r\n        onDelete: '&',\r\n        onRevive: '&',\r\n        onSelect: '&'\r\n    },\r\n    template:\r\n        `<md-card class=\"notebook-item\"\r\n                  ng-mouseenter=\"focus=true;\"\r\n                  ng-mouseleave=\"focus=false;\"\r\n                  ng-class=\"{'md-whiteframe-5dp': focus}\"\r\n                  ng-click=\"$ctrl.doSelect($event)\">\r\n            <md-card-content aria-label=\"View\"\r\n                             class=\"notebook-item__content notebook-item__edit\"\r\n                             ng-class=\"{'notebook-item__content--text-only': !$ctrl.item.content.attachments.length}\"\r\n                             md-ink-ripple\r\n                             flex\r\n                             layout=\"column\"\r\n                             layout-align=\"center center\">\r\n                <div ng-repeat=\"attachment in $ctrl.item.content.attachments\"\r\n                     ng-if=\"$first\"\r\n                     class=\"notebook-item__content__attachment\"\r\n                     style=\"background: url('{{attachment.iconURL}}')\"></div>\r\n                <div ng-if=\"$ctrl.item.content.text\"\r\n                     class=\"notebook-item__content__text notebook-item__edit md-body-1\"\r\n                     style=\"color: {{$ctrl.label.color}}\">\r\n                    {{$ctrl.item.content.text}}\r\n                </div>\r\n            </md-card-content>\r\n            <md-card-actions class=\"notebook-item__actions\"\r\n                             layout=\"row\"\r\n                             layout-align=\"start center\"\r\n                             style=\"background-color: {{$ctrl.label.color}}\">\r\n                <span class=\"notebook-item__content__location\"><md-icon> place </md-icon><span class=\"md-body-1\">{{$ctrl.getItemNodePosition()}}</span></span>\r\n                <span flex></span>\r\n                <md-button class=\"md-icon-button\"\r\n                           ng-if=\"$ctrl.item.serverDeleteTime == null && !$ctrl.isChooseMode\"\r\n                           aria-label=\"Delete notebook item\"\r\n                           ng-click=\"$ctrl.doDelete($event)\">\r\n                    <md-icon> delete </md-icon>\r\n                    <md-tooltip md-direction=\"top\">{{ 'DELETE' | translate }}</md-tooltip>\r\n                </md-button>\r\n                <md-button class=\"md-icon-button\"\r\n                           ng-if=\"$ctrl.item.serverDeleteTime != null && !$ctrl.isChooseMode\"\r\n                           aria-label=\"Revive notebook item\"\r\n                           ng-click=\"$ctrl.doRevive($event)\">\r\n                    <md-icon> undo </md-icon>\r\n                    <md-tooltip md-direction=\"top\">{{ 'reviveNote' | translate }}</md-tooltip>\r\n                </md-button>\r\n            </md-card-actions>\r\n        </md-card>`,\r\n    controller: NotebookItemController\r\n};\r\n\r\nexport default NotebookItem;\r\n"]}