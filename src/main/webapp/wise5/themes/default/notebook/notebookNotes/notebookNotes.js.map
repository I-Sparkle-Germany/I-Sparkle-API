{"version":3,"sources":["notebookNotes.es6"],"names":["NotebookNotesController","$filter","$rootScope","$translate","$onChanges","changes","notebook","angular","copy","currentValue","hasNotes","Object","keys","items","length","insertMode","color","config","itemTypes","note","label","title","link","isChooseMode","$ev","$itemId","doDelete","$broadcast","itemId","ev","onInsert","value","event","editItem","alert","$event","onClose","onSetInsertMode","$inject","NotebookNotes","bindings","notesVisible","workgroupId","template","controller"],"mappings":"AAAA;;;;;;;;;;IAEMA,uB;AACF,qCAAYC,OAAZ,EACYC,UADZ,EACwB;AAAA;;AAAA;;AAEpB,aAAKC,UAAL,GAAkBF,QAAQ,WAAR,CAAlB;AACA,aAAKC,UAAL,GAAkBA,UAAlB;;AAEA,aAAKE,UAAL,GAAkB,UAACC,OAAD,EAAa;AAC3B,gBAAIA,QAAQC,QAAZ,EAAsB;AAClB,sBAAKA,QAAL,GAAgBC,QAAQC,IAAR,CAAaH,QAAQC,QAAR,CAAiBG,YAA9B,CAAhB;AACA,sBAAKC,QAAL,GAAgBC,OAAOC,IAAP,CAAY,MAAKN,QAAL,CAAcO,KAA1B,EAAiCC,MAAjC,GAA0C,IAA1C,GAAiD,KAAjE;AACH;;AAED,gBAAIT,QAAQU,UAAZ,EAAwB;AACpB,oBAAIV,QAAQU,UAAR,CAAmBN,YAAvB,EAAqC;AACjC,0BAAKO,KAAL,GAAa,EAAb;AACH,iBAFD,MAEO;AACH,0BAAKA,KAAL,GAAa,MAAKC,MAAL,CAAYC,SAAZ,CAAsBC,IAAtB,CAA2BC,KAA3B,CAAiCJ,KAA9C;AACH;AACJ;AACJ,SAbD;AAcH;;;;mCAEU;AACP,gBAAIK,QAAQ,EAAZ;AACA,gBAAI,KAAKN,UAAT,EAAqB;AACjBM,wBAAQ,KAAKlB,UAAL,CAAgB,oBAAhB,CAAR;AACH,aAFD,MAEO;AACHkB,wBAAQ,KAAKJ,MAAL,CAAYC,SAAZ,CAAsBC,IAAtB,CAA2BC,KAA3B,CAAiCE,IAAzC;AACH;AACD,mBAAOD,KAAP;AACH;;;mCAEU;AACP,gBAAIL,QAAQ,EAAZ;AACA,gBAAI,CAAC,KAAKO,YAAV,EAAwB;AACpBP,wBAAQ,KAAKC,MAAL,CAAYC,SAAZ,CAAsBC,IAAtB,CAA2BC,KAA3B,CAAiCJ,KAAzC;AACH;AACD,mBAAOA,KAAP;AACH;;;mCAEUQ,G,EAAKC,O,EAA0B;AAAA,gBAAjBC,QAAiB,uEAAN,IAAM;;AACtC,iBAAKxB,UAAL,CAAgByB,UAAhB,CAA2B,YAA3B,EAAyC,EAACC,QAAQH,OAAT,EAAkBI,IAAIL,GAAtB,EAAzC;AACH;;;mCAEUK,E,EAAID,M,EAAQ;AACnB,iBAAK1B,UAAL,CAAgByB,UAAhB,CAA2B,YAA3B,EAAyC,EAACC,QAAQH,OAAT,EAAkBI,IAAIL,GAAtB,EAAzC;AACH;;;iCAEQA,G,EAAKC,O,EAAS;AACnB;AACA,iBAAKvB,UAAL,CAAgByB,UAAhB,CAA2B,UAA3B,EAAuC,EAACC,QAAQH,OAAT,EAAkBI,IAAIL,GAAtB,EAAvC;AACH;;;+BAEMA,G,EAAKC,O,EAAS;AACjB,gBAAI,KAAKV,UAAT,EAAqB;AACjB,qBAAKe,QAAL,CAAc,EAACC,OAAON,OAAR,EAAiBO,OAAOR,GAAxB,EAAd;AACH,aAFD,MAEO;AACH,qBAAKS,QAAL,CAAcT,GAAd,EAAmBC,OAAnB;AACH;AACJ;;;6BAEIG,M,EAAQ;AACTM,kBAAM,oBAAoBN,MAA1B;AACH;;;8BAEKO,M,EAAQ;AACV,iBAAKC,OAAL,CAAaD,MAAb;AACH;;;yCAEgBA,M,EAAQ;AACrB,iBAAKE,eAAL,CAAqB,EAACN,OAAO,KAAR,EAArB;AACH;;;;;;AAGL/B,wBAAwBsC,OAAxB,GAAkC,CAC9B,SAD8B,EAE9B,YAF8B,CAAlC;;AAKA,IAAMC,gBAAgB;AAClBC,cAAU;AACNvB,gBAAQ,GADF;AAENF,oBAAY,GAFN;AAGNT,kBAAU,GAHJ;AAINmC,sBAAc,GAJR;AAKNC,qBAAa,GALP;AAMNN,iBAAS,GANH;AAONN,kBAAU,GAPJ;AAQNO,yBAAiB;AARX,KADQ;AAWlBM,u+GAXkB;AAsElBC,gBAAY5C;AAtEM,CAAtB;;kBAyEeuC,a","file":"notebookNotes.js","sourcesContent":["\"use strict\";\r\n\r\nclass NotebookNotesController {\r\n    constructor($filter,\r\n                $rootScope) {\r\n\r\n        this.$translate = $filter('translate');\r\n        this.$rootScope = $rootScope;\r\n\r\n        this.$onChanges = (changes) => {\r\n            if (changes.notebook) {\r\n                this.notebook = angular.copy(changes.notebook.currentValue);\r\n                this.hasNotes = Object.keys(this.notebook.items).length ? true : false;\r\n            }\r\n\r\n            if (changes.insertMode) {\r\n                if (changes.insertMode.currentValue) {\r\n                    this.color = '';\r\n                } else {\r\n                    this.color = this.config.itemTypes.note.label.color;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    getTitle() {\r\n        let title = '';\r\n        if (this.insertMode) {\r\n            title = this.$translate('selectItemToInsert');\r\n        } else {\r\n            title = this.config.itemTypes.note.label.link;\r\n        }\r\n        return title;\r\n    }\r\n\r\n    getColor() {\r\n        let color = '';\r\n        if (!this.isChooseMode) {\r\n            color = this.config.itemTypes.note.label.color;\r\n        }\r\n        return color;\r\n    }\r\n\r\n    deleteItem($ev, $itemId, doDelete = true) {\r\n        this.$rootScope.$broadcast('deleteNote', {itemId: $itemId, ev: $ev});\r\n    }\r\n\r\n    reviveItem(ev, itemId) {\r\n        this.$rootScope.$broadcast('reviveNote', {itemId: $itemId, ev: $ev});\r\n    }\r\n\r\n    editItem($ev, $itemId) {\r\n        //this.NotebookService.editItem(ev, itemId);\r\n        this.$rootScope.$broadcast('editNote', {itemId: $itemId, ev: $ev});\r\n    }\r\n\r\n    select($ev, $itemId) {\r\n        if (this.insertMode) {\r\n            this.onInsert({value: $itemId, event: $ev});\r\n        } else {\r\n            this.editItem($ev, $itemId);\r\n        }\r\n    }\r\n\r\n    edit(itemId) {\r\n        alert(\"Edit the item: \" + itemId);\r\n    }\r\n\r\n    close($event) {\r\n        this.onClose($event);\r\n    }\r\n\r\n    cancelInsertMode($event) {\r\n        this.onSetInsertMode({value: false});\r\n    }\r\n}\r\n\r\nNotebookNotesController.$inject = [\r\n    '$filter',\r\n    '$rootScope'\r\n];\r\n\r\nconst NotebookNotes = {\r\n    bindings: {\r\n        config: '<',\r\n        insertMode: '<',\r\n        notebook: '<',\r\n        notesVisible: '<',\r\n        workgroupId: '<',\r\n        onClose: '&',\r\n        onInsert: '&',\r\n        onSetInsertMode: '&'\r\n    },\r\n    template:\r\n        `<md-sidenav md-component-id=\"notes\"\r\n                     md-is-open=\"$ctrl.notesVisible\"\r\n                     md-whiteframe=\"4\"\r\n                     md-disable-backdrop\r\n                     layout=\"column\"\r\n                     class=\"md-sidenav-right notebook-sidebar\">\r\n            <md-toolbar md-theme=\"light\">\r\n                <div class=\"md-toolbar-tools notebook-sidebar__header\">\r\n                    <span style=\"color: {{$ctrl.color}}\">{{$ctrl.getTitle()}}</span>\r\n                    <!--<md-button ng-if=\"$ctrl.insertMode\"\r\n                               ng-click=\"$ctrl.cancelInsertMode($event)\"\r\n                               md-theme=\"default\"\r\n                               class=\"md-accent button--small\"\r\n                               aria-label=\"{{ 'Cancel' | translate }}\">\r\n                        {{ 'Cancel' | translate }}\r\n                    </md-button>-->\r\n                    <span flex></span>\r\n                    <md-button ng-click=\"$ctrl.close($event)\"\r\n                               class=\"md-icon-button\"\r\n                               aria-label=\"{{ 'Close' | translate }}\">\r\n                        <md-icon>close</md-icon>\r\n                    </md-button>\r\n                </div>\r\n            </md-toolbar>\r\n            <md-content>\r\n                <div class=\"notebook-items\" ng-class=\"{'notebook-items--insert': $ctrl.insertMode}\" layout=\"row\" layout-wrap>\r\n                    <div class=\"md-padding\" ng-if=\"!$ctrl.hasNotes\" translate=\"noNotes\" translate-value-term=\"{{$ctrl.config.itemTypes.note.label.plural}}\"></div>\r\n                    <notebook-item ng-repeat=\"(localNotebookItemId, notes) in $ctrl.notebook.items\"\r\n                                 ng-if=\"notes.last().type === 'note'\"\r\n                                 config=\"$ctrl.config\"\r\n                                 item-id=\"localNotebookItemId\"\r\n                                 is-edit-allowed=\"!$ctrl.insertMode\"\r\n                                 is-choose-mode=\"$ctrl.insertMode\"\r\n                                 workgroup-id=\"$ctrl.workgroupId\"\r\n                                 on-select=\"$ctrl.select($ev, $itemId)\"\r\n                                 on-delete=\"$ctrl.deleteItem($ev, $itemId)\"\r\n                                 style=\"display: flex;\"\r\n                                 flex=\"100\"\r\n                                 flex-gt-xs=\"50\">\r\n                    </notebook-item>\r\n                    <!-- TODO: show deleted items somewhere\r\n                        <notebook-item ng-repeat=\"(localNotebookItemId, notes) in $ctrl.notebook.deletedItems\"\r\n                                       ng-if=\"notes.last().type === 'note'\"\r\n                                       config=\"$ctrl.config\"\r\n                                       item-id=\"localNotebookItemId\"\r\n                                       is-edit-allowed=\"!$ctrl.insertMode\"\r\n                                       is-choose-mode=\"$ctrl.insertMode\"\r\n                                       workgroup-id=\"$ctrl.workgroupId\"\r\n                                       on-select=\"$ctrl.select($ev, $itemId)\"\r\n                                       on-revive=\"$ctrl.deleteItem($ev, $itemId)\"\r\n                                       style=\"display: flex;\"\r\n                                       flex=\"100\"\r\n                                       flex-gt-xs=\"50\">\r\n                        </notebook-item>\r\n                    -->\r\n                </div> <!-- TODO: add questions when supported -->\r\n            </md-content>\r\n        </md-sidenav>`,\r\n    controller: NotebookNotesController\r\n};\r\n\r\nexport default NotebookNotes;\r\n"]}