{"version":3,"sources":["notebookNotes.es6"],"names":["NotebookNotesController","$filter","$rootScope","NotebookService","$translate","publicNotebookItems","$onInit","color","config","itemTypes","note","label","$onChanges","changes","notebook","angular","copy","currentValue","hasNotes","Object","keys","items","length","title","insertMode","link","$ev","$itemId","doDelete","$broadcast","itemId","ev","onInsert","value","event","editItem","alert","$event","onClose","onSetInsertMode","$inject","NotebookNotes","bindings","notesVisible","workgroupId","template","controller"],"mappings":"AAAA;;;;;;;;;;IAEMA,uB;AACF,qCAAYC,OAAZ,EACYC,UADZ,EAEYC,eAFZ,EAE6B;AAAA;;AAAA;;AAEzB,aAAKC,UAAL,GAAkBH,QAAQ,WAAR,CAAlB;AACA,aAAKC,UAAL,GAAkBA,UAAlB;AACA,aAAKC,eAAL,GAAuBA,eAAvB;;AAEA,aAAKE,mBAAL,GAA2B,KAAKF,eAAL,CAAqBE,mBAAhD;;AAEA,aAAKC,OAAL,GAAe,YAAM;AACjB,kBAAKC,KAAL,GAAa,MAAKC,MAAL,CAAYC,SAAZ,CAAsBC,IAAtB,CAA2BC,KAA3B,CAAiCJ,KAA9C;AACH,SAFD;;AAIA,aAAKK,UAAL,GAAkB,UAACC,OAAD,EAAa;AAC3B,gBAAIA,QAAQC,QAAZ,EAAsB;AAClB,sBAAKA,QAAL,GAAgBC,QAAQC,IAAR,CAAaH,QAAQC,QAAR,CAAiBG,YAA9B,CAAhB;AACA,sBAAKC,QAAL,GAAgBC,OAAOC,IAAP,CAAY,MAAKN,QAAL,CAAcO,KAA1B,EAAiCC,MAAjC,GAA0C,IAA1C,GAAiD,KAAjE;AACH;AACJ,SALD;AAMH;;;;mCAEU;AACP,gBAAIC,QAAQ,EAAZ;AACA,gBAAI,KAAKC,UAAT,EAAqB;AACjBD,wBAAQ,KAAKnB,UAAL,CAAgB,oBAAhB,CAAR;AACH,aAFD,MAEO;AACHmB,wBAAQ,KAAKf,MAAL,CAAYC,SAAZ,CAAsBC,IAAtB,CAA2BC,KAA3B,CAAiCc,IAAzC;AACH;AACD,mBAAOF,KAAP;AACH;;;mCAEUG,G,EAAKC,O,EAA0B;AAAA,gBAAjBC,QAAiB,uEAAN,IAAM;;AACtC,iBAAK1B,UAAL,CAAgB2B,UAAhB,CAA2B,YAA3B,EAAyC,EAACC,QAAQH,OAAT,EAAkBI,IAAIL,GAAtB,EAAzC;AACH;;;mCAEUK,E,EAAID,M,EAAQ;AACnB,iBAAK5B,UAAL,CAAgB2B,UAAhB,CAA2B,YAA3B,EAAyC,EAACC,QAAQH,OAAT,EAAkBI,IAAIL,GAAtB,EAAzC;AACH;;;iCAEQA,G,EAAKC,O,EAAS;AACnB;AACA,iBAAKzB,UAAL,CAAgB2B,UAAhB,CAA2B,UAA3B,EAAuC,EAACC,QAAQH,OAAT,EAAkBI,IAAIL,GAAtB,EAAvC;AACH;;;+BAEMA,G,EAAKC,O,EAAS;AACjB,gBAAI,KAAKH,UAAT,EAAqB;AACjB,qBAAKQ,QAAL,CAAc,EAACC,OAAON,OAAR,EAAiBO,OAAOR,GAAxB,EAAd;AACH,aAFD,MAEO;AACH,qBAAKS,QAAL,CAAcT,GAAd,EAAmBC,OAAnB;AACH;AACJ;;;6BAEIG,M,EAAQ;AACTM,kBAAM,oBAAoBN,MAA1B;AACH;;;8BAEKO,M,EAAQ;AACV,iBAAKC,OAAL,CAAaD,MAAb;AACH;;;yCAEgBA,M,EAAQ;AACrB,iBAAKE,eAAL,CAAqB,EAACN,OAAO,KAAR,EAArB;AACH;;;;;;AAGLjC,wBAAwBwC,OAAxB,GAAkC,CAC9B,SAD8B,EAE9B,YAF8B,EAG9B,iBAH8B,CAAlC;;AAMA,IAAMC,gBAAgB;AAClBC,cAAU;AACNlC,gBAAQ,GADF;AAENgB,oBAAY,GAFN;AAGNV,kBAAU,GAHJ;AAINT,6BAAqB,GAJf;AAKNsC,sBAAc,GALR;AAMNC,qBAAa,GANP;AAONN,iBAAS,GAPH;AAQNN,kBAAU,GARJ;AASNO,yBAAiB;AATX,KADQ;AAYlBM,qzIAZkB;AAuFlBC,gBAAY9C;AAvFM,CAAtB;;kBA0FeyC,a","file":"notebookNotes.js","sourcesContent":["\"use strict\";\n\nclass NotebookNotesController {\n    constructor($filter,\n                $rootScope,\n                NotebookService) {\n\n        this.$translate = $filter('translate');\n        this.$rootScope = $rootScope;\n        this.NotebookService = NotebookService;\n\n        this.publicNotebookItems = this.NotebookService.publicNotebookItems;\n\n        this.$onInit = () => {\n            this.color = this.config.itemTypes.note.label.color;\n        }\n\n        this.$onChanges = (changes) => {\n            if (changes.notebook) {\n                this.notebook = angular.copy(changes.notebook.currentValue);\n                this.hasNotes = Object.keys(this.notebook.items).length ? true : false;\n            }\n        }\n    }\n\n    getTitle() {\n        let title = '';\n        if (this.insertMode) {\n            title = this.$translate('selectItemToInsert');\n        } else {\n            title = this.config.itemTypes.note.label.link;\n        }\n        return title;\n    }\n\n    deleteItem($ev, $itemId, doDelete = true) {\n        this.$rootScope.$broadcast('deleteNote', {itemId: $itemId, ev: $ev});\n    }\n\n    reviveItem(ev, itemId) {\n        this.$rootScope.$broadcast('reviveNote', {itemId: $itemId, ev: $ev});\n    }\n\n    editItem($ev, $itemId) {\n        //this.NotebookService.editItem(ev, itemId);\n        this.$rootScope.$broadcast('editNote', {itemId: $itemId, ev: $ev});\n    }\n\n    select($ev, $itemId) {\n        if (this.insertMode) {\n            this.onInsert({value: $itemId, event: $ev});\n        } else {\n            this.editItem($ev, $itemId);\n        }\n    }\n\n    edit(itemId) {\n        alert(\"Edit the item: \" + itemId);\n    }\n\n    close($event) {\n        this.onClose($event);\n    }\n\n    cancelInsertMode($event) {\n        this.onSetInsertMode({value: false});\n    }\n}\n\nNotebookNotesController.$inject = [\n    '$filter',\n    '$rootScope',\n    'NotebookService'\n];\n\nconst NotebookNotes = {\n    bindings: {\n        config: '<',\n        insertMode: '<',\n        notebook: '<',\n        publicNotebookItems: '<',\n        notesVisible: '<',\n        workgroupId: '<',\n        onClose: '&',\n        onInsert: '&',\n        onSetInsertMode: '&'\n    },\n    template:\n        `<md-sidenav md-component-id=\"notes\"\n                     md-is-open=\"$ctrl.notesVisible\"\n                     md-whiteframe=\"4\"\n                     md-disable-backdrop\n                     layout=\"column\"\n                     class=\"md-sidenav-right notebook-sidebar\">\n            <md-toolbar>\n                <div class=\"md-toolbar-tools\"\n                     ng-class=\"{'insert-mode': $ctrl.insertMode}\"\n                     style=\"background-color: {{$ctrl.color}};\">\n                    {{$ctrl.getTitle()}}\n                    <!--<md-button ng-if=\"$ctrl.insertMode\"\n                               ng-click=\"$ctrl.cancelInsertMode($event)\"\n                               md-theme=\"default\"\n                               class=\"md-accent button--small\"\n                               aria-label=\"{{ 'Cancel' | translate }}\">\n                        {{ 'Cancel' | translate }}\n                    </md-button>-->\n                    <span flex></span>\n                    <md-button ng-click=\"$ctrl.close($event)\"\n                               class=\"md-icon-button\"\n                               aria-label=\"{{ 'Close' | translate }}\">\n                        <md-icon>close</md-icon>\n                    </md-button>\n                </div>\n            </md-toolbar>\n            <md-content>\n                <div class=\"notebook-items\" ng-class=\"{'notebook-items--insert': $ctrl.insertMode}\" layout=\"row\" layout-wrap>\n                    <div class=\"md-padding\" ng-if=\"!$ctrl.hasNotes\" translate=\"noNotes\" translate-value-term=\"{{$ctrl.config.itemTypes.note.label.plural}}\"></div>\n                    <notebook-item ng-repeat=\"(localNotebookItemId, notes) in $ctrl.notebook.items\"\n                                 ng-if=\"notes.last().type === 'note'\"\n                                 config=\"$ctrl.config\"\n                                 item-id=\"localNotebookItemId\"\n                                 is-edit-allowed=\"!$ctrl.insertMode\"\n                                 is-choose-mode=\"$ctrl.insertMode\"\n                                 workgroup-id=\"$ctrl.workgroupId\"\n                                 on-select=\"$ctrl.select($ev, $itemId)\"\n                                 on-delete=\"$ctrl.deleteItem($ev, $itemId)\"\n                                 style=\"display: flex;\"\n                                 flex=\"100\"\n                                 flex-gt-xs=\"50\">\n                    </notebook-item>\n                    <notebook-item ng-repeat=\"note in $ctrl.publicNotebookItems.public\"\n                                 config=\"$ctrl.config\"\n                                 group=\"public\"\n                                 item-id=\"note.localNotebookItemId\"\n                                 is-edit-allowed=\"false\"\n                                 is-choose-mode=\"$ctrl.insertMode\"\n                                 workgroup-id=\"note.workgroupId\"\n                                 on-select=\"$ctrl.select($ev, $itemId)\"\n                                 on-delete=\"$ctrl.deleteItem($ev, $itemId)\"\n                                 style=\"display: flex;\"\n                                 flex=\"100\"\n                                 flex-gt-xs=\"50\">\n                    </notebook-item>\n\n                    <!-- TODO: show deleted items somewhere\n                        <notebook-item ng-repeat=\"(localNotebookItemId, notes) in $ctrl.notebook.deletedItems\"\n                                       ng-if=\"notes.last().type === 'note'\"\n                                       config=\"$ctrl.config\"\n                                       item-id=\"localNotebookItemId\"\n                                       is-edit-allowed=\"!$ctrl.insertMode\"\n                                       is-choose-mode=\"$ctrl.insertMode\"\n                                       workgroup-id=\"$ctrl.workgroupId\"\n                                       on-select=\"$ctrl.select($ev, $itemId)\"\n                                       on-revive=\"$ctrl.deleteItem($ev, $itemId)\"\n                                       style=\"display: flex;\"\n                                       flex=\"100\"\n                                       flex-gt-xs=\"50\">\n                        </notebook-item>\n                    -->\n                </div> <!-- TODO: add questions when supported -->\n            </md-content>\n        </md-sidenav>`,\n    controller: NotebookNotesController\n};\n\nexport default NotebookNotes;\n"]}