{"version":3,"sources":["themeController.es6"],"names":["ThemeController","$scope","$state","$filter","ConfigService","ProjectService","StudentDataService","StudentStatusService","NotebookService","SessionService","$mdDialog","$mdMedia","$mdToast","$mdComponentRegistry","$translate","layoutView","numberProject","themePath","getThemePath","themeSettings","getThemeSettings","hideTotalScores","nodeStatuses","idToOrder","rootNode","rootNodeStatus","id","workgroupId","getWorkgroupId","workgroupUserNames","getUserNamesByWorkgroupId","notebookOpen","notebookConfig","getNotebookConfig","notebookFilter","currentNode","getCurrentNode","planningMode","enabled","type","itemTypes","prop","hasOwnProperty","connectionLostDisplay","build","template","hideDelay","connectionLostShown","setLayoutState","$on","event","args","message","nodeId","node","getNodeById","constraints","getConstraintsForNode","length","c","constraint","evaluateConstraint","getConstraintMessage","show","alert","parent","angular","element","document","body","title","htmlContent","ariaLabel","ok","targetEvent","ev","confirm","textContent","cancel","then","renewSession","undefined","forceLogOut","handleServerDisconnect","handleServerReconnect","revisions","componentController","allowRevert","$event","revisionsTemplateUrl","templateUrl","locals","items","reverse","controller","RevisionsController","close","hide","revertWork","componentState","setStudentWork","studentDataChanged","$inject","studentAssetDialogTemplateUrl","studentAssetTemplateUrl","StudentAssetDialogController","closeDialog","notification","notificationDismissDialogTemplateUrl","dismissCodePrompt","DismissCodeDialogController","NotificationService","input","dismissCode","hasDismissCode","data","nodePositionAndTitle","getNodePositionAndTitleByNodeId","checkDismissCode","dismissNotification","componentId","componentType","category","eventData","saveVLEEvent","errorMessage","visitNode","goToNodeId","endCurrentNodeAndSetCurrentNodeByNodeId","state","layoutState","isApplicationNode","isGroupNode","go","notebookNavOpen","getAvatarColorForWorkgroupId","mouseMoved"],"mappings":"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","file":"themeController.js","sourcesContent":["'use strict';\r\n\r\n//import EditNotebookItemController from './notebook/editNotebookItemController';\r\n\r\nclass ThemeController {\r\n    constructor($scope,\r\n                $state,\r\n                $filter,\r\n                ConfigService,\r\n                ProjectService,\r\n                StudentDataService,\r\n                StudentStatusService,\r\n                NotebookService,\r\n                SessionService,\r\n                $mdDialog,\r\n                $mdMedia,\r\n                $mdToast,\r\n                $mdComponentRegistry) {\r\n\r\n        this.$scope = $scope;\r\n        this.$state = $state;\r\n        this.$filter = $filter;\r\n        this.ConfigService = ConfigService;\r\n        this.ProjectService = ProjectService;\r\n        this.StudentDataService = StudentDataService;\r\n        this.NotebookService = NotebookService;\r\n        this.SessionService = SessionService;\r\n        this.StudentStatusService = StudentStatusService;\r\n        this.$mdDialog = $mdDialog;\r\n        this.$mdMedia = $mdMedia;\r\n        this.$mdToast = $mdToast;\r\n        this.$mdComponentRegistry = $mdComponentRegistry;\r\n\r\n        this.$translate = this.$filter('translate');\r\n\r\n        // TODO: set these variables dynamically from theme settings\r\n        this.layoutView = 'list'; // 'list' or 'card'\r\n        this.numberProject = true;\r\n\r\n        this.themePath = this.ProjectService.getThemePath();\r\n        this.themeSettings = this.ProjectService.getThemeSettings();\r\n        this.hideTotalScores = this.themeSettings.hideTotalScores;\r\n\r\n        this.nodeStatuses = this.StudentDataService.nodeStatuses;\r\n        this.idToOrder = this.ProjectService.idToOrder;\r\n\r\n        this.rootNode = this.ProjectService.rootNode;\r\n        this.rootNodeStatus = this.nodeStatuses[this.rootNode.id];\r\n\r\n        this.workgroupId = this.ConfigService.getWorkgroupId();\r\n        this.workgroupUserNames = this.ConfigService.getUserNamesByWorkgroupId(this.workgroupId);\r\n\r\n        this.notebookOpen = false;\r\n        this.notebookConfig = this.NotebookService.getNotebookConfig();\r\n        this.notebookFilter = '';\r\n\r\n        this.currentNode = this.StudentDataService.getCurrentNode();\r\n\r\n        this.planningMode = false;\r\n\r\n        // set current notebook type filter to first enabled type\r\n        if (this.notebookConfig.enabled) {\r\n            for (var type in this.notebookConfig.itemTypes) {\r\n                let prop = this.notebookConfig.itemTypes[type];\r\n                if (this.notebookConfig.itemTypes.hasOwnProperty(type) && prop.enabled) {\r\n                    this.notebookFilter = type;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        // build server disconnect display\r\n        this.connectionLostDisplay = $mdToast.build({\r\n            template: \"<md-toast>\\\r\n                      <span>{{ 'ERROR_CHECK_YOUR_INTERNET_CONNECTION' | translate }}</span>\\\r\n                      </md-toast>\",\r\n            hideDelay: 0\r\n        });\r\n        this.connectionLostShown = false;\r\n\r\n        this.setLayoutState();\r\n\r\n        // update layout state when current node changes\r\n        this.$scope.$on('currentNodeChanged', (event, args) => {\r\n            this.currentNode = this.StudentDataService.getCurrentNode();\r\n            this.setLayoutState();\r\n        });\r\n\r\n        // alert user when a locked node has been clicked\r\n        this.$scope.$on('nodeClickLocked', (event, args) => {\r\n            var message = this.$translate('sorryYouCannotViewThisItemYet');\r\n            let nodeId = args.nodeId;\r\n\r\n            var node = this.ProjectService.getNodeById(nodeId);\r\n\r\n            if (node != null) {\r\n\r\n                // get the constraints that affect this node\r\n                var constraints = this.ProjectService.getConstraintsForNode(node);\r\n\r\n                if (constraints != null && constraints.length > 0) {\r\n                    message = '';\r\n                }\r\n\r\n                // loop through all the constraints that affect this node\r\n                for (var c = 0; c < constraints.length; c++) {\r\n                    var constraint = constraints[c];\r\n\r\n                    // check if the constraint has been satisfied\r\n                    if (constraint != null && !this.StudentDataService.evaluateConstraint(node, constraint)) {\r\n                        // the constraint has not been satisfied and is still active\r\n\r\n                        if (message != '') {\r\n                            // separate multiple constraints with line breaks\r\n                            message += '<br/><br/>';\r\n                        }\r\n\r\n                        // get the message that describes how to disable the constraint\r\n                        message += this.ProjectService.getConstraintMessage(nodeId, constraint);\r\n                    }\r\n                }\r\n            }\r\n\r\n            this.$mdDialog.show(\r\n                this.$mdDialog.alert()\r\n                    .parent(angular.element(document.body))\r\n                    .title(this.$translate('itemLocked'))\r\n                    .htmlContent(message)\r\n                    .ariaLabel(this.$translate('itemLocked'))\r\n                    .ok(this.$translate('ok'))\r\n                    .targetEvent(event)\r\n            );\r\n        });\r\n\r\n        // alert user when inactive for a long time\r\n        this.$scope.$on('showSessionWarning', (ev) => {\r\n            let alert = this.$mdDialog.confirm()\r\n                .parent(angular.element(document.body))\r\n                .title(this.$translate('sessionTimeout'))\r\n                .textContent(this.$translate('autoLogoutMessage'))\r\n                .ariaLabel(this.$translate('sessionTimeout'))\r\n                .targetEvent(ev)\r\n                .ok(this.$translate('yes'))\r\n                .cancel(this.$translate('no'));\r\n\r\n            this.$mdDialog.show(alert).then(() => {\r\n                this.SessionService.renewSession();\r\n                alert = undefined;\r\n            }, () => {\r\n                this.SessionService.forceLogOut();\r\n            });\r\n        });\r\n\r\n        // alert user when inactive for a long time\r\n        this.$scope.$on('showRequestLogout', (ev) => {\r\n            let alert = this.$mdDialog.confirm()\r\n                .parent(angular.element(document.body))\r\n                .title(this.$translate('serverUpdate'))\r\n                .textContent(this.$translate('serverUpdateRequestLogoutMessage'))\r\n                .ariaLabel(this.$translate('serverUpdate'))\r\n                .targetEvent(ev)\r\n                .ok(this.$translate('ok'));\r\n\r\n            this.$mdDialog.show(alert).then(() => {\r\n                // do nothing\r\n            }, () => {\r\n                // do nothing\r\n            });\r\n        });\r\n\r\n        // alert user when server loses connection\r\n        this.$scope.$on('serverDisconnected', () => {\r\n            this.handleServerDisconnect();\r\n        });\r\n\r\n        // remove alert when server regains connection\r\n        this.$scope.$on('serverConnected', () => {\r\n            this.handleServerReconnect();\r\n        });\r\n\r\n        // show list of revisions in a dialog when user clicks the show revisions link for a component\r\n        this.$scope.$on('showRevisions', (event, args) => {\r\n            let revisions = args.revisions;\r\n            let componentController = args.componentController;\r\n            let allowRevert = args.allowRevert;\r\n            let $event = args.$event;\r\n            let revisionsTemplateUrl = this.themePath + '/templates/componentRevisions.html';\r\n\r\n            this.$mdDialog.show({\r\n                parent: angular.element(document.body),\r\n                targetEvent: $event,\r\n                templateUrl: revisionsTemplateUrl,\r\n                locals: {\r\n                    items: revisions.reverse(),\r\n                    componentController: componentController,\r\n                    allowRevert: allowRevert\r\n                },\r\n                controller: RevisionsController\r\n            });\r\n            function RevisionsController($scope, $mdDialog, items, componentController, allowRevert) {\r\n                $scope.items = items;\r\n                $scope.componentController = componentController;\r\n                $scope.allowRevert = allowRevert;\r\n                $scope.close = () => {\r\n                    $mdDialog.hide();\r\n                };\r\n                $scope.revertWork = (componentState) => {\r\n                    $scope.componentController.setStudentWork(componentState);\r\n                    $scope.componentController.studentDataChanged();\r\n                    $mdDialog.hide();\r\n                };\r\n            }\r\n            RevisionsController.$inject = [\"$scope\", \"$mdDialog\", \"items\", \"componentController\", \"allowRevert\"];\r\n        });\r\n\r\n        this.$scope.$on('showStudentAssets', (event, args) => {\r\n            let componentController = args.componentController;\r\n            let $event = args.$event;\r\n            let studentAssetDialogTemplateUrl = this.themePath + '/templates/studentAssetDialog.html';\r\n            let studentAssetTemplateUrl = this.themePath + '/studentAsset/studentAsset.html';\r\n\r\n            this.$mdDialog.show({\r\n                parent: angular.element(document.body),\r\n                targetEvent: $event,\r\n                templateUrl: studentAssetDialogTemplateUrl,\r\n                locals: {\r\n                    studentAssetTemplateUrl: studentAssetTemplateUrl,\r\n                    componentController: componentController\r\n                },\r\n                controller: StudentAssetDialogController\r\n            });\r\n            function StudentAssetDialogController($scope, $mdDialog, componentController) {\r\n                $scope.studentAssetTemplateUrl = studentAssetTemplateUrl;\r\n                $scope.componentController = componentController;\r\n                $scope.closeDialog = function () {\r\n                    $mdDialog.hide();\r\n                }\r\n            }\r\n            StudentAssetDialogController.$inject = [\"$scope\", \"$mdDialog\", \"componentController\"];\r\n        });\r\n\r\n        // toggle notebook opened or closed on 'toggleNotebook' event\r\n        /*this.$scope.$on('toggleNotebook', (event, args) => {\r\n            let ev = args.ev;\r\n            let open = args.open;\r\n            this.toggleNotebook(ev, open);\r\n        });\r\n\r\n        // toggle notebook nav opened or closed on 'toggleNotebookNav' event\r\n        this.$scope.$on('toggleNotebookNav', () => {\r\n            this.toggleNotebookNav();\r\n        });\r\n\r\n        // update notebook filter on 'setNotebookFilter' event\r\n        this.$scope.$on('setNotebookFilter', (event, args) => {\r\n            this.notebookFilter = args.filter;\r\n        });*/\r\n\r\n        // show edit note dialog on 'editNote' event\r\n        /*this.$scope.$on('editNote', (event, args) => {\r\n            let itemId = args.itemId;\r\n            let ev = args.ev;\r\n            this.editNote(itemId, true, null, ev);\r\n        });*/\r\n\r\n        // show edit note dialog on 'addNewNote' event\r\n        /*this.$scope.$on('addNewNote', (event, args) => {\r\n            let ev = args.ev;\r\n            let file = args.file;\r\n            this.editNote(null, true, file, ev);\r\n        });*/\r\n\r\n        // show delete note confirm dialog on 'deleteNote' event\r\n        /*this.$scope.$on('deleteNote', (event, args) => {\r\n            let itemId = args.itemId;\r\n            let ev = args.ev;\r\n            let doDelete = true;\r\n            this.deleteNote(itemId, ev, doDelete);\r\n        });*/\r\n\r\n        // show delete note confirm dialog on 'reviveNote' event\r\n        /*this.$scope.$on('reviveNote', (event, args) => {\r\n            let itemId = args.itemId;\r\n            let ev = args.ev;\r\n            let doDelete = false;\r\n            this.deleteNote(itemId, ev, doDelete);\r\n        });*/\r\n\r\n        // a group node has turned on or off planning mode\r\n        this.$scope.$on('togglePlanningMode', (event, args) => {\r\n            this.planningMode = args.planningMode;\r\n        });\r\n\r\n        // handle request for notification dismiss codes\r\n        this.$scope.$on('viewCurrentAmbientNotification', (event, args) => {\r\n            let notification = args.notification;\r\n            let ev = args.event;\r\n            let notificationDismissDialogTemplateUrl = this.themePath + '/templates/notificationDismissDialog.html';\r\n\r\n            let dismissCodePrompt = {\r\n                parent: angular.element(document.body),\r\n                targetEvent: ev,\r\n                templateUrl: notificationDismissDialogTemplateUrl,\r\n                locals: {\r\n                    notification: notification\r\n                },\r\n                controller: DismissCodeDialogController\r\n            };\r\n            DismissCodeDialogController.$inject = ['$scope', '$mdDialog', '$filter', 'NotificationService', 'ProjectService', 'StudentDataService', 'notification'];\r\n\r\n            function DismissCodeDialogController($scope, $mdDialog, $filter, NotificationService, ProjectService, StudentDataService, notification) {\r\n\r\n                $scope.$translate = $filter('translate');\r\n\r\n                $scope.input = {\r\n                    dismissCode: \"\"\r\n                };\r\n                $scope.message = \"\";\r\n                $scope.notification = notification;\r\n                $scope.hasDismissCode = false;\r\n                if (notification.data) {\r\n                    if (notification.data.dismissCode) {\r\n                        $scope.hasDismissCode = true;\r\n                    }\r\n                }\r\n                $scope.nodePositionAndTitle = ProjectService.getNodePositionAndTitleByNodeId(notification.nodeId);\r\n\r\n                $scope.checkDismissCode = function() {\r\n                    if (!$scope.hasDismissCode || ($scope.input.dismissCode == notification.data.dismissCode)) {\r\n                        NotificationService.dismissNotification(notification);\r\n                        $mdDialog.hide();\r\n                        // log currentAmbientNotificationDimissed event\r\n                        var nodeId = null;\r\n                        var componentId = null;\r\n                        var componentType = null;\r\n                        var category = \"Notification\";\r\n                        var event = \"currentAmbientNotificationDimissedWithCode\";\r\n                        var eventData = {};\r\n                        StudentDataService.saveVLEEvent(nodeId, componentId, componentType, category, event, eventData);\r\n                    } else {\r\n                        $scope.errorMessage = $scope.$translate('dismissNotificationInvalidDismissCode');\r\n                    }\r\n                };\r\n                $scope.visitNode = function() {\r\n                    if (!$scope.hasDismissCode) {\r\n                        // only dismiss notifications that don't require a dismiss code, but still allow them to move to the node\r\n                        NotificationService.dismissNotification(null, $scope.notification);\r\n                    }\r\n\r\n                    let goToNodeId = $scope.notification.nodeId;\r\n                    if (goToNodeId != null) {\r\n                        StudentDataService.endCurrentNodeAndSetCurrentNodeByNodeId(goToNodeId);\r\n                    }\r\n                };\r\n\r\n                $scope.closeDialog = function() {\r\n                    $mdDialog.hide();\r\n\r\n                    // log currentAmbientNotificationWindowClosed event\r\n                    var nodeId = null;\r\n                    var componentId = null;\r\n                    var componentType = null;\r\n                    var category = \"Notification\";\r\n                    var event = \"currentAmbientNotificationWindowClosed\";\r\n                    var eventData = {};\r\n                    StudentDataService.saveVLEEvent(nodeId, componentId, componentType, category, event, eventData);\r\n                }\r\n            }\r\n\r\n            this.$mdDialog.show(dismissCodePrompt);\r\n\r\n            // log currentAmbientNotificationWindowOpened event\r\n            var nodeId = null;\r\n            var componentId = null;\r\n            var componentType = null;\r\n            var category = \"Notification\";\r\n            var event = \"currentAmbientNotificationWindowOpened\";\r\n            var eventData = {};\r\n            this.StudentDataService.saveVLEEvent(nodeId, componentId, componentType, category, event, eventData);\r\n        });\r\n\r\n        // capture notebook open/close events\r\n        /*this.$mdComponentRegistry.when('notebook').then(it => {\r\n            this.$scope.$watch(() => {\r\n                return it.isOpen();\r\n            }, (isOpenNewValue, isOpenOldValue) => {\r\n                if (isOpenNewValue !== isOpenOldValue) {\r\n                    let currentNode = this.StudentDataService.getCurrentNode();\r\n                    this.NotebookService.saveNotebookToggleEvent(isOpenNewValue, currentNode);\r\n                }\r\n            });\r\n        });*/\r\n    }\r\n\r\n    /**\r\n    * Set the layout state of the vle\r\n    * @param state string specifying state (e.g. 'notebook'; optional)\r\n    */\r\n    setLayoutState(state) {\r\n        let layoutState = 'nav'; // default layout state\r\n        if (state) {\r\n            layoutState = state;\r\n        } else {\r\n            // no state was sent, so set based on current node\r\n            if (this.currentNode) {\r\n                var id = this.currentNode.id;\r\n                if (this.ProjectService.isApplicationNode(id)) {\r\n                    // currently viewing step, so show step view\r\n                    layoutState = 'node';\r\n                } else if (this.ProjectService.isGroupNode(id)) {\r\n                    // currently viewing group node, so show navigation view\r\n                    layoutState = 'nav';\r\n                }\r\n            }\r\n        }\r\n\r\n        if (layoutState === 'notebook') {\r\n            this.$state.go('root.notebook', {nodeId: this.currentNode.id});\r\n        } else {\r\n            this.notebookNavOpen = false;\r\n            this.$state.go('root.vle', {nodeId: this.currentNode.id});\r\n        }\r\n\r\n        this.layoutState = layoutState;\r\n    }\r\n\r\n    // show server error alert when connection is lost\r\n    handleServerDisconnect() {\r\n        if (!this.connectionLostShown) {\r\n          this.$mdToast.show(this.connectionLostDisplay);\r\n          this.connectionLostShown = true;\r\n        }\r\n    }\r\n\r\n    // hide server error alert when connection is restored\r\n    handleServerReconnect() {\r\n        this.$mdToast.hide(this.connectionLostDisplay);\r\n        this.connectionLostShown = false;\r\n    }\r\n\r\n    getAvatarColorForWorkgroupId(workgroupId) {\r\n        return this.ConfigService.getAvatarColorForWorkgroupId(workgroupId);\r\n    }\r\n\r\n    /**\r\n    * Open or close the notebook and save notebook open/close events\r\n    */\r\n    /*toggleNotebook(ev, open) {\r\n        //this.notebookOpen = !this.notebookOpen;\r\n        if (this.layoutState === 'notebook' && !open) {\r\n            this.setLayoutState();\r\n            this.NotebookService.saveNotebookToggleEvent(false, this.currentNode);\r\n        } else {\r\n            this.layoutState = 'notebook';\r\n            this.setLayoutState('notebook');\r\n            this.NotebookService.saveNotebookToggleEvent(true, this.currentNode);\r\n        }\r\n    }*/\r\n\r\n    /**\r\n     * Open or close the notebook nav menu\r\n     */\r\n    /*toggleNotebookNav() {\r\n        this.notebookNavOpen = !this.notebookNavOpen;\r\n    }*/\r\n\r\n    /**\r\n     * Delete the note specified by the itemId.\r\n     */\r\n    /*deleteNote(itemId, ev, doDelete = true) {\r\n        let confirm = null;\r\n\r\n        if (doDelete) {\r\n            confirm = this.$mdDialog.confirm()\r\n                .title(this.$translate('deleteNoteConfirmMessage'))\r\n                .ariaLabel('delete note confirmation')\r\n                .targetEvent(ev)\r\n                .ok(this.$translate('delete'))\r\n                .cancel(this.$translate('cancel'));\r\n        } else {\r\n            confirm = this.$mdDialog.confirm()\r\n                .title(this.$translate('reviveNoteConfirmMessage'))\r\n                .ariaLabel('revive note confirmation')\r\n                .targetEvent(ev)\r\n                .ok(this.$translate('revive'))\r\n                .cancel(this.$translate('cancel'));\r\n        }\r\n\r\n        this.$mdDialog.show(confirm).then(() => {\r\n            let noteCopy = angular.copy(this.NotebookService.getLatestNotebookItemByLocalNotebookItemId(itemId));\r\n            noteCopy.id = null; // set to null so we're creating a new notebook item. An edit to a notebook item results in a new entry in the db.\r\n            noteCopy.content.clientSaveTime = Date.parse(new Date());  // set save timestamp\r\n            let clientDeleteTime = null;  // if delete timestamp is null, then we are in effect un-deleting this note item\r\n            if (doDelete) {\r\n                clientDeleteTime = Date.parse(new Date());  // set delete timestamp\r\n            }\r\n            this.NotebookService.saveNotebookItem(noteCopy.id, noteCopy.nodeId, noteCopy.localNotebookItemId,\r\n                noteCopy.type, noteCopy.title, noteCopy.content, noteCopy.content.clientSaveTime, clientDeleteTime);\r\n        }, () => {\r\n            // they chose not to delete. Do nothing, the dialog will close.\r\n        });\r\n    }\r\n\r\n    editNote(itemId, isEditMode, file, ev) {\r\n        let notebookItemTemplate = this.themePath + '/notebook/editNotebookItem.html';\r\n\r\n        // Display a dialog where students can view/add/edit a notebook item\r\n        this.$mdDialog.show({\r\n            parent: angular.element(document.body),\r\n            targetEvent: ev,\r\n            templateUrl: notebookItemTemplate,\r\n            controller: EditNotebookItemController,\r\n            controllerAs: 'editNotebookItemController',\r\n            bindToController: true,\r\n            locals: {\r\n                itemId: itemId,\r\n                isEditMode: isEditMode,\r\n                file: file\r\n            }\r\n        });\r\n    }*/\r\n\r\n    /**\r\n     * The user has moved the mouse so we will notify the Session Service\r\n     * so that it can refresh the session\r\n     */\r\n    mouseMoved() {\r\n        /*\r\n         * notify the Session Service that the user has moved the mouse\r\n         * so we can refresh the session\r\n         */\r\n        this.SessionService.mouseMoved();\r\n    }\r\n}\r\n\r\n\r\nThemeController.$inject = [\r\n    '$scope',\r\n    '$state',\r\n    '$filter',\r\n    'ConfigService',\r\n    'ProjectService',\r\n    'StudentDataService',\r\n    'StudentStatusService',\r\n    'NotebookService',\r\n    'SessionService',\r\n    '$mdDialog',\r\n    '$mdMedia',\r\n    '$mdToast',\r\n    '$mdComponentRegistry'\r\n];\r\n\r\nexport default ThemeController;\r\n"]}