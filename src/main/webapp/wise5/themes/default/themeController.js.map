{"version":3,"sources":["themeController.es6"],"names":["ThemeController","$scope","$state","$filter","ConfigService","ProjectService","StudentDataService","StudentStatusService","NotebookService","SessionService","$mdDialog","$mdMedia","$mdToast","$mdComponentRegistry","$translate","layoutView","numberProject","themePath","getThemePath","themeSettings","getThemeSettings","hideTotalScores","nodeStatuses","idToOrder","rootNode","rootNodeStatus","id","workgroupId","getWorkgroupId","workgroupUserNames","getUserNamesByWorkgroupId","notebookOpen","notebookConfig","getNotebookConfig","notebookFilter","currentNode","getCurrentNode","planningMode","enabled","type","itemTypes","prop","hasOwnProperty","connectionLostDisplay","build","template","hideDelay","connectionLostShown","setLayoutState","$on","event","args","message","nodeId","node","getNodeById","constraints","getConstraintsForNode","orderConstraints","length","nodeTitle","getNodePositionAndTitleByNodeId","c","constraint","evaluateConstraint","getConstraintMessage","show","alert","parent","angular","element","document","body","title","htmlContent","ariaLabel","ok","targetEvent","ev","confirm","textContent","cancel","then","renewSession","undefined","forceLogOut","handleServerDisconnect","handleServerReconnect","revisions","componentController","allowRevert","$event","revisionsTemplateUrl","templateUrl","locals","items","reverse","controller","RevisionsController","close","hide","revertWork","componentState","setStudentWork","studentDataChanged","$inject","studentAssetDialogTemplateUrl","studentAssetTemplateUrl","StudentAssetDialogController","closeDialog","notification","notificationDismissDialogTemplateUrl","dismissCodePrompt","DismissCodeDialogController","NotificationService","input","dismissCode","hasDismissCode","data","nodePositionAndTitle","checkDismissCode","dismissNotification","componentId","componentType","category","eventData","saveVLEEvent","errorMessage","visitNode","goToNodeId","endCurrentNodeAndSetCurrentNodeByNodeId","state","layoutState","isApplicationNode","isGroupNode","go","notebookNavOpen","getAvatarColorForWorkgroupId","mouseMoved"],"mappings":"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","file":"themeController.js","sourcesContent":["'use strict';\n\n//import EditNotebookItemController from './notebook/editNotebookItemController';\n\nclass ThemeController {\n    constructor($scope,\n                $state,\n                $filter,\n                ConfigService,\n                ProjectService,\n                StudentDataService,\n                StudentStatusService,\n                NotebookService,\n                SessionService,\n                $mdDialog,\n                $mdMedia,\n                $mdToast,\n                $mdComponentRegistry) {\n\n        this.$scope = $scope;\n        this.$state = $state;\n        this.$filter = $filter;\n        this.ConfigService = ConfigService;\n        this.ProjectService = ProjectService;\n        this.StudentDataService = StudentDataService;\n        this.NotebookService = NotebookService;\n        this.SessionService = SessionService;\n        this.StudentStatusService = StudentStatusService;\n        this.$mdDialog = $mdDialog;\n        this.$mdMedia = $mdMedia;\n        this.$mdToast = $mdToast;\n        this.$mdComponentRegistry = $mdComponentRegistry;\n\n        this.$translate = this.$filter('translate');\n\n        // TODO: set these variables dynamically from theme settings\n        this.layoutView = 'list'; // 'list' or 'card'\n        this.numberProject = true;\n\n        this.themePath = this.ProjectService.getThemePath();\n        this.themeSettings = this.ProjectService.getThemeSettings();\n        this.hideTotalScores = this.themeSettings.hideTotalScores;\n\n        this.nodeStatuses = this.StudentDataService.nodeStatuses;\n        this.idToOrder = this.ProjectService.idToOrder;\n\n        this.rootNode = this.ProjectService.rootNode;\n        this.rootNodeStatus = this.nodeStatuses[this.rootNode.id];\n\n        this.workgroupId = this.ConfigService.getWorkgroupId();\n        this.workgroupUserNames = this.ConfigService.getUserNamesByWorkgroupId(this.workgroupId);\n\n        this.notebookOpen = false;\n        this.notebookConfig = this.NotebookService.getNotebookConfig();\n        this.notebookFilter = '';\n\n        this.currentNode = this.StudentDataService.getCurrentNode();\n\n        this.planningMode = false;\n\n        // set current notebook type filter to first enabled type\n        if (this.notebookConfig.enabled) {\n            for (var type in this.notebookConfig.itemTypes) {\n                let prop = this.notebookConfig.itemTypes[type];\n                if (this.notebookConfig.itemTypes.hasOwnProperty(type) && prop.enabled) {\n                    this.notebookFilter = type;\n                    break;\n                }\n            }\n        }\n\n        // build server disconnect display\n        this.connectionLostDisplay = $mdToast.build({\n            template: \"<md-toast>\\\n                      <span>{{ 'ERROR_CHECK_YOUR_INTERNET_CONNECTION' | translate }}</span>\\\n                      </md-toast>\",\n            hideDelay: 0\n        });\n        this.connectionLostShown = false;\n\n        this.setLayoutState();\n\n        // update layout state when current node changes\n        this.$scope.$on('currentNodeChanged', (event, args) => {\n            this.currentNode = this.StudentDataService.getCurrentNode();\n            this.setLayoutState();\n        });\n\n        // alert user when a locked node has been clicked\n        this.$scope.$on('nodeClickLocked', (event, args) => {\n            var message = this.$translate('sorryYouCannotViewThisItemYet');\n            let nodeId = args.nodeId;\n\n            var node = this.ProjectService.getNodeById(nodeId);\n\n            if (node != null) {\n\n                // get the constraints that affect this node\n                var constraints = this.ProjectService.getConstraintsForNode(node);\n                this.ProjectService.orderConstraints(constraints);\n\n                if (constraints != null && constraints.length > 0) {\n                    // get the node title the student is trying to go to\n                    let nodeTitle = this.ProjectService.getNodePositionAndTitleByNodeId(nodeId);\n                    message = this.$translate('toVisitNodeTitleYouNeedTo', { nodeTitle: nodeTitle });\n                }\n\n                // loop through all the constraints that affect this node\n                for (var c = 0; c < constraints.length; c++) {\n                    var constraint = constraints[c];\n\n                    // check if the constraint has been satisfied\n                    if (constraint != null && !this.StudentDataService.evaluateConstraint(node, constraint)) {\n                        // the constraint has not been satisfied and is still active\n\n                        if (message != '') {\n                            // separate multiple constraints with line breaks\n                            message += '<br/>';\n                        }\n\n                        // get the message that describes how to disable the constraint\n                        message += this.ProjectService.getConstraintMessage(nodeId, constraint);\n                    }\n                }\n            }\n\n            this.$mdDialog.show(\n                this.$mdDialog.alert()\n                    .parent(angular.element(document.body))\n                    .title(this.$translate('itemLocked'))\n                    .htmlContent(message)\n                    .ariaLabel(this.$translate('itemLocked'))\n                    .ok(this.$translate('ok'))\n                    .targetEvent(event)\n            );\n        });\n\n        // alert user when inactive for a long time\n        this.$scope.$on('showSessionWarning', (ev) => {\n            let alert = this.$mdDialog.confirm()\n                .parent(angular.element(document.body))\n                .title(this.$translate('sessionTimeout'))\n                .textContent(this.$translate('autoLogoutMessage'))\n                .ariaLabel(this.$translate('sessionTimeout'))\n                .targetEvent(ev)\n                .ok(this.$translate('yes'))\n                .cancel(this.$translate('no'));\n\n            this.$mdDialog.show(alert).then(() => {\n                this.SessionService.renewSession();\n                alert = undefined;\n            }, () => {\n                this.SessionService.forceLogOut();\n            });\n        });\n\n        // alert user when inactive for a long time\n        this.$scope.$on('showRequestLogout', (ev) => {\n            let alert = this.$mdDialog.confirm()\n                .parent(angular.element(document.body))\n                .title(this.$translate('serverUpdate'))\n                .textContent(this.$translate('serverUpdateRequestLogoutMessage'))\n                .ariaLabel(this.$translate('serverUpdate'))\n                .targetEvent(ev)\n                .ok(this.$translate('ok'));\n\n            this.$mdDialog.show(alert).then(() => {\n                // do nothing\n            }, () => {\n                // do nothing\n            });\n        });\n\n        // alert user when server loses connection\n        this.$scope.$on('serverDisconnected', () => {\n            this.handleServerDisconnect();\n        });\n\n        // remove alert when server regains connection\n        this.$scope.$on('serverConnected', () => {\n            this.handleServerReconnect();\n        });\n\n        // show list of revisions in a dialog when user clicks the show revisions link for a component\n        this.$scope.$on('showRevisions', (event, args) => {\n            let revisions = args.revisions;\n            let componentController = args.componentController;\n            let allowRevert = args.allowRevert;\n            let $event = args.$event;\n            let revisionsTemplateUrl = this.themePath + '/templates/componentRevisions.html';\n\n            this.$mdDialog.show({\n                parent: angular.element(document.body),\n                targetEvent: $event,\n                templateUrl: revisionsTemplateUrl,\n                locals: {\n                    items: revisions.reverse(),\n                    componentController: componentController,\n                    allowRevert: allowRevert\n                },\n                controller: RevisionsController\n            });\n            function RevisionsController($scope, $mdDialog, items, componentController, allowRevert) {\n                $scope.items = items;\n                $scope.componentController = componentController;\n                $scope.allowRevert = allowRevert;\n                $scope.close = () => {\n                    $mdDialog.hide();\n                };\n                $scope.revertWork = (componentState) => {\n                    $scope.componentController.setStudentWork(componentState);\n                    $scope.componentController.studentDataChanged();\n                    $mdDialog.hide();\n                };\n            }\n            RevisionsController.$inject = [\"$scope\", \"$mdDialog\", \"items\", \"componentController\", \"allowRevert\"];\n        });\n\n        this.$scope.$on('showStudentAssets', (event, args) => {\n            let componentController = args.componentController;\n            let $event = args.$event;\n            let studentAssetDialogTemplateUrl = this.themePath + '/templates/studentAssetDialog.html';\n            let studentAssetTemplateUrl = this.themePath + '/studentAsset/studentAsset.html';\n\n            this.$mdDialog.show({\n                parent: angular.element(document.body),\n                targetEvent: $event,\n                templateUrl: studentAssetDialogTemplateUrl,\n                locals: {\n                    studentAssetTemplateUrl: studentAssetTemplateUrl,\n                    componentController: componentController\n                },\n                controller: StudentAssetDialogController\n            });\n            function StudentAssetDialogController($scope, $mdDialog, componentController) {\n                $scope.studentAssetTemplateUrl = studentAssetTemplateUrl;\n                $scope.componentController = componentController;\n                $scope.closeDialog = function () {\n                    $mdDialog.hide();\n                }\n            }\n            StudentAssetDialogController.$inject = [\"$scope\", \"$mdDialog\", \"componentController\"];\n        });\n\n        // a group node has turned on or off planning mode\n        this.$scope.$on('togglePlanningMode', (event, args) => {\n            this.planningMode = args.planningMode;\n        });\n\n        // handle request for notification dismiss codes\n        this.$scope.$on('viewCurrentAmbientNotification', (event, args) => {\n            let notification = args.notification;\n            let ev = args.event;\n            let notificationDismissDialogTemplateUrl = this.themePath + '/templates/notificationDismissDialog.html';\n\n            let dismissCodePrompt = {\n                parent: angular.element(document.body),\n                targetEvent: ev,\n                templateUrl: notificationDismissDialogTemplateUrl,\n                locals: {\n                    notification: notification\n                },\n                controller: DismissCodeDialogController\n            };\n            DismissCodeDialogController.$inject = ['$scope', '$mdDialog', '$filter', 'NotificationService', 'ProjectService', 'StudentDataService', 'notification'];\n\n            function DismissCodeDialogController($scope, $mdDialog, $filter, NotificationService, ProjectService, StudentDataService, notification) {\n\n                $scope.$translate = $filter('translate');\n\n                $scope.input = {\n                    dismissCode: \"\"\n                };\n                $scope.message = \"\";\n                $scope.notification = notification;\n                $scope.hasDismissCode = false;\n                if (notification.data) {\n                    if (notification.data.dismissCode) {\n                        $scope.hasDismissCode = true;\n                    }\n                }\n                $scope.nodePositionAndTitle = ProjectService.getNodePositionAndTitleByNodeId(notification.nodeId);\n\n                $scope.checkDismissCode = function() {\n                    if (!$scope.hasDismissCode || ($scope.input.dismissCode == notification.data.dismissCode)) {\n                        NotificationService.dismissNotification(notification);\n                        $mdDialog.hide();\n                        // log currentAmbientNotificationDimissed event\n                        var nodeId = null;\n                        var componentId = null;\n                        var componentType = null;\n                        var category = \"Notification\";\n                        var event = \"currentAmbientNotificationDimissedWithCode\";\n                        var eventData = {};\n                        StudentDataService.saveVLEEvent(nodeId, componentId, componentType, category, event, eventData);\n                    } else {\n                        $scope.errorMessage = $scope.$translate('dismissNotificationInvalidDismissCode');\n                    }\n                };\n                $scope.visitNode = function() {\n                    if (!$scope.hasDismissCode) {\n                        // only dismiss notifications that don't require a dismiss code, but still allow them to move to the node\n                        NotificationService.dismissNotification(null, $scope.notification);\n                    }\n\n                    let goToNodeId = $scope.notification.nodeId;\n                    if (goToNodeId != null) {\n                        StudentDataService.endCurrentNodeAndSetCurrentNodeByNodeId(goToNodeId);\n                    }\n                };\n\n                $scope.closeDialog = function() {\n                    $mdDialog.hide();\n\n                    // log currentAmbientNotificationWindowClosed event\n                    var nodeId = null;\n                    var componentId = null;\n                    var componentType = null;\n                    var category = \"Notification\";\n                    var event = \"currentAmbientNotificationWindowClosed\";\n                    var eventData = {};\n                    StudentDataService.saveVLEEvent(nodeId, componentId, componentType, category, event, eventData);\n                }\n            }\n\n            this.$mdDialog.show(dismissCodePrompt);\n\n            // log currentAmbientNotificationWindowOpened event\n            var nodeId = null;\n            var componentId = null;\n            var componentType = null;\n            var category = \"Notification\";\n            var event = \"currentAmbientNotificationWindowOpened\";\n            var eventData = {};\n            this.StudentDataService.saveVLEEvent(nodeId, componentId, componentType, category, event, eventData);\n        });\n\n        // capture notebook open/close events\n        /*this.$mdComponentRegistry.when('notebook').then(it => {\n            this.$scope.$watch(() => {\n                return it.isOpen();\n            }, (isOpenNewValue, isOpenOldValue) => {\n                if (isOpenNewValue !== isOpenOldValue) {\n                    let currentNode = this.StudentDataService.getCurrentNode();\n                    this.NotebookService.saveNotebookToggleEvent(isOpenNewValue, currentNode);\n                }\n            });\n        });*/\n    }\n\n    /**\n    * Set the layout state of the vle\n    * @param state string specifying state (e.g. 'notebook'; optional)\n    */\n    setLayoutState(state) {\n        let layoutState = 'nav'; // default layout state\n        if (state) {\n            layoutState = state;\n        } else {\n            // no state was sent, so set based on current node\n            if (this.currentNode) {\n                var id = this.currentNode.id;\n                if (this.ProjectService.isApplicationNode(id)) {\n                    // currently viewing step, so show step view\n                    layoutState = 'node';\n                } else if (this.ProjectService.isGroupNode(id)) {\n                    // currently viewing group node, so show navigation view\n                    layoutState = 'nav';\n                }\n            }\n        }\n\n        if (layoutState === 'notebook') {\n            this.$state.go('root.notebook', {nodeId: this.currentNode.id});\n        } else {\n            this.notebookNavOpen = false;\n            this.$state.go('root.vle', {nodeId: this.currentNode.id});\n        }\n\n        this.layoutState = layoutState;\n    }\n\n    // show server error alert when connection is lost\n    handleServerDisconnect() {\n        if (!this.connectionLostShown) {\n          this.$mdToast.show(this.connectionLostDisplay);\n          this.connectionLostShown = true;\n        }\n    }\n\n    // hide server error alert when connection is restored\n    handleServerReconnect() {\n        this.$mdToast.hide(this.connectionLostDisplay);\n        this.connectionLostShown = false;\n    }\n\n    getAvatarColorForWorkgroupId(workgroupId) {\n        return this.ConfigService.getAvatarColorForWorkgroupId(workgroupId);\n    }\n\n    /**\n     * The user has moved the mouse so we will notify the Session Service\n     * so that it can refresh the session\n     */\n    mouseMoved() {\n        /*\n         * notify the Session Service that the user has moved the mouse\n         * so we can refresh the session\n         */\n        this.SessionService.mouseMoved();\n    }\n}\n\n\nThemeController.$inject = [\n    '$scope',\n    '$state',\n    '$filter',\n    'ConfigService',\n    'ProjectService',\n    'StudentDataService',\n    'StudentStatusService',\n    'NotebookService',\n    'SessionService',\n    '$mdDialog',\n    '$mdMedia',\n    '$mdToast',\n    '$mdComponentRegistry'\n];\n\nexport default ThemeController;\n"]}