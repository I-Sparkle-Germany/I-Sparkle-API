{"version":3,"sources":["notebookController.es6"],"names":[],"mappings":"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","file":"notebookController.js","sourcesContent":["'use strict';\n\nclass NotebookController {\n\n    constructor($injector,\n                $rootScope,\n                $scope,\n                $translate,\n                ConfigService,\n                NotebookService,\n                ProjectService,\n                StudentAssetService,\n                StudentDataService) {\n        this.$injector = $injector;\n        this.$rootScope = $rootScope;\n        this.$scope = $scope;\n        this.$translate = $translate;\n        this.ConfigService = ConfigService;\n        this.mode = this.ConfigService.getMode();\n        this.NotebookService = NotebookService;\n        this.ProjectService = ProjectService;\n        this.StudentAssetService = StudentAssetService;\n        this.StudentDataService = StudentDataService;\n        this.$translate('typeYourNoteHere').then((typeYourNoteHere) => {\n            this.newNotePlaceholderText = typeYourNoteHere;\n        });\n\n        this.notebook = null;\n        this.itemId = null;\n        this.item = null;\n\n        $scope.$on('notebookUpdated', (event, args) => {\n            this.notebook = args.notebook;\n        });\n\n        this.logOutListener = $scope.$on('logOut', (event, args) => {\n            this.logOutListener();\n            this.$rootScope.$broadcast('componentDoneUnloading');\n        });\n\n        // retrieve assets when notebook is opened\n        if (!this.ConfigService.isPreview()) {\n            this.retrieveNotebookItems();\n        }\n    }\n\n    getTemplateUrl() {\n        return this.templateUrl;\n    }\n\n    retrieveNotebookItems() {\n        // fetch all assets first because a subset of it will be referenced by a notebook item\n        this.StudentAssetService.retrieveAssets().then((studentAssets) => {\n            this.NotebookService.retrieveNotebookItems().then((notebook) => {\n                this.notebook = notebook;\n            });\n        });\n    }\n\n    attachStudentAssetToNewNote(files) {\n        if (files != null) {\n            for (var f = 0; f < files.length; f++) {\n                var file = files[f];\n                this.StudentAssetService.uploadAsset(file).then((studentAsset) => {\n                    this.StudentAssetService.copyAssetForReference(studentAsset).then((copiedAsset) => {\n                        if (copiedAsset != null) {\n                            var attachment = {\n                                studentAssetId: copiedAsset.id,\n                                iconURL: copiedAsset.iconURL\n                            };\n\n                            this.newNote.content.attachments.push(attachment);\n                        }\n                    });\n                });\n            }\n        }\n    }\n\n    removeAttachment(attachment) {\n        if (this.newNote.content.attachments.indexOf(attachment) != -1) {\n            this.newNote.content.attachments.splice(this.newNote.content.attachments.indexOf(attachment), 1);\n        }\n    }\n\n    deleteStudentAsset(studentAsset) {\n        alert('delete student asset from note book not implemented yet');\n        /*\n         StudentAssetService.deleteAsset(studentAsset).then(angular.bind(this, function(deletedStudentAsset) {\n         // remove studentAsset\n         this.studentAssets.splice(this.studentAssets.indexOf(deletedStudentAsset), 1);\n         this.calculateTotalUsage();\n         }));\n         */\n    }\n\n    deleteItem(item) {\n        this.NotebookService.deleteItem(item);\n    }\n\n    notebookItemSelected($event, notebookItem) {\n        this.selectedNotebookItem = notebookItem;\n    }\n\n    attachNotebookItemToComponent($event, notebookItem) {\n        this.componentController.attachNotebookItemToComponent(notebookItem);\n        this.selectedNotebookItem = null;  // reset selected notebook item\n        // TODO: add some kind of unobtrusive confirmation to let student know that the notebook item has been added to current component\n        $event.stopPropagation();  // prevents parent notebook list item from getting the onclick event so this item won't be re-selected.\n    }\n\n    showAddNote() {\n        // setting this will show the add note div\n        let currentNodeId = this.StudentDataService.getCurrentNodeId();\n        let currentNodeTitle = this.ProjectService.getNodeTitleByNodeId(currentNodeId);\n        this.newNote = {\n            type: \"note\",\n            nodeId: currentNodeId, // Id of the node this note was created on\n            title: \"Note on \" + currentNodeTitle,  // Title of the node this note was created on\n            content: {\n                text: \"\",\n                attachments: []\n            }\n        };\n    }\n\n    cancelAddNote() {\n        this.newNote = null; // this will hide the add note div\n    }\n\n    addNote() {\n        let newNoteContent = {\n            text: this.newNote.content.text,\n            attachments: this.newNote.content.attachments\n        };\n        this.NotebookService.saveNotebookItem(this.newNote.nodeId, this.newNote.type, this.newNote.title, newNoteContent)\n            .then(() => {\n                this.newNote = null; // this will hide the add note div\n            });\n    }\n\n    addBookmark() {\n        // TODO: implement me\n        this.newNote = null; // this will hide the add note div\n    }\n\n    addQuestion() {\n        // TODO: implement me\n        this.newNote = null; // this will hide the add note div\n    }\n}\n\nNotebookController.$inject = [\n    \"$injector\",\n    \"$rootScope\",\n    \"$scope\",\n    \"$translate\",\n    \"ConfigService\",\n    \"NotebookService\",\n    \"ProjectService\",\n    \"StudentAssetService\",\n    \"StudentDataService\"\n];\n\nexport default NotebookController;"]}