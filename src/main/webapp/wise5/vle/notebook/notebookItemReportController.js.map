{"version":3,"sources":["notebookItemReportController.es6"],"names":["NotebookItemReportController","$injector","$mdBottomSheet","$rootScope","$scope","$translate","ConfigService","NotebookService","ProjectService","StudentAssetService","StudentDataService","mode","getMode","dirty","autoSaveInterval","saveMessage","text","time","reportItem","getLatestNotebookReportItemByReportId","reportId","serverSaveTime","clientSaveTime","convertToClientTimestamp","then","translations","setSaveMessage","lastSaved","getTemplateReportItemByReportId","id","notebookConfig","getNotebookConfig","label","itemTypes","report","summernoteOptions","toolbar","popover","image","customButton","buttonText","tooltip","buttonClass","action","$event","addNotebookItemContent","disableDragAndDrop","toolbarContainer","callbacks","onBlur","$","summernote","$watch","content","newValue","oldValue","$on","saveNotebookReportItem","startAutoSaveInterval","item","nodeId","getNodePositionAndTitleByNodeId","templateUrl","ev","notebookItems","notebook","items","themePath","reportTextareaCursorPosition","angular","element","prop","$reportElement","show","parent","document","body","locals","controller","NotebookItemChooserController","controllerAs","bindToController","chooseNotebookItem","notebookItem","$item","css","attachments","a","length","notebookItemAttachment","$img","iconURL","addClass","append","$caption","hide","$inject","stopAutoSaveInterval","autoSaveIntervalId","setInterval","clearInterval","Date","parse","saveNotebookItem","localNotebookItemId","type","title","result","saved","distance","elem","edge","scrollBarWidth","clientWidth","querySelector","outerWidth","find","message"],"mappings":"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","file":"notebookItemReportController.js","sourcesContent":["'use strict';\n\nclass NotebookItemReportController {\n\n    constructor($injector,\n                $mdBottomSheet,\n                $rootScope,\n                $scope,\n                $translate,\n                ConfigService,\n                NotebookService,\n                ProjectService,\n                StudentAssetService,\n                StudentDataService) {\n        this.$injector = $injector;\n        this.$mdBottomSheet = $mdBottomSheet;\n        this.$rootScope = $rootScope;\n        this.$scope = $scope;\n        this.$translate = $translate;\n        this.ConfigService = ConfigService;\n        this.NotebookService = NotebookService;\n        this.ProjectService = ProjectService;\n        this.StudentAssetService = StudentAssetService;\n        this.StudentDataService = StudentDataService;\n        this.mode = this.ConfigService.getMode();\n\n        this.dirty = false;\n\n        this.autoSaveInterval = 60000;  // the auto save interval in milliseconds\n\n        this.saveMessage = {\n            text: '',\n            time: ''\n        };\n\n        this.reportItem = this.NotebookService.getLatestNotebookReportItemByReportId(this.reportId);\n        if (this.reportItem) {\n            let serverSaveTime = this.reportItem.serverSaveTime;\n            let clientSaveTime = this.ConfigService.convertToClientTimestamp(serverSaveTime);\n            this.$translate(['lastSaved']).then((translations) => {\n                this.setSaveMessage(translations.lastSaved, clientSaveTime);\n            });\n        } else {\n            // Student doesn't have work for this report yet, so we'll use the template.\n            this.reportItem = this.NotebookService.getTemplateReportItemByReportId(this.reportId);\n            if (this.reportItem == null) {\n                // if there is no template, don't allow student to work on the report.\n                return;\n            } else {\n            }\n        }\n        this.reportItem.id = null;  // set the id to null so it can be inserted as initial version, as opposed to updated. this is true for both new and just-loaded reports.\n\n        this.notebookConfig = this.NotebookService.getNotebookConfig();\n        this.label = this.notebookConfig.itemTypes.report.label;\n\n        // summernote editor options\n        this.summernoteOptions = {\n            toolbar: [\n                ['edit', ['undo', 'redo']],\n                ['style', ['bold', 'italic', 'underline'/*, 'superscript', 'subscript', 'strikethrough', 'clear'*/]],\n                //['style', ['style']],\n                //['fontface', ['fontname']],\n                //['textsize', ['fontsize']],\n                //['fontclr', ['color']],\n                ['para', ['ul', 'ol', 'paragraph'/*, 'lineheight'*/]],\n                //['height', ['height']],\n                //['table', ['table']],\n                //['insert', ['link','picture','video','hr']],\n                //['view', ['fullscreen', 'codeview']],\n                //['help', ['help']]\n                ['customButton', ['customButton']]\n                //['print', ['print']]\n            ],\n            popover: {\n                image: [\n                    ['imagesize', ['imageSize100', 'imageSize50', 'imageSize25']],\n                    //['float', ['floatLeft', 'floatRight', 'floatNone']],\n                    ['remove', ['removeMedia']]\n                ]\n            },\n            customButton: {\n                buttonText: 'Add ' + this.notebookConfig.label + ' Item +',\n                tooltip: 'Insert from ' + this.notebookConfig.label,\n                buttonClass: 'accent-1 notebook-item--report__add-note',\n                action: ($event) => {\n                    this.addNotebookItemContent($event);\n                }\n            },\n            disableDragAndDrop: true,\n            toolbarContainer: '#' + this.reportId + '-toolbar',\n            callbacks: {\n                onBlur: function () {\n                    $(this).summernote('saveRange');\n                }\n            }\n        };\n\n        this.$scope.$watch(() => {\n            return this.reportItem.content.content;\n        }, (newValue, oldValue) => {\n            if (newValue !== oldValue) {\n                this.dirty = true;\n            }\n        });\n\n        this.$scope.$on('toggleNotebook', () => {\n            if (this.dirty) {\n                this.saveNotebookReportItem();\n            }\n        });\n\n        // start the auto save interval\n        this.startAutoSaveInterval();\n    }\n\n    getItemNodeId() {\n        if (this.item == null) {\n            return null;\n        } else {\n            return this.item.nodeId;\n        }\n    }\n\n    /**\n     * Returns this NotebookItem's position and title.\n     */\n    getItemNodePositionAndTitle() {\n        if (this.item == null) {\n            return \"\";\n        } else {\n            return this.ProjectService.getNodePositionAndTitleByNodeId(this.item.nodeId);\n        }\n    }\n\n    getTemplateUrl() {\n        return this.templateUrl;\n    }\n\n    addNotebookItemContent(ev) {\n        let notebookItems = this.NotebookService.notebook.items;\n        let templateUrl = this.themePath + '/notebook/notebookItemChooser.html';\n        let reportTextareaCursorPosition = angular.element('textarea.report').prop(\"selectionStart\"); // insert the notebook item at the cursor position later\n        let $reportElement = $('#' + this.reportId);\n\n        this.$mdBottomSheet.show({\n            parent: angular.element(document.body),\n            templateUrl: templateUrl,\n            locals: {\n                notebookItems: notebookItems,\n                reportItem: this.reportItem,\n                reportTextareaCursorPosition: reportTextareaCursorPosition,\n                themePath: this.themePath,\n                notebookConfig: this.notebookConfig\n            },\n            controller: NotebookItemChooserController,\n            controllerAs: 'notebookItemChooserController',\n            bindToController: true\n        });\n\n        function NotebookItemChooserController($mdBottomSheet, $scope, notebookItems, reportItem, reportTextareaCursorPosition, themePath) {\n            $scope.notebookItems = notebookItems;\n            $scope.reportItem = reportItem;\n            $scope.reportTextareaCursorPosition = reportTextareaCursorPosition;\n            $scope.themePath = themePath;\n            $scope.chooseNotebookItem = (notebookItem) => {\n                let $item = $('<div></div>').css('text-align', 'center');\n                if (notebookItem.content && notebookItem.content.attachments) {\n                    for (let a = 0; a < notebookItem.content.attachments.length; a++) {\n                        let notebookItemAttachment = notebookItem.content.attachments[a];\n                        let $img = $('<img src=\"' + notebookItemAttachment.iconURL + '\" alt=\"notebook image\" style=\"width: 75%; max-width: 100%; height: auto; border: 1px solid #aaaaaa; padding: 8px; margin-bottom: 4px;\" />');\n                        $img.addClass('notebook-item--report__note-img');\n                        $item.append($img);\n                    }\n                }\n                if (notebookItem.content && notebookItem.content.text) {\n                    let $caption = $('<div><b>' + notebookItem.content.text + '</b></div>').css({'text-align': 'center'});\n                    $item.append($caption);\n                }\n\n                $reportElement.summernote('focus');\n                $reportElement.summernote('restoreRange');\n                $reportElement.summernote('insertNode', $item[0]);\n\n                // hide chooser\n                $mdBottomSheet.hide();\n            };\n        }\n\n        NotebookItemChooserController.$inject = [\"$mdBottomSheet\", \"$scope\", \"notebookItems\", \"reportItem\", \"reportTextareaCursorPosition\", \"themePath\"];\n    }\n\n    /**\n     * Start the auto save interval for this report\n     */\n    startAutoSaveInterval() {\n        this.stopAutoSaveInterval();  // stop any existing interval\n        this.autoSaveIntervalId = setInterval(() => {\n            // check if the student work is dirty\n            if (this.dirty) {\n                // the student work is dirty so we will save.\n                // obtain the component states from the children and save them to the server\n                this.saveNotebookReportItem();\n            }\n        }, this.autoSaveInterval);\n    };\n\n    /**\n     * Stop the auto save interval for this report\n     */\n    stopAutoSaveInterval() {\n        clearInterval(this.autoSaveIntervalId);\n    };\n\n    /**\n     * Save the notebook report item to server\n     */\n    saveNotebookReportItem() {\n        // save new report notebook item\n        this.reportItem.content.clientSaveTime = Date.parse(new Date());  // set save timestamp\n        this.NotebookService.saveNotebookItem(this.reportItem.id, this.reportItem.nodeId, this.reportItem.localNotebookItemId,\n            this.reportItem.type, this.reportItem.title, this.reportItem.content, this.reportItem.content.clientSaveTime)\n            .then((result) => {\n                if (result) {\n                    this.$translate(['saved']).then((translations) => {\n                        this.dirty = false;\n                        this.reportItem.id = result.id; // set the reportNotebookItemId to the newly-incremented id so that future saves during this visit will be an update instead of an insert.\n                        let serverSaveTime = result.serverSaveTime;\n                        let clientSaveTime = this.ConfigService.convertToClientTimestamp(serverSaveTime);\n\n                        // set save message\n                        this.setSaveMessage(translations.saved, clientSaveTime);\n                    });\n                }\n            });\n    }\n\n    /**\n     * Account for potential vertical scrollbar on Notebook content and set\n     * fixed rich text toolbar location accordingly\n     */\n    setEditorPosition(distance, elem, edge) {\n        let scrollBarWidth = document.body.clientWidth - angular.element(document.querySelector('#notebook')).outerWidth(true);\n        elem.find('.notebook-item--report__toolbar').css('right', scrollBarWidth);\n    }\n\n    /**\n     * Set the message next to the save button\n     * @param message the message to display\n     * @param time the time to display\n     */\n    setSaveMessage(message, time) {\n        this.saveMessage.text = message;\n        this.saveMessage.time = time;\n    }\n}\n\nNotebookItemReportController.$inject = [\n    \"$injector\",\n    '$mdBottomSheet',\n    \"$rootScope\",\n    \"$scope\",\n    \"$translate\",\n    \"ConfigService\",\n    \"NotebookService\",\n    \"ProjectService\",\n    \"StudentAssetService\",\n    \"StudentDataService\"\n];\n\nexport default NotebookItemReportController;\n"]}