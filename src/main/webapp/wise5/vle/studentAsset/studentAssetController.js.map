{"version":3,"sources":["studentAssetController.es6"],"names":["StudentAssetController","$filter","$injector","$rootScope","$scope","ConfigService","ProjectService","StudentAssetService","mode","getMode","$translate","studentAssets","allAssets","itemId","item","logOutListener","$on","event","args","$broadcast","isPreview","retrieveStudentAssets","templateUrl","retrieveAssets","then","files","file","uploadAsset","studentAsset","componentController","attachStudentAsset","alert","$event","stopPropagation","$inject"],"mappings":"AAAA;;;;;;;;;;IAEMA,sB;AACJ,kCACIC,OADJ,EAEIC,SAFJ,EAGIC,UAHJ,EAIIC,MAJJ,EAKIC,aALJ,EAMIC,cANJ,EAOIC,mBAPJ,EAOyB;AAAA;;AAAA;;AACvB,SAAKN,OAAL,GAAeA,OAAf;AACA,SAAKC,SAAL,GAAiBA,SAAjB;AACA,SAAKC,UAAL,GAAkBA,UAAlB;AACA,SAAKC,MAAL,GAAcA,MAAd;AACA,SAAKC,aAAL,GAAqBA,aAArB;AACA,SAAKG,IAAL,GAAY,KAAKH,aAAL,CAAmBI,OAAnB,EAAZ;AACA,SAAKH,cAAL,GAAsBA,cAAtB;AACA,SAAKC,mBAAL,GAA2BA,mBAA3B;AACA,SAAKG,UAAL,GAAkB,KAAKT,OAAL,CAAa,WAAb,CAAlB;AACA,SAAKU,aAAL,GAAqB,KAAKJ,mBAAL,CAAyBK,SAA9C;AACA,SAAKC,MAAL,GAAc,IAAd;AACA,SAAKC,IAAL,GAAY,IAAZ;;AAEA,SAAKC,cAAL,GAAsBX,OAAOY,GAAP,CAAW,QAAX,EAAqB,UAACC,KAAD,EAAQC,IAAR,EAAiB;AAC1D,YAAKH,cAAL;AACA,YAAKZ,UAAL,CAAgBgB,UAAhB,CAA2B,wBAA3B;AACD,KAHqB,CAAtB;;AAKA,QAAI,CAAC,KAAKd,aAAL,CAAmBe,SAAnB,EAAL,EAAqC;AACnC,WAAKC,qBAAL;AACD;AACF;;;;qCAEgB;AACf,aAAO,KAAKC,WAAZ;AACD;;;4CAEuB;AAAA;;AACtB,WAAKf,mBAAL,CAAyBgB,cAAzB,GAA0CC,IAA1C,CAA+C,UAACb,aAAD,EAAmB;AAChE,eAAKA,aAAL,GAAqBA,aAArB;AACD,OAFD;AAGD;;;wCAEmBc,K,EAAO;AAAA;;AACzB,UAAIA,SAAS,IAAb,EAAmB;AAAA;AAAA;AAAA;;AAAA;AACjB,+BAAmBA,KAAnB,8HAA0B;AAAA,gBAAfC,IAAe;;AACxB,iBAAKnB,mBAAL,CAAyBoB,WAAzB,CAAqCD,IAArC,EAA2CF,IAA3C,CAAgD,UAACI,YAAD,EAAkB;AAChE,kBAAI,OAAKC,mBAAL,IAA4B,IAAhC,EAAsC;AACpC;AACA;AACA,uBAAKA,mBAAL,CAAyBC,kBAAzB,CAA4CF,YAA5C;AACD;AACD,qBAAKjB,aAAL,GAAqB,OAAKJ,mBAAL,CAAyBK,SAA9C;AACD,aAPD;AAQD;AAVgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWlB;AACF;;;uCAEkBgB,Y,EAAc;AAC/BG,YAAM,KAAKrB,UAAL,CAAgB,qCAAhB,CAAN;AACD;;;kDAE6BsB,M,EAAQJ,Y,EAAc;AAClD,UAAI,KAAKC,mBAAL,IAA4B,IAAhC,EAAsC;AACpC;AACA;AACA,aAAKA,mBAAL,CAAyBC,kBAAzB,CAA4CF,YAA5C;AACA;AACAI,eAAOC,eAAP,GALoC,CAKT;AAC5B;AACF;;;;;;AAGHjC,uBAAuBkC,OAAvB,GAAiC,CAC/B,SAD+B,EAE/B,WAF+B,EAG/B,YAH+B,EAI/B,QAJ+B,EAK/B,eAL+B,EAM/B,gBAN+B,EAO/B,qBAP+B,CAAjC;;kBAUelC,sB","file":"studentAssetController.js","sourcesContent":["'use strict';\n\nclass StudentAssetController {\n  constructor(\n      $filter,\n      $injector,\n      $rootScope,\n      $scope,\n      ConfigService,\n      ProjectService,\n      StudentAssetService) {\n    this.$filter = $filter;\n    this.$injector = $injector;\n    this.$rootScope = $rootScope;\n    this.$scope = $scope;\n    this.ConfigService = ConfigService;\n    this.mode = this.ConfigService.getMode();\n    this.ProjectService = ProjectService;\n    this.StudentAssetService = StudentAssetService;\n    this.$translate = this.$filter('translate');\n    this.studentAssets = this.StudentAssetService.allAssets;\n    this.itemId = null;\n    this.item = null;\n\n    this.logOutListener = $scope.$on('logOut', (event, args) => {\n      this.logOutListener();\n      this.$rootScope.$broadcast('componentDoneUnloading');\n    });\n\n    if (!this.ConfigService.isPreview()) {\n      this.retrieveStudentAssets();\n    }\n  }\n\n  getTemplateUrl() {\n    return this.templateUrl;\n  };\n\n  retrieveStudentAssets() {\n    this.StudentAssetService.retrieveAssets().then((studentAssets) => {\n      this.studentAssets = studentAssets;\n    });\n  };\n\n  uploadStudentAssets(files) {\n    if (files != null) {\n      for (const file of files) {\n        this.StudentAssetService.uploadAsset(file).then((studentAsset) => {\n          if (this.componentController != null) {\n            // If the student asset dialog is a part of a component (e.g. attaching image to OR or Discussion)\n            // Also attach the file(s) to the componentstate's attachments\n            this.componentController.attachStudentAsset(studentAsset);\n          }\n          this.studentAssets = this.StudentAssetService.allAssets;\n        });\n      }\n    }\n  };\n\n  deleteStudentAsset(studentAsset) {\n    alert(this.$translate('deleteStudentAssetNotImplementedYet'));\n  };\n\n  attachStudentAssetToComponent($event, studentAsset) {\n    if (this.componentController != null) {\n      // If the student asset dialog is a part of a component (e.g. attaching image to OR or Discussion)\n      // Also attach the file(s) to the componentstate's attachments\n      this.componentController.attachStudentAsset(studentAsset);\n      // TODO: add some kind of unobtrusive confirmation to let student know that the student asset has been added to current component\n      $event.stopPropagation();  // prevents parent student asset list item from getting the onclick event so this item won't be re-selected.\n    }\n  };\n}\n\nStudentAssetController.$inject = [\n  \"$filter\",\n  \"$injector\",\n  \"$rootScope\",\n  \"$scope\",\n  \"ConfigService\",\n  \"ProjectService\",\n  \"StudentAssetService\"\n];\n\nexport default StudentAssetController;\n"]}